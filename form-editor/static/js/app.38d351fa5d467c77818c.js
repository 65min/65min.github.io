webpackJsonp([1],{"01ie":function(e,t){},"4x6I":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_vuex__=__webpack_require__("NYxO"),__WEBPACK_IMPORTED_MODULE_1_element_ui__=__webpack_require__("zL8q"),__WEBPACK_IMPORTED_MODULE_1_element_ui___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_element_ui__),__WEBPACK_IMPORTED_MODULE_2__util__=__webpack_require__("ZoQJ"),__WEBPACK_IMPORTED_MODULE_3__const__=__webpack_require__("kD8Z"),__WEBPACK_IMPORTED_MODULE_4__util_http__=__webpack_require__("JBQq"),__WEBPACK_IMPORTED_MODULE_5_js_base64__=__webpack_require__("gZea"),__WEBPACK_IMPORTED_MODULE_5_js_base64___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_js_base64__),__WEBPACK_IMPORTED_MODULE_6_vue_swatches__=__webpack_require__("gQ/s"),__WEBPACK_IMPORTED_MODULE_6_vue_swatches___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_vue_swatches__),__WEBPACK_IMPORTED_MODULE_7_vue_swatches_dist_vue_swatches_min_css__=__webpack_require__("peKb"),__WEBPACK_IMPORTED_MODULE_7_vue_swatches_dist_vue_swatches_min_css___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_vue_swatches_dist_vue_swatches_min_css__),_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e};__webpack_exports__.a={name:"Toolbar",components:{Swatches:__WEBPACK_IMPORTED_MODULE_6_vue_swatches___default.a},computed:{area:function(){return this.$store.state.area},detail:function(){return this.$store.state.detail},form:function(){return this.$store.state.form},cells:function(){return this.$store.state.cells},formTypeList:function(){return this.$store.state.formTypeList},type:function(){return this.$store.state.cache.type},editControl:function(){return this.$store.state.cache.editControl},fontFamilyItems:function(){return this.$store.state.toolbarConfig.fontFamilyItems},fontSizeItems:function(){return this.$store.state.toolbarConfig.fontSizeItems},predefinedColors:function(){return this.$store.state.config.predefinedColors},backList:function(){return this.$store.state.backList},nextList:function(){return this.$store.state.nextList},isUndoEnable:function(){return this.$store.state.stateIndex>0},isRedoEnable:function(){var e=JSON.parse(Object(__WEBPACK_IMPORTED_MODULE_2__util__.a)(__WEBPACK_IMPORTED_MODULE_3__const__.b)||"[]"),t=this.$store.state.stateIndex;return t<e.length-1&&t>=0},fontsize:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].fontSize:""},fontfamily:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].fontFamily:""},backgroundColor:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].background:""},textColor:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].color:""},items:function(){var e=[],t=this.$store.state.cells,o=this.$store.state.cache.select.beginCell.row,i=this.$store.state.cache.select.beginCell.col;for(var l in t)for(var r in t[l]){var n=t[l][r];n&&n.attribute&&n.attribute.name&&(o!==l-0||i!==r-0)&&e.push(_extends({},n.attribute,{type:n.type}))}return e=e.filter(function(e){return"input"===e.type||"textarea"===e.type||"numeric"===e.type}),e.sort(function(e,t){return(e.name||"").localeCompare(t.name||"")}),e}},data:function(){return{nameExpression:/^[\u4e00-\u9fa5a-zA-Z0-9_\-\(\)\[\]]+$/,nameExpression2:/\{[\u4e00-\u9fa5a-zA-Z0-9_\-\(\)\[\]]+\}/gi,saveDialog:{visible:!1,saveFormRule:{name:[{required:!0,message:"请输入表单名称",trigger:"blur"}]},saveForm:{formKey:null,name:null,remark:null,formType:null}},tempColor:"",borderPropertyDialog:!1,borderPropertyStyleOptions:[{value:"none",label:"无"},{value:"solid",label:"实线"},{value:"dotted",label:"短虚线"},{value:"dashed",label:"长虚线"}],borderStyle:"",borderColor:"",borderWidth:"1",borderTop:{style:void 0,width:void 0,color:void 0},borderHorizon:{style:void 0,width:void 0,color:void 0},borderBottom:{style:void 0,width:void 0,color:void 0},borderLeft:{style:void 0,width:void 0,color:void 0},borderVertical:{style:void 0,width:void 0,color:void 0},borderRight:{style:void 0,width:void 0,color:void 0},borderPosition:{top:void 0,horizon:void 0,bottom:void 0,left:void 0,vertical:void 0,right:void 0},controlDialog:{dialogWidth:"300px",dialogWidth2:"500px",dialogWidth3:"700px",inputDialog:!1,inputAttribute:{name:"",width:""},inputRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateInputWidth,trigger:"blur"}]},textareaDialog:!1,textareaAttribute:{name:"",width:"",height:""},textareaRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateTextWidth,trigger:"blur"}],height:[{validator:this.validateTextHeight,trigger:"blur"}]},dateDialog:!1,dateAttribute:{name:"",width:"",format:""},dateRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateDateWidth,trigger:"blur"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},selectDialog:!1,selectAttribute:{name:"",width:"",options:[]},selectRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateInputWidth,trigger:"blur"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},checkboxDialog:!1,checkboxAttribute:{name:"",horizon:!0,options:[]},checkboxRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateWidth,trigger:"blur"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},radioDialog:!1,radioAttribute:{name:"",horizon:!0,options:[]},radioRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateWidth,trigger:"blur"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},numericDialog:!1,numericAttribute:{name:"",width:"",precision:"",numericItem:null,expressionItems:[],relateItems:[],displayItems:[]},numericRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateInputWidth,trigger:"blur"}]},numericItems:[],sequenceDialog:!1,sequenceAttribute:{name:""},sequenceRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}]},referDialog:!1,referAttribute:{name:"",width:"",referCode:"",maps:[]},referRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"},{validator:this.validateName,trigger:"blur"}],width:[{validator:this.validateInputWidth,trigger:"blur"}],referCode:[{required:!0,message:"请输入参照窗口",trigger:"blur"}]},referInfo:{code:"",name:""},referColumnList:[]}}},methods:_extends({addNumeric:function(e){var t=this.controlDialog.numericAttribute.expressionItems.pop();if(void 0===t)this.controlDialog.numericAttribute.expressionItems.push(e),this.controlDialog.numericAttribute.relateItems.push(""),this.controlDialog.numericAttribute.displayItems.push({type:"numeric",text:e});else if(/^[0-9]+(.[0-9]*)?$/.test(t)){if(t.indexOf(".")>=0&&"."===e)return this.controlDialog.numericAttribute.expressionItems.push(t),!0;t+=e,this.controlDialog.numericAttribute.expressionItems.push(t),this.controlDialog.numericAttribute.relateItems.push("");var o=this.controlDialog.numericAttribute.displayItems.pop();o.text=o.text+e,this.controlDialog.numericAttribute.displayItems.push(o)}else this.controlDialog.numericAttribute.expressionItems.push(t),this.controlDialog.numericAttribute.expressionItems.push(e),this.controlDialog.numericAttribute.relateItems.push(""),this.controlDialog.numericAttribute.displayItems.push({type:"numeric",text:e})},addDot:function(){},addOperator:function(e){if(0===this.controlDialog.numericAttribute.expressionItems.length)return this.controlDialog.numericAttribute.expressionItems.push(e),this.controlDialog.numericAttribute.relateItems.push(""),this.controlDialog.numericAttribute.displayItems.push({type:"operate",text:e}),!0;var t=this.controlDialog.numericAttribute.displayItems[this.controlDialog.numericAttribute.displayItems.length-1];if(t&&"operate"===t.type)return!0;t&&(this.controlDialog.numericAttribute.expressionItems.push(e),this.controlDialog.numericAttribute.relateItems.push(""),this.controlDialog.numericAttribute.displayItems.push({type:"operate",text:e}))},addBracket:function(e){this.controlDialog.numericAttribute.expressionItems.push(e),this.controlDialog.numericAttribute.relateItems.push(""),this.controlDialog.numericAttribute.displayItems.push({type:"bracket",text:e})},addItem:function(){var e=this.controlDialog.numericAttribute.numericItem;for(var t in this.controlDialog.numericItems){var o=this.controlDialog.numericItems[t];if(e===o.itemid){this.controlDialog.numericAttribute.expressionItems.push("{"+o.name+"}"),this.controlDialog.numericAttribute.relateItems.push(e),this.controlDialog.numericAttribute.displayItems.push({type:"item",text:"{"+o.name+"}",itemid:o.itemid});break}}},backspace:function(){if(0===this.controlDialog.numericAttribute.displayItems.length)return!0;var e=this.controlDialog.numericAttribute.displayItems[this.controlDialog.numericAttribute.displayItems.length-1];if(e&&"numeric"===e.type){if(1===e.text.length)return this.controlDialog.numericAttribute.expressionItems.pop(),this.controlDialog.numericAttribute.relateItems.pop(),this.controlDialog.numericAttribute.displayItems.pop(),!0;var t=this.controlDialog.numericAttribute.expressionItems[this.controlDialog.numericAttribute.expressionItems.length-1];return t=t.substr(0,t.length-1),this.controlDialog.numericAttribute.expressionItems[this.controlDialog.numericAttribute.expressionItems.length-1]=t,e.text=e.text.substr(0,e.text.length-1),!0}this.controlDialog.numericAttribute.expressionItems.pop(),this.controlDialog.numericAttribute.relateItems.pop(),this.controlDialog.numericAttribute.displayItems.pop()},clear:function(){this.controlDialog.numericAttribute.expressionItems=[],this.controlDialog.numericAttribute.relateItems=[],this.controlDialog.numericAttribute.displayItems=[]},validateName:function(e,t,o){""===t&&o(new Error("请输入项目名称"));["detail","明细"].some(function(e){return e===t})&&o(new Error("名称["+t+"]为保留字"));for(var i=!1,l=1;l<this.cells.length&&!i;l++)for(var r=1;r<this.cells[l].length&&!i;r++){var n=this.cells[l][r];if(n&&n.attribute&&t===n.attribute.name&&(this.editControl.row!==l||this.editControl.col!==r)){i=!0;break}}i&&o(new Error("名称重复")),this.nameExpression.test(t)?o():o(new Error("请输入合法字符：中文、字母、数字、括号、下划线"))},validateInputWidth:function(e,t,o){""!==t?(/^\d+$/gi.test(t)||o(new Error("请输入整数")),(t-=0)<50||t>999?o(new Error("请输入50-999之间的数字")):o()):o()},validateTextWidth:function(e,t,o){""!==t?(/^\d+$/gi.test(t)||o(new Error("请输入整数")),(t-=0)<50||t>999?o(new Error("请输入50-999之间的数字")):o()):o()},validateTextHeight:function(e,t,o){""!==t?(/^\d+$/gi.test(t)||o(new Error("请输入整数")),(t-=0)<50||t>999?o(new Error("请输入50-999之间的数字")):o()):o()},validateDateWidth:function(e,t,o){""!==t?(/^\d+$/gi.test(t)||o(new Error("请输入整数")),(t-=0)<60||t>999?o(new Error("请输入60-999之间的数字")):o()):o()},validateWidth:function(e,t,o){(t-=0)<0||t>999?o(new Error("请输入0-999之间的数字")):o()},setBorderNone:function(){this.borderPosition.top=!1,this.borderPosition.bottom=!1,this.borderPosition.left=!1,this.borderPosition.right=!1,this.borderPosition.horizon=!1,this.borderPosition.vertical=!1,this.borderTop.style="",this.borderTop.width="",this.borderTop.color="",this.borderHorizon.style="",this.borderHorizon.width="",this.borderHorizon.color="",this.borderBottom.style="",this.borderBottom.width="",this.borderBottom.color="",this.borderLeft.style="",this.borderLeft.width="",this.borderLeft.color="",this.borderVertical.style="",this.borderVertical.width="",this.borderVertical.color="",this.borderRight.style="",this.borderRight.width="",this.borderRight.color=""},setBorderOuter:function(){this.borderPosition.top=!0,this.borderPosition.bottom=!0,this.borderPosition.left=!0,this.borderPosition.right=!0,this.borderTop.style=this.borderStyle,this.borderTop.width="1",this.borderTop.color=this.borderColor,this.borderBottom.style=this.borderStyle,this.borderBottom.width="1",this.borderBottom.color=this.borderColor,this.borderLeft.style=this.borderStyle,this.borderLeft.width="1",this.borderLeft.color=this.borderColor,this.borderRight.style=this.borderStyle,this.borderRight.width="1",this.borderRight.color=this.borderColor},setBorderInner:function(){this.borderPosition.horizon=!0,this.borderPosition.vertical=!0,this.borderHorizon.style=this.borderStyle,this.borderHorizon.width="1",this.borderHorizon.color=this.borderColor,this.borderVertical.style=this.borderStyle,this.borderVertical.width="1",this.borderVertical.color=this.borderColor},setBorderLeft:function(){this.borderPosition.left?(this.borderLeft.color="",this.borderLeft.style="",this.borderLeft.width="",this.borderPosition.left=!1):(this.borderLeft.color=this.borderColor,this.borderLeft.style=this.borderStyle,this.borderLeft.width="1",this.borderPosition.left=!0)},setBorderVertical:function(){this.borderPosition.vertical?(this.borderVertical.color="",this.borderVertical.style="",this.borderVertical.width="",this.borderPosition.vertical=!1):(this.borderVertical.color=this.borderColor,this.borderVertical.style=this.borderStyle,this.borderVertical.width="1",this.borderPosition.vertical=!0)},setBorderRight:function(){this.borderPosition.right?(this.borderRight.color="",this.borderRight.style="",this.borderRight.width="",this.borderPosition.right=!1):(this.borderRight.color=this.borderColor,this.borderRight.style=this.borderStyle,this.borderRight.width="1",this.borderPosition.right=!0)},setBorderTop:function(){this.borderPosition.top?(this.borderTop.color="",this.borderTop.style="",this.borderTop.width="",this.borderPosition.top=!1):(this.borderTop.color=this.borderColor,this.borderTop.style=this.borderStyle,this.borderTop.width="1",this.borderPosition.top=!0)},setBorderHorizon:function(){this.borderPosition.horizon?(this.borderHorizon.color="",this.borderHorizon.style="",this.borderHorizon.width="",this.borderPosition.horizon=!1):(this.borderHorizon.color=this.borderColor,this.borderHorizon.style=this.borderStyle,this.borderHorizon.width="1",this.borderPosition.horizon=!0)},setBorderBottom:function(){this.borderPosition.bottom?(this.borderBottom.color="",this.borderBottom.style="",this.borderBottom.width="",this.borderPosition.bottom=!1):(this.borderBottom.color=this.borderColor,this.borderBottom.style=this.borderStyle,this.borderBottom.width="1",this.borderPosition.bottom=!0)},setBorder:function(){},showBorderPropertyDialog:function(){this.borderStyle="solid",this.borderColor="#000000",this.borderPropertyDialog=!0},clearCellsContent:function(){var e=this;__WEBPACK_IMPORTED_MODULE_1_element_ui__.MessageBox.confirm("是否要清除选中的内容","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.doClearCellsContent(),__WEBPACK_IMPORTED_MODULE_1_element_ui__.Message.success({type:"success",message:"清除成功"})}).catch(function(){__WEBPACK_IMPORTED_MODULE_1_element_ui__.Message.info({type:"info",message:"已取消"})})},undo:function(){var e=JSON.parse(Object(__WEBPACK_IMPORTED_MODULE_2__util__.a)(__WEBPACK_IMPORTED_MODULE_3__const__.b)||"[]");if(!(e<=1)){this.$emit("loading");var t=this.$store.state.stateIndex,o=e[t-=1];o.stateIndex=t,this.$store.replaceState(Object.assign({},this.$store.state,o)),Object(__WEBPACK_IMPORTED_MODULE_2__util__.d)(__WEBPACK_IMPORTED_MODULE_3__const__.a,t),this.$emit("loading")}},redo:function(){var e=JSON.parse(Object(__WEBPACK_IMPORTED_MODULE_2__util__.a)(__WEBPACK_IMPORTED_MODULE_3__const__.b)||"[]"),t=this.$store.state.stateIndex;if(!(t>=e.length-1)){this.$emit("loading");var o=e[t+=1];o.stateIndex=t,this.$store.replaceState(Object.assign({},this.$store.state,o)),Object(__WEBPACK_IMPORTED_MODULE_2__util__.d)(__WEBPACK_IMPORTED_MODULE_3__const__.a,t),this.$emit("loading")}},addInputSave:function(){var e=this;this.$refs.inputForm.validate(function(t){if(t){var o=e.controlDialog.inputAttribute;e.addControl({type:"input",attribute:o}),e.cancelAddControl()}})},addTextareaSave:function(){var e=this;this.$refs.textareaForm.validate(function(t){if(t){var o=e.controlDialog.textareaAttribute;e.addControl({type:"textarea",attribute:o}),e.cancelAddControl()}})},addDateSave:function(){var e=this;this.$refs.dateForm.validate(function(t){if(t){var o=e.controlDialog.dateAttribute;e.addControl({type:"date",attribute:o}),e.cancelAddControl()}})},addSelectSave:function(){var e=this;this.$refs.selectForm.validate(function(t){if(t){var o=e.controlDialog.selectAttribute;e.addControl({type:"select",attribute:o}),e.cancelAddControl()}})},addCheckboxSave:function(){var e=this;this.$refs.checkboxForm.validate(function(t){if(t){var o=e.controlDialog.checkboxAttribute;e.addControl({type:"checkbox",attribute:o}),e.cancelAddControl()}})},addRadioSave:function(){var e=this;this.$refs.radioForm.validate(function(t){if(t){var o=e.controlDialog.radioAttribute;e.addControl({type:"radio",attribute:o}),e.cancelAddControl()}})},addNumericSave:function addNumericSave(){var _this8=this,expression=this.controlDialog.numericAttribute.expressionItems.join("");if(expression){var err=!1;try{var ret=eval(expression.replace(this.nameExpression2,Math.random));(ret===1/0||ret===-1/0||isNaN(ret))&&(err=!0)}catch(e){err=!0}if(err)return this.$message.error("似乎公式有问题，请确认。"),!1}this.$refs.numericForm.validate(function(e){if(e){var t=_this8.controlDialog.numericAttribute;_this8.addControl({type:"numeric",attribute:t}),_this8.cancelAddControl()}})},addSequenceSave:function(){var e=this;this.$refs.sequenceForm.validate(function(t){if(t){var o=e.controlDialog.sequenceAttribute;e.addControl({type:"sequence",attribute:o}),e.cancelAddControl()}})},addReferSave:function(){var e=this;this.$refs.referForm.validate(function(t){if(t){var o=e.controlDialog.referAttribute;e.addControl({type:"refer",attribute:o}),e.cancelAddControl()}})},addControlConfirm:function(e){var t=this,o=this.$store.state.cache.select.beginCell.row,i=this.$store.state.cache.select.beginCell.col,l=this.$store.state.cache.select.endCell.row,r=this.$store.state.cache.select.endCell.col;o===l&&i===r||(this.beginSelectCell({row:o,col:i}),this.endSelectCell({row:o,col:i}));var n=this.$store.state.cache.select.beginCell.row,a=this.$store.state.cache.select.beginCell.col,c=this.$store.state.cells;c[n][a]&&c[n][a].content&&"<br>"!==c[n][a].content?this.$confirm("单元格已存在内容，是否进行覆盖？","提醒",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){t.beginAddControl({type:e})}).catch(function(){}):this.beginAddControl({type:e})},closeDialog:function(){this.cancelAddControl()},setDialogForm:function(){if("input"===this.editControl.type)this.controlDialog.inputAttribute.name=this.editControl.attribute.name,this.controlDialog.inputAttribute.width=this.editControl.attribute.width;else if("textarea"===this.editControl.type)this.controlDialog.textareaAttribute.name=this.editControl.attribute.name,this.controlDialog.textareaAttribute.width=this.editControl.attribute.width,this.controlDialog.textareaAttribute.height=this.editControl.attribute.height;else if("date"===this.editControl.type)this.controlDialog.dateAttribute.name=this.editControl.attribute.name,this.controlDialog.dateAttribute.width=this.editControl.attribute.width,this.controlDialog.dateAttribute.format=this.editControl.attribute.format;else if("select"===this.editControl.type)this.controlDialog.selectAttribute.name=this.editControl.attribute.name,this.controlDialog.selectAttribute.width=this.editControl.attribute.width,this.controlDialog.selectAttribute.options=this.editControl.attribute.options;else if("checkbox"===this.editControl.type)this.controlDialog.checkboxAttribute.name=this.editControl.attribute.name,this.controlDialog.checkboxAttribute.width=this.editControl.attribute.width,this.controlDialog.checkboxAttribute.options=this.editControl.attribute.options;else if("radio"===this.editControl.type)this.controlDialog.radioAttribute.name=this.editControl.attribute.name,this.controlDialog.radioAttribute.width=this.editControl.attribute.width,this.controlDialog.radioAttribute.options=this.editControl.attribute.options;else if("numeric"===this.editControl.type)for(var e in this.controlDialog.numericAttribute.name=this.editControl.attribute.name,this.controlDialog.numericAttribute.width=this.editControl.attribute.width,this.controlDialog.numericAttribute.precision=this.editControl.attribute.precision,this.controlDialog.numericAttribute.numericItem=this.editControl.attribute.numericItem,this.controlDialog.numericAttribute.expressionItems=this.editControl.attribute.expressionItems||[],this.controlDialog.numericAttribute.relateItems=this.editControl.attribute.relateItems||[],this.controlDialog.numericAttribute.displayItems=this.editControl.attribute.displayItems||[],this.controlDialog.numericItems=[],this.cells)for(var t in this.cells[e]){var o=this.cells[e][t];o&&"numeric"===o.type&&o.attribute.name!==this.editControl.attribute.name&&this.controlDialog.numericItems.push(o.attribute)}else"sequence"===this.editControl.type?this.controlDialog.sequenceAttribute.name=this.editControl.attribute.name:"refer"===this.editControl.type&&(this.controlDialog.referAttribute.name=this.editControl.attribute.name,this.controlDialog.referAttribute.width=this.editControl.attribute.width,this.controlDialog.referAttribute.referCode=this.editControl.attribute.referCode,this.controlDialog.referAttribute.maps=this.editControl.attribute.maps,this.resetReferInfo(),this.resolveRefer(this.editControl.attribute.referCode,this.editControl.attribute.maps))},showSaveDialog:function(){return this.area.beginCell.row&&this.area.beginCell.col&&this.area.endCell.row&&this.area.endCell.col?void 0===this.detail.beginCell.row||this.detail.beginCell.col===this.area.beginCell.col&&this.detail.endCell.col===this.area.endCell.col?(this.saveDialog.visible=!0,this.saveDialog.saveForm.formKey=this.$store.state.form.formKey,this.saveDialog.saveForm.name=this.$store.state.form.name,this.saveDialog.saveForm.remark=this.$store.state.form.remark,void(this.saveDialog.saveForm.formType=this.$store.state.form.formType)):(__WEBPACK_IMPORTED_MODULE_1_element_ui__.Message.warning("明细控件宽度应与工作区域等宽"),!1):(__WEBPACK_IMPORTED_MODULE_1_element_ui__.Message.warning("请设置工作区域"),!1)},resetReferInfo:function(){this.controlDialog.referColumnList=[],this.controlDialog.referInfo.code="",this.controlDialog.referInfo.name=""},resolveRefer:function(e,t){if(this.resetReferInfo(),e){var o=this.$loading({fullscreen:!0,text:"正在请求资源..."}),i=this;__WEBPACK_IMPORTED_MODULE_4__util_http__.a.get("api/field/searchReferWindow?referCode="+e).then(function(e){if(o.close(),null===e.data)return i.resetReferInfo(),i.controlDialog.referAttribute.referCode="",void i.$message.error("参照窗口输入错误");i.controlDialog.referInfo.code=e.data.code,i.controlDialog.referInfo.name=e.data.name,i.controlDialog.referColumnList=e.data.columnList,t||(i.controlDialog.referAttribute.maps=[],e.data.columnList.forEach(function(){return i.controlDialog.referAttribute.maps.push({from:"",to:""})}))}).catch(function(e){console.log(e),o.close(),o.close()})}},saveForm:function(){this.save(this.saveDialog.saveForm),this.saveDialog.visible=!1},close:function(){this.$confirm("是否关闭当前窗口","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("yes"),window.close()}).catch(function(){console.log("no")})},exportForm:function(){var e=this;this.$prompt("请输入文件名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var o={cells:e.$store.state.cells,cols:e.$store.state.cols,rows:e.$store.state.rows,rowNum:e.$store.state.rowNum,colNum:e.$store.state.colNum,area:e.$store.state.area,detail:e.$store.state.detail};console.log(o),console.log(__WEBPACK_IMPORTED_MODULE_5_js_base64__.Base64);var i=window.URL||window.webkitURL||window,l=__WEBPACK_IMPORTED_MODULE_5_js_base64__.Base64.encode(JSON.stringify(e.$store.state)),r=new Blob([l]),n=document.createElementNS("http://www.w3.org/1999/xhtml","a");n.href=i.createObjectURL(r),n.download=t.value+".fields";var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(a)}).catch(function(e){console.log(e)})},importForm:function(){},readfile:function(e,t){var o=this,i=new FileReader;i.readAsText(e.raw),i.onload=function(){try{var e=__WEBPACK_IMPORTED_MODULE_5_js_base64__.Base64.decode(i.result);o.$store.replaceState(Object.assign({},o.$store.state,JSON.parse(e)))}catch(e){o.$message.error("导入出错")}},i.onerror=function(e){console.log("Error",e),o.$message.error("导入出错")}}},Object(__WEBPACK_IMPORTED_MODULE_0_vuex__.b)(["beginSelectCell","endSelectCell","mergeSelectedCells","mergeCells","splitCells","setCellsTextAlign","setCellsTextValign","setCellsBackground","setCellsTextColor","setCellsBorder","beginUEdit","doClearCellsContent","doUndo","doRedo","copyCell","setBold","setTextDecoration","setItalic","setCellsTextFontSize","setCellsTextFontFamily","addControl","beginAddControl","cancelAddControl","save","setArea","setDetail","clearDetail"])),mounted:function(){}}},"5OHi":function(e,t){},"9YMo":function(e,t){},"AO/F":function(e,t){},EwKG:function(e,t){},HJGo:function(e,t){},JBQq:function(e,t,o){"use strict";o.d(t,"a",function(){return u});var i=o("mtWM"),l=o.n(i),r=o("L6bb"),n=o.n(r),a=o("uAC3"),c=o.n(a),s=o("zL8q"),d=(o.n(s),"//"+window.location.host),u=l.a.create({baseURL:d}),f=[];u.interceptors.request.use(function(e){if("get"!==e.method){var t=Math.floor((new Date).getTime()),o=n()(JSON.stringify(e.data)+e.url+t);if(e.headers.common.timestamp=t,e.headers.common.nonce=o,-1!==f.indexOf(o))return Promise.reject({data:{code:809,url:e.url,data:e.data,msg:"重复请求"}});f.push(o)}return e.headers.common.Authorization=c.a.get("token")||"",e}),u.interceptors.response.use(function(e){var t=e.data;if(t){if(t.code){switch(t.code){case 901:case 903:alert(t.msg),s.MessageBox.alert(t.msg+"，是否刷新登录信息？","提示",{confirmButtonText:"确定",callback:function(){var e=s.Loading.service({fullscreen:!0,text:"正在请求..."}),t={headers:{common:{timestamp:(new Date).getTime(),nonce:Math.random()}}};u.put("/api/auth/refresh","refresh_token="+c.a.get("refreshToken"),t).then(function(t){e.close();var o=t.data;o.flag&&(c.a.set("token",o.data.token,1/24),c.a.set("refreshToken",o.data.refreshToken,1))})}})}return t}if(!1===t.flag)return 802!==t.code&&809!==t.code&&alert(t.msg),t}return t},function(e){return console.error("axios error",e),e.response?Promise.reject(e.response.data,e.response):Promise.reject(e)})},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o("7+uW"),l=o("JBQq"),r=o("mtWM"),n=o.n(r),a=(window.name.split("|")[0],window.name.split("|")[1],window.name.split("|")[2]),c=window.name.split("|")[3],s={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"fe-all-selector-box",style:{height:this.defaultRowHeight+0+"px"}})},staticRenderFns:[]};var d=o("VU/8")({name:"AllSelector",computed:{cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},defaultColWidth:function(){return this.$store.state.config.defaultColWidth}}},s,!1,function(e){o("cDxm")},"data-v-1f7a53ba",null).exports,u={name:"ColSelector",computed:{cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},defaultColWidth:function(){return this.$store.state.config.defaultColWidth}},methods:{displayHeadCharactor:function(e){var t=parseInt((e-1)/26),o=(e-1)%26;return(0===t?"":"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(t-1,t))+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(o,o+1)}}},f={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-col-selector",style:{height:e.defaultRowHeight+"px"}},[o("table",{staticClass:"fe-col-selector-table",style:{width:e.defaultColWidth*e.colNum+"px"},attrs:{cellpadding:"0",cellspacing:"0"}},[o("tr",e._l(e.colNum,function(t){return o("td",{key:t,staticClass:"fe-col-selector-table-td"},[e._v(e._s(e.displayHeadCharactor(t)))])}))])])},staticRenderFns:[]};var h=o("VU/8")(u,f,!1,function(e){o("HJGo")},"data-v-8166a566",null).exports,b={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-row-selector"},[o("table",{staticClass:"fe-row-selector-table",attrs:{cellpadding:"0",cellspacing:"0"}},e._l(e.rowNum,function(t){return o("tr",{key:t},[o("td",{staticClass:"fe-row-selector-table-td",style:{height:e.defaultRowHeight-1+"px"}},[e._v(e._s(t))])])}))])},staticRenderFns:[]};var m=o("VU/8")({name:"RowSelector",computed:{rows:function(){return this.$store.state.rows},rowNum:function(){return this.$store.state.rowNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight}}},b,!1,function(e){o("q4eC")},"data-v-642ed4c8",null).exports,_=o("4x6I"),p={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-toolbar-buttons"},[o("div",{staticClass:"fe-toolbar-buttons-left"},[o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.isUndoEnable,title:"撤销"},on:{click:e.undo}},[o("i",{staticClass:"iconfont fe-iconfont-undo"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.isRedoEnable,title:"重做"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-redo"})])],1),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{size:"mini",title:"退出"},on:{click:e.close}},[o("i",{staticClass:"iconfont fe-iconfont-cancel"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"保存"},on:{click:e.showSaveDialog}},[o("i",{staticClass:"iconfont fe-iconfont-save"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"复制"},on:{click:e.copyCell}},[o("i",{staticClass:"iconfont fe-iconfont-copy"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"剪切"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-cut"})])],1),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"粘贴"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-paste"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"取消复制、粘贴"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-cancel"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"清空内容"},on:{click:e.clearCellsContent}},[o("i",{staticClass:"iconfont fe-iconfont-clear"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"工作区域，实际处理工作时，只显示工作区域内的内容"},on:{click:e.setArea}},[o("i",{staticClass:"iconfont fe-iconfont-area"})])],1),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"取消设置明细控件"},on:{click:e.clearDetail}},[o("i",{staticClass:"iconfont fe-iconfont-delete-detail"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"设置为明细组件"},on:{click:e.setDetail}},[o("i",{staticClass:"iconfont fe-iconfont-detail"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("swatches",{attrs:{value:e.backgroundColor,colors:"text-advanced"},on:{input:e.setCellsBackground}},[o("el-button",{attrs:{slot:"trigger",type:"primary",size:"mini",title:"背景色"},slot:"trigger"},[o("i",{staticClass:"iconfont fe-iconfont-background-color"})])],1),e._v(" "),o("swatches",{attrs:{value:e.textColor,colors:"text-advanced"},on:{input:e.setCellsTextColor}},[o("el-button",{attrs:{slot:"trigger",type:"primary",size:"mini",title:"背景色"},slot:"trigger"},[o("i",{staticClass:"iconfont fe-iconfont-text-color"})])],1)],1),e._v(" "),o("br"),e._v(" "),o("el-upload",{ref:"upload",attrs:{"on-change":e.readfile,"show-file-list":!1,"auto-upload":!1,action:"//"}},[o("el-button",{attrs:{type:"primary",size:"mini",title:"导出"},on:{click:e.exportForm}},[o("i",{staticClass:"iconfont fe-iconfont-export"})]),e._v(" "),o("el-button",{attrs:{slot:"trigger",type:"primary",size:"mini",title:"导入"},on:{click:e.importForm},slot:"trigger"},[o("i",{staticClass:"iconfont fe-iconfont-import"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-select",{attrs:{size:"mini",value:e.fontfamily,placeholder:"字体"},on:{change:e.setCellsTextFontFamily}},e._l(e.fontFamilyItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-select",{attrs:{size:"mini",value:e.fontsize,placeholder:"字号"},on:{change:e.setCellsTextFontSize}},e._l(e.fontSizeItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"粗体"},on:{click:e.setBold}},[o("i",{staticClass:"iconfont fe-iconfont-bold"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"斜体"},on:{click:e.setItalic}},[o("i",{staticClass:"iconfont fe-iconfont-italic"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下划线"},on:{click:e.setTextDecoration}},[o("i",{staticClass:"iconfont fe-iconfont-underline"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"合并单元格"},on:{click:e.mergeCells}},[o("i",{staticClass:"iconfont fe-iconfont-mergecell"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"取消合并"},on:{click:e.splitCells}},[o("i",{staticClass:"iconfont fe-iconfont-separatecell"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.showBorderPropertyDialog}},[o("i",{staticClass:"iconfont fe-iconfont-border-all"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"居左"},on:{click:function(t){e.setCellsTextAlign({align:"left"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignleft"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"居中"},on:{click:function(t){e.setCellsTextAlign({align:"center"})}}},[o("i",{staticClass:"iconfont fe-iconfont-aligncenter"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"居右"},on:{click:function(t){e.setCellsTextAlign({align:"right"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignright"})])],1),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"顶端对齐"},on:{click:function(t){e.setCellsTextValign({align:"top"})}}},[o("i",{staticClass:"iconfont fe-iconfont-aligntop"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"垂直居中"},on:{click:function(t){e.setCellsTextValign({align:"middle"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignmiddle"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"底部对齐"},on:{click:function(t){e.setCellsTextValign({align:"bottom"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignbottom"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"文本框"},on:{click:function(t){e.addControlConfirm("input")}}},[o("i",{staticClass:"iconfont fe-iconfont-input"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"文本域/多行文本"},on:{click:function(t){e.addControlConfirm("textarea")}}},[o("i",{staticClass:"iconfont fe-iconfont-text"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"日期控件"},on:{click:function(t){e.addControlConfirm("date")}}},[o("i",{staticClass:"iconfont fe-iconfont-date"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下拉框"},on:{click:function(t){e.addControlConfirm("select")}}},[o("i",{staticClass:"iconfont fe-iconfont-drop-down"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"单选框"},on:{click:function(t){e.addControlConfirm("radio")}}},[o("i",{staticClass:"iconfont fe-iconfont-radio"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"多选框"},on:{click:function(t){e.addControlConfirm("checkbox")}}},[o("i",{staticClass:"iconfont fe-iconfont-checkbox"})])],1),e._v(" "),o("br"),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"数字控件"},on:{click:function(t){e.addControlConfirm("numeric")}}},[o("i",{staticClass:"iconfont fe-iconfont-numeric"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"参照窗口"},on:{click:function(t){e.addControlConfirm("refer")}}},[o("i",{staticClass:"iconfont fe-iconfont-refer-window"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"序列号，仅限添加在明细控件里"},on:{click:function(t){e.addControlConfirm("sequence")}}},[o("i",{staticClass:"iconfont fe-iconfont-number"})])],1)],1)]),e._v(" "),o("el-dialog",{attrs:{visible:e.borderPropertyDialog,width:"550px","custom-class":""},on:{"update:visible":function(t){e.borderPropertyDialog=t}}},[o("div",{staticClass:"fe-toolbar-buttons-border-property-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      边框属性\n    ")]),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset",staticStyle:{float:"left",width:"200px"}},[o("legend",[e._v("线条")]),e._v(" "),o("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.borderStyle,callback:function(t){e.borderStyle=t},expression:"borderStyle"}},e._l(e.borderPropertyStyleOptions,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset"},[o("legend",[e._v("预置")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderNone}},[o("i",{staticClass:"iconfont fe-iconfont-border-none"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("无边框")])])]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderOuter}},[o("i",{staticClass:"iconfont fe-iconfont-border-outer"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("外边框")])])]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderInner}},[o("i",{staticClass:"iconfont fe-iconfont-border-inner"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("内边框")])])])],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset",staticStyle:{float:"left",width:"200px"}},[o("legend",[e._v("颜色")]),e._v(" "),o("swatches",{attrs:{colors:"text-advanced","swatch-size":"28"},model:{value:e.borderColor,callback:function(t){e.borderColor=t},expression:"borderColor"}})],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset"},[o("legend",[e._v("自定义")]),e._v(" "),o("table",{staticClass:"fe-toolbar-buttons-border-property-dialog-table-border-buttons"},[o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderTop}},[o("i",{staticClass:"iconfont fe-iconfont-border-top"})])],1),e._v(" "),o("td",{attrs:{colspan:"3",rowspan:"3"}},[o("table",{staticClass:"fe-toolbar-preview",class:{},style:{borderTopColor:e.borderTop.color,borderBottomColor:e.borderBottom.color,borderLeftColor:e.borderLeft.color,borderRightColor:e.borderRight.color,borderTopStyle:e.borderTop.style,borderBottomStyle:e.borderBottom.style,borderLeftStyle:e.borderLeft.style,borderRightStyle:e.borderRight.style,borderTopWidth:e.borderTop.width,borderBottomWidth:e.borderBottom.width,borderLeftWidth:e.borderLeft.width,borderRightWidth:e.borderRight.width},attrs:{cellspacing:"0",cellpadding:"0"}},[o("tr",[o("td",{style:{borderRightColor:e.borderVertical.color,borderBottomColor:e.borderHorizon.color,borderRightStyle:e.borderVertical.style,borderBottomStyle:e.borderHorizon.style,borderRightWidth:e.borderVertical.width,borderBottomWidth:e.borderHorizon.width}}),e._v(" "),o("td",{style:{borderBottomColor:e.borderHorizon.color,borderBottomStyle:e.borderHorizon.style,borderBottomWidth:e.borderHorizon.width}})]),e._v(" "),o("tr",[o("td",{style:{borderRightColor:e.borderVertical.color,borderRightStyle:e.borderVertical.style,borderRightWidth:e.borderVertical.width}}),e._v(" "),o("td")])])])]),e._v(" "),o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderHorizon}},[o("i",{staticClass:"iconfont fe-iconfont-border-horizontal"})])],1)]),e._v(" "),o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderBottom}},[o("i",{staticClass:"iconfont fe-iconfont-borderbottom"})])],1)]),e._v(" "),o("tr",[o("td"),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"left"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderLeft}},[o("i",{staticClass:"iconfont fe-iconfont-borderleft"})])],1),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"center"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderVertical}},[o("i",{staticClass:"iconfont fe-iconfont-border-vertical"})])],1),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"right"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderRight}},[o("i",{staticClass:"iconfont fe-iconfont-border-right"})])],1)])]),e._v(" "),o("br")]),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.borderPropertyDialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCellsBorder({borderTop:e.borderTop,borderHorizon:e.borderHorizon,borderBottom:e.borderBottom,borderLeft:e.borderLeft,borderVertical:e.borderVertical,borderRight:e.borderRight}),e.borderPropertyDialog=!1}}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{visible:"input"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'input'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      文本框属性\n    ")]),e._v(" "),o("el-form",{ref:"inputForm",attrs:{model:e.controlDialog.inputAttribute,rules:e.controlDialog.inputRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.inputAttribute.name,callback:function(t){e.$set(e.controlDialog.inputAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.inputAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:50,max:999,placeholder:"最小50，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.inputAttribute.width,callback:function(t){e.$set(e.controlDialog.inputAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.inputAttribute.width"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addInputSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"textarea"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'textarea'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      文本域属性\n    ")]),e._v(" "),o("el-form",{ref:"textareaForm",attrs:{model:e.controlDialog.textareaAttribute,rules:e.controlDialog.textareaRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.textareaAttribute.name,callback:function(t){e.$set(e.controlDialog.textareaAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.textareaAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:50,max:999,placeholder:"最小50，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.textareaAttribute.width,callback:function(t){e.$set(e.controlDialog.textareaAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.textareaAttribute.width"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addTextareaSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"date"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'date'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      日期控件属性\n    ")]),e._v(" "),o("el-form",{ref:"dateForm",attrs:{model:e.controlDialog.dateAttribute,rules:e.controlDialog.dateRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.dateAttribute.name,callback:function(t){e.$set(e.controlDialog.dateAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.dateAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"最小60，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.dateAttribute.width,callback:function(t){e.$set(e.controlDialog.dateAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.dateAttribute.width"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"日期格式",prop:"height"}},[o("el-select",{staticStyle:{width:"100% !important"},attrs:{placeholder:"请选择日期格式"},model:{value:e.controlDialog.dateAttribute.format,callback:function(t){e.$set(e.controlDialog.dateAttribute,"format",t)},expression:"controlDialog.dateAttribute.format"}},[o("el-option",{key:"yyyy-MM-dd",attrs:{label:"yyyy-MM-dd",value:"yyyy-MM-dd"}}),e._v(" "),o("el-option",{key:"yyyy年MM月dd日",attrs:{label:"yyyy年MM月dd日",value:"yyyy年MM月dd日"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addDateSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"select"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'select'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      下拉框属性\n    ")]),e._v(" "),o("el-form",{ref:"selectForm",attrs:{model:e.controlDialog.selectAttribute,rules:e.controlDialog.selectRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.selectAttribute.name,callback:function(t){e.$set(e.controlDialog.selectAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.selectAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"最小50，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.selectAttribute.width,callback:function(t){e.$set(e.controlDialog.selectAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.selectAttribute.width"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.selectAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value","string"==typeof o?o.trim():o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text","string"==typeof o?o.trim():o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index-1,0,e.controlDialog.selectAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.selectAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index+1,0,e.controlDialog.selectAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.selectAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.selectAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addSelectSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"checkbox"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'checkbox'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      多选框属性\n    ")]),e._v(" "),o("el-form",{ref:"checkboxForm",attrs:{model:e.controlDialog.checkboxAttribute,rules:e.controlDialog.checkboxRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.checkboxAttribute.name,callback:function(t){e.$set(e.controlDialog.checkboxAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.checkboxAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}}),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-switch",{attrs:{"active-text":"水平布局","inactive-text":"垂直布局"},model:{value:e.controlDialog.checkboxAttribute.horizon,callback:function(t){e.$set(e.controlDialog.checkboxAttribute,"horizon",t)},expression:"controlDialog.checkboxAttribute.horizon"}})],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.checkboxAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value","string"==typeof o?o.trim():o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text","string"==typeof o?o.trim():o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index-1,0,e.controlDialog.checkboxAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.checkboxAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index+1,0,e.controlDialog.checkboxAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.checkboxAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.checkboxAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addCheckboxSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"radio"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'radio'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      单选框属性\n    ")]),e._v(" "),o("el-form",{ref:"radioForm",attrs:{model:e.controlDialog.radioAttribute,rules:e.controlDialog.radioRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.radioAttribute.name,callback:function(t){e.$set(e.controlDialog.radioAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.radioAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}}),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-switch",{attrs:{"active-text":"水平布局","inactive-text":"垂直布局"},model:{value:e.controlDialog.radioAttribute.horizon,callback:function(t){e.$set(e.controlDialog.radioAttribute,"horizon",t)},expression:"controlDialog.radioAttribute.horizon"}})],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.radioAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value","string"==typeof o?o.trim():o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text","string"==typeof o?o.trim():o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index-1,0,e.controlDialog.radioAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.radioAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index+1,0,e.controlDialog.radioAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.radioAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.radioAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addRadioSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"numeric"===e.editControl.type,width:e.controlDialog.dialogWidth3},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'numeric'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      数字控件属性\n    ")]),e._v(" "),o("el-form",{ref:"numericForm",attrs:{model:e.controlDialog.numericAttribute,rules:e.controlDialog.numericRules,"label-width":"80px",size:"mini"}},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.numericAttribute.name,callback:function(t){e.$set(e.controlDialog.numericAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.numericAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"最小50，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.numericAttribute.width,callback:function(t){e.$set(e.controlDialog.numericAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.numericAttribute.width"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:"小数位",prop:"precision"}},[o("el-input",{attrs:{min:0,max:6,placeholder:"默认两位小数",autocomplete:"off"},model:{value:e.controlDialog.numericAttribute.precision,callback:function(t){e.$set(e.controlDialog.numericAttribute,"precision",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.numericAttribute.precision"}})],1)],1)],1)],1),e._v(" "),o("el-alert",{attrs:{title:"公式",type:"info",closable:!1}}),e._v(" "),o("hr",{staticStyle:{border:"#ddd 0px dotted"}}),e._v(" "),o("el-row",[o("el-col",{attrs:{span:3}},[e._v("数字：")]),e._v(" "),o("el-col",{attrs:{span:21}},[o("el-button-group",[o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("1")}}},[o("i",{staticClass:"iconfont fe-iconfont-number1"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("2")}}},[o("i",{staticClass:"iconfont fe-iconfont-number2"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("3")}}},[o("i",{staticClass:"iconfont fe-iconfont-number3"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("4")}}},[o("i",{staticClass:"iconfont fe-iconfont-number4"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("5")}}},[o("i",{staticClass:"iconfont fe-iconfont-number5"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("6")}}},[o("i",{staticClass:"iconfont fe-iconfont-number6"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("7")}}},[o("i",{staticClass:"iconfont fe-iconfont-number7"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("8")}}},[o("i",{staticClass:"iconfont fe-iconfont-number8"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("9")}}},[o("i",{staticClass:"iconfont fe-iconfont-number9"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric("0")}}},[o("i",{staticClass:"iconfont fe-iconfont-number0"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addNumeric(".")}}},[o("i",{staticClass:"iconfont fe-iconfont-single-dot"})])],1)],1)],1),e._v(" "),o("hr",{staticStyle:{border:"#ddd 0px dotted"}}),e._v(" "),o("el-row",[o("el-col",{attrs:{span:3}},[e._v("操作符：")]),e._v(" "),o("el-col",{attrs:{span:21}},[o("el-button-group",[o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addOperator("+")}}},[o("i",{staticClass:"iconfont fe-iconfont-plus"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addOperator("-")}}},[o("i",{staticClass:"iconfont fe-iconfont-minus"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addOperator("*")}}},[o("i",{staticClass:"iconfont fe-iconfont-multiply"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addOperator("/")}}},[o("i",{staticClass:"iconfont fe-iconfont-divide"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addBracket("(")}}},[o("i",{staticClass:"iconfont fe-iconfont-bracket-left"})]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addBracket(")")}}},[o("i",{staticClass:"iconfont fe-iconfont-bracket-right"})]),e._v(" "),o("el-button",{attrs:{size:"mini",disabled:!0}},[o("i",{staticClass:"iconfont fe-iconfont-blank"})]),e._v(" "),o("el-button",{attrs:{size:"mini",title:"回退"},on:{click:e.backspace}},[o("i",{staticClass:"iconfont fe-iconfont-backspace"})]),e._v(" "),o("el-button",{attrs:{size:"mini",title:"清空"},on:{click:e.clear}},[o("i",{staticClass:"iconfont fe-iconfont-ac"})])],1)],1)],1),e._v(" "),o("hr",{staticStyle:{border:"#ddd 0px dotted"}}),e._v(" "),o("el-row",[o("el-col",{attrs:{span:3}},[e._v("项目：")]),e._v(" "),o("el-col",{attrs:{span:21}},[o("el-select",{ref:"operateItem",staticStyle:{width:"250px !important"},attrs:{size:"mini",placeholder:"请选择"},model:{value:e.controlDialog.numericAttribute.numericItem,callback:function(t){e.$set(e.controlDialog.numericAttribute,"numericItem",t)},expression:"controlDialog.numericAttribute.numericItem"}},e._l(e.controlDialog.numericItems,function(e){return o("el-option",{key:e.itemid,attrs:{label:e.name,value:e.itemid}})})),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:e.addItem}},[e._v("添加")])],1)],1),e._v(" "),o("hr",{staticStyle:{border:"#ddd 0px dotted"}}),e._v(" "),o("el-row",[o("el-col",{attrs:{span:3}},[e._v("预览：")]),e._v(" "),o("el-col",{attrs:{span:21}},[o("el-card",{staticClass:"box-card",staticStyle:{"padding-bottom":"20px"}},e._l(e.controlDialog.numericAttribute.displayItems,function(t,i){return o("div",{key:i},[o("div",{class:t.type+" ",staticStyle:{float:"left",padding:"3px"},domProps:{innerHTML:e._s(t.text)}})])}))],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addNumericSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"sequence"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'sequence'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      序列号属性\n    ")]),e._v(" "),o("el-form",{ref:"sequenceForm",attrs:{model:e.controlDialog.sequenceAttribute,rules:e.controlDialog.sequenceRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.sequenceAttribute.name,callback:function(t){e.$set(e.controlDialog.sequenceAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.sequenceAttribute.name"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addSequenceSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{visible:"refer"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'refer'",t)},open:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      参照窗口属性\n    ")]),e._v(" "),o("el-form",{ref:"referForm",attrs:{model:e.controlDialog.referAttribute,rules:e.controlDialog.referRules,"label-width":"80px",size:"mini"}},[o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,autocomplete:"off"},model:{value:e.controlDialog.referAttribute.name,callback:function(t){e.$set(e.controlDialog.referAttribute,"name","string"==typeof t?t.trim():t)},expression:"controlDialog.referAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"最小50，空表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.referAttribute.width,callback:function(t){e.$set(e.controlDialog.referAttribute,"width",e._n("string"==typeof t?t.trim():t))},expression:"controlDialog.referAttribute.width"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"参照窗口",prop:"referCode"}},[o("el-input",{attrs:{placeholder:"输入参照窗口编码",autocomplete:"off"},on:{change:e.resolveRefer},model:{value:e.controlDialog.referAttribute.referCode,callback:function(t){e.$set(e.controlDialog.referAttribute,"referCode","string"==typeof t?t.trim():t)},expression:"controlDialog.referAttribute.referCode"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),e.controlDialog.referInfo.name?o("el-col",{attrs:{span:11}},[o("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(e.controlDialog.referInfo.name))])],1):e._e()],1),e._v(" "),e.controlDialog.referColumnList&&e.controlDialog.referColumnList.length>0?o("div",[o("el-alert",{attrs:{title:"映射关系",type:"info",closable:!1}})],1):e._e(),e._v(" "),e._l(e.controlDialog.referAttribute.maps,function(t,i){return o("el-row",{key:"row"+i},[o("el-col",{attrs:{span:11}},[o("el-select",{key:"from"+i,staticClass:"whole-size",staticStyle:{width:"99% !important"},attrs:{clearable:"",size:"mini",placeholder:"请选择"},model:{value:t.from,callback:function(o){e.$set(t,"from",o)},expression:"map.from"}},e._l(e.controlDialog.referColumnList,function(e){return o("el-option",{key:e.col,attrs:{label:e.colName,value:e.col}})}))],1),e._v(" "),o("el-col",{attrs:{span:2}},[e._v("  --\x3e")]),e._v(" "),o("el-col",{attrs:{span:11}},[o("el-select",{key:"to"+i,staticClass:"whole-size",staticStyle:{width:"99% !important"},attrs:{clearable:"",size:"mini",placeholder:"请选择"},model:{value:t.to,callback:function(o){e.$set(t,"to",o)},expression:"map.to"}},e._l(e.items,function(e){return o("el-option",{key:e.itemid,attrs:{label:e.name,value:e.itemid}})}))],1)],1)})],2),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addReferSave}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"保存表单",visible:e.saveDialog.visible,width:"320px"},on:{"update:visible":function(t){e.$set(e.saveDialog,"visible",t)}}},[o("el-form",{attrs:{"label-width":"60px",rules:e.saveDialog.saveFormRule,model:e.saveDialog.saveForm,size:"small"}},[o("el-form-item",{attrs:{label:"标识"}},[o("el-input",{attrs:{disabled:!0,"max-length":"32"},model:{value:e.saveDialog.saveForm.formKey,callback:function(t){e.$set(e.saveDialog.saveForm,"formKey","string"==typeof t?t.trim():t)},expression:"saveDialog.saveForm.formKey"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"分类"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.saveDialog.saveForm.formType,callback:function(t){e.$set(e.saveDialog.saveForm,"formType",t)},expression:"saveDialog.saveForm.formType"}},e._l(e.formTypeList,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{"max-length":"32"},model:{value:e.saveDialog.saveForm.name,callback:function(t){e.$set(e.saveDialog.saveForm,"name","string"==typeof t?t.trim():t)},expression:"saveDialog.saveForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"说明"}},[o("el-input",{attrs:{"max-length":"50"},model:{value:e.saveDialog.saveForm.remark,callback:function(t){e.$set(e.saveDialog.saveForm,"remark","string"==typeof t?t.trim():t)},expression:"saveDialog.saveForm.remark"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(t){e.saveDialog.visible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.saveForm}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var g=function(e){o("t8Qy"),o("TnnG")},C=o("VU/8")(_.a,p,!1,g,"data-v-d8648fb6",null).exports,v=o("NYxO"),E={name:"EditorToolbar",data:function(){return{}},computed:{fontFamilyItems:function(){return this.$store.state.editorToolbarStatus.fontFamilyItems},fontSizeItems:function(){return this.$store.state.editorToolbarStatus.fontSizeItems},fontsize:{get:function(){return this.$store.state.editorToolbarStatus.fontsize},set:function(e){this.setEditorToolbarStatusFontsize("newValue")}},fontfamily:{get:function(){return this.$store.state.editorToolbarStatus.fontfamily},set:function(e){this.setEditorToolbarStatusFontfamily("newValue")}}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({execEditorCommand:function(e,t){window.__EDITOR__&&window.__EDITOR__.execCommand(e,t)},select:function(){window.__EDITOR__.isFocus()||window.__EDITOR__.focus()}},Object(v.b)(["setEditorToolbarStatusFontsize","setEditorToolbarStatusFontfamily"]))},w={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-editor-toolbar-buttons"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"粗体"},on:{click:function(t){e.execEditorCommand("bold")}}},[o("i",{staticClass:"iconfont fe-iconfont-bold"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"斜体"},on:{click:function(t){e.execEditorCommand("italic")}}},[o("i",{staticClass:"iconfont fe-iconfont-italic"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下划线"},on:{click:function(t){e.execEditorCommand("underline")}}},[o("i",{staticClass:"iconfont fe-iconfont-underline"})])],1),e._v(" "),o("el-select",{attrs:{size:"mini",placeholder:"字体"},on:{"visible-change":e.select,change:function(t){e.execEditorCommand("fontfamily",t)}},model:{value:e.fontfamily,callback:function(t){e.fontfamily=t},expression:"fontfamily"}},e._l(e.fontFamilyItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-select",{attrs:{size:"mini",placeholder:"字号"},on:{"visible-change":e.select,change:function(t){e.execEditorCommand("fontsize",t)}},model:{value:e.fontsize,callback:function(t){e.fontsize=t},expression:"fontsize"}},e._l(e.fontSizeItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)},staticRenderFns:[]};var y=o("VU/8")(E,w,!1,function(e){o("ZUP7")},"data-v-7ef39e1b",null).exports,A=o("ZoQJ"),T={name:"ContentTable",computed:{area:function(){return this.$store.state.area},detail:function(){return this.$store.state.detail},type:function(){return this.$store.state.cache.type},selectedColIndexList:function(){return this.$store.state.selectedColIndexList},rows:function(){return this.$store.state.rows},rowNum:function(){return this.$store.state.rowNum},cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultColWidth:function(){return this.$store.state.config.defaultColWidth},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},begin:function(){return this.$store.state.cache.select.selectedArea.begin},end:function(){return this.$store.state.cache.select.selectedArea.end},cells:function(){return this.$store.state.cells},beginCell:function(){return this.$store.state.cache.select.beginCell},cacheEditCell:function(){return this.$store.state.cache.editCell},borderDefault:function(){return this.$store.state.config.borderDefault},borderDefaultColor:function(){return this.$store.state.config.borderDefaultColor},borderDefaultStyle:function(){return this.$store.state.config.borderDefaultStyle},borderDefaultWidth:function(){return this.$store.state.config.borderDefaultWidth},selectedBorderDefaultColor:function(){return this.$store.state.config.selectedBorderDefaultColor},selectedBorderDefaultStyle:function(){return this.$store.state.config.selectedBorderDefaultStyle},selectedBorderDefaultWidth:function(){return this.$store.state.config.selectedBorderDefaultWidth},selectedBorderDefault:function(){return this.$store.state.config.selectedBorderDefault},selectedCellBackground:function(){return this.$store.state.config.selectedCellBackground},copy:function(){return this.$store.state.cache.copy},editInCell:function(){return this.$store.state.config.editInCell},timestamp:function(){return this.$store.state.timestamp}},data:function(){return{tableOffsetTop:0,tableOffsetLeft:0,mouseoverRow:void 0,mouseoverCol:void 0,thisTimeStamp:0}},mounted:function(){this.tableOffsetTop=document.querySelector("#fe-content-table-table").offsetTop,this.tableOffsetLeft=document.querySelector("#fe-content-table-table").offsetLeft,this.$store.state.cache.select.selectedArea.begin.row||(this.beginSelectCell({row:1,col:1}),this.endSelectCell({row:1,col:1}))},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({isTdShow:function(e,t){return!this.cells[e][t]||!this.cells[e][t].hidden},showMenu:function(e){var t=this.copy.row&&this.copu.col;if(e.target.hasAttribute("col-header")){var o=[{icon:"fe-iconfont-insert-column",text:"插入列",disabled:!1,handler:this.insertCol},{icon:"fe-iconfont-delete-column",text:"删除列",disabled:!1,handler:this.deleteCol}];t&&o.splice(0,1),this.showContentMenu({e:e,width:135,menus:o})}else if(e.target.hasAttribute("row-header")){var i=[{icon:"fe-iconfont-insert-row",text:"插入行",disabled:!1,handler:this.insertRow},{icon:"fe-iconfont-delete-row",text:"删除行",disabled:!1,handler:this.deleteRow}];t&&i.splice(0,1),this.showContentMenu({e:e,width:135,menus:i})}},displayHeadCharactor:function(e){var t=parseInt((e-1)/26),o=(e-1)%26;return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(t-1,t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(o,o+1)},getCellBorderTop:function(e,t,o){return o&&o.selected&&o.selected_is_top?this.selectedBorderDefault:e===this.detail.beginCell.row&&t>=this.detail.beginCell.col&&t<=this.detail.endCell.col?"dotted 2px #000000":o&&o.borderTop?o.borderTop:this.borderDefault},getCellBorderLeft:function(e,t,o){return o&&o.selected&&o.selected_is_left?this.selectedBorderDefault:e===this.detail.beginCell.row&&t===this.detail.beginCell.col?"dotted 2px #000000":o&&o.borderLeft?o.borderLeft:this.borderDefault},getCellBorderBottom:function(e,t,o){return o&&o.selected&&o.selected_is_bottom?this.selectedBorderDefault:e===this.detail.endCell.row&&t>=this.detail.beginCell.col&&t<=this.detail.endCell.col?"dotted 2px #000000":o&&o.borderBottom?o.borderBottom:this.borderDefault},getCellBorderRight:function(e,t,o){return o&&o.selected&&o.selected_is_right?this.selectedBorderDefault:e===this.detail.beginCell.row&&t===this.detail.endCell.col?"dotted 2px #000000":o&&o.borderRight?o.borderRight:this.borderDefault},getCellStyle:function(e,t,o){return{borderTop:this.getCellBorderTop(e,t,o),borderLeft:this.getCellBorderLeft(e,t,o),borderBottom:this.getCellBorderBottom(e,t,o),borderRight:this.getCellBorderRight(e,t,o),background:this.getCellBackground(e,t,o),textAlign:this.getCellTextalign(e,t,o),verticalAlign:this.getCellVertialalign(e,t,o),fontSize:this.getCellTextFontSize(e,t,o),fontFamily:this.getCellTextFontFamily(e,t,o),color:this.getCellTextColor(e,t,o)}},isColSelected:function(e){for(var t in this.selectedColIndexList)if(this.selectedColIndexList[t]===e)return!0;return!1},getCell:function(e,t){return this.cells[e][t]?this.cells[e][t]:{}},getCellContent:function(e,t,o){return o?o.content:""},isCellContentEditable:function(e,t){return this.cacheEditCell.row===e&&this.cacheEditCell.col===t},getCellRowspan:function(e,t,o){if(o)return o.rowspan},getCellColspan:function(e,t,o){if(o)return o.colspan},getCellTextalign:function(e,t){if(this.cells[e][t])return this.cells[e][t].textAlign},getCellVertialalign:function(e,t){if(this.cells[e][t])return this.cells[e][t].verticalAlign},getCellTextFontSize:function(e,t){if(this.cells[e][t])return this.cells[e][t].fontSize},getCellTextFontFamily:function(e,t){if(this.cells[e][t])return this.cells[e][t].fontFamily},getCellTextColor:function(e,t){if(this.cells[e][t])return this.cells[e][t].color},getCellBackground:function(e,t,o){return o&&o.background?o.background:o&&o.selected?this.selectedCellBackground:void 0},getColWidth:function(e){return this.cols[e].width},getRowHeight:function(e){return this.rows[e].height},handleMouseMove:function(e){var t=e.target.hasAttribute("col-header"),o=e.target.hasAttribute("row-header");t&&""===this.type?e.clientX-e.target.offsetLeft+this.tableOffsetLeft<=3||e.target.offsetLeft+this.tableOffsetLeft+e.target.clientWidth-e.clientX<=3?e.target.style.cursor="col-resize":e.target.style.cursor="pointer":o&&""===this.type?e.clientY-e.target.offsetTop+this.tableOffsetTop<=3||e.target.offsetTop+this.tableOffsetTop+e.target.clientHeight-e.clientY<=3?e.target.style.cursor="row-resize":e.target.style.cursor="pointer":"resize-col"===this.type?e.target.style.cursor="col-resize":"resize-row"===this.type&&(e.target.style.cursor="row-resize"),"resize-col"===this.type&&e.target.hasAttribute("col-header")?this.dragResizeCol({location:{x:e.clientX,y:e.clientY}}):"resize-row"===this.type&&e.target.hasAttribute("row-header")&&this.dragResizeRow({location:{x:e.clientX,y:e.clientY}})},handleMouseOver:function(e){var t=null,o=e.target.hasAttribute("table-content")||(t=Object(A.b)(e,"table-content"));if(o&&!t&&(t=e.target),o){var i=Object(A.e)(t.getAttribute("row")||1),l=Object(A.e)(t.getAttribute("col")||1);if(i===this.mouseoverRow&&l===this.mouseoverCol)return;"select"!==this.type&&"edit-cell"!==this.type||this.dragSelect({event:e,row:i,col:l})}},handleMouseDown:function(e){var t=e.target.hasAttribute("col-header"),o=e.target.hasAttribute("row-header"),i=e.target.hasAttribute("table-selector"),l=null,r=e.target.hasAttribute("table-content")||(l=Object(A.b)(e,"table-content"));r&&!l&&(l=e.target);var n=Object(A.e)(e.target.getAttribute("col")||1),a=Object(A.e)(e.target.getAttribute("row")||1);if(t)e.clientX-e.target.offsetLeft+this.tableOffsetLeft<=3||e.target.offsetLeft+this.tableOffsetLeft+e.target.clientWidth-e.clientX<=3?(e.target.clientWidth>=7&&e.clientX-e.target.offsetLeft<=3&&(n-=1),this.beginResizeCol({col:n,beginLocation:{x:e.clientX,y:e.clientY}})):this.selectCol(n);else if(o)e.clientY-e.target.offsetTop+this.tableOffsetTop<=3||e.target.offsetTop+this.tableOffsetTop+e.target.clientHeight-e.clientY<=3?(e.target.clientHeight>=7&&e.clientX-e.target.offsetLeft<=3&&(a-=1),this.beginResizeRow({row:a,beginLocation:{x:e.clientX,y:e.clientY}})):this.selectRow(a);else if(r){var c=Object(A.e)(l.getAttribute("row")||1),s=Object(A.e)(l.getAttribute("col")||1);this.beginSelectCell({event:e,row:c,col:s})}else i&&this.selectTable()},handleMouseUp:function(e){if("resize-col"===this.type)this.endResizeCol({location:{x:e.clientX,y:e.clientY}});else if("resize-row"===this.type)this.endResizeRow({location:{x:e.clientX,y:e.clientY}});else if("select"===this.type){var t=null,o=e.target.hasAttribute("table-content")||(t=Object(A.b)(e,"table-content"));o&&!t&&(t=e.target);var i=Object(A.e)(t.getAttribute("row")||1),l=Object(A.e)(t.getAttribute("col")||1);o&&this.endSelectCell({event:e,row:i,col:l})}},handleMouseLeave:function(e){},handleBlur:function(e){},handleClick:function(e){},handleMouseDblClick:function(e){var t=null,o=e.target.hasAttribute("table-content")||(t=Object(A.b)(e,"table-content"));if(o&&!t&&(t=e.target),o){var i=Object(A.e)(t.getAttribute("row")||1),l=Object(A.e)(t.getAttribute("col")||1);this.beginEditCell({row:i,col:l})}},handleHeadMouseLeave:function(e){"resize-col"===this.type?this.endResizeCol({location:{x:e.clientX,y:e.clientY}}):"resize-row"===this.type&&this.endResizeRow({location:{x:e.clientX,y:e.clientY}})}},Object(v.b)(["selectCol","selectRow","selectTable","beginSelectCell","endSelectCell","dragSelect","exitSelectMode","beginEditCell","endEditCell","beginResizeCol","endResizeCol","dragResizeCol","beginResizeRow","endResizeRow","dragResizeRow","showContentMenu","insertCol","deleteCol","insertRow","deleteRow"])),beforeUpdate:function(){},updated:function(){}},S={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-content-table-container",attrs:{draggable:"false",ondragstart:"javascript: return false;"}},[o("table",{staticClass:"fe-content-table-table",style:{},attrs:{id:"fe-content-table-table",cellspacing:"0",draggable:"false",ondragstart:"javascript: return false;"},on:{mousemove:function(t){e.handleMouseMove(t)},mouseover:function(t){e.handleMouseOver(t)},mousedown:function(t){e.handleMouseDown(t)},mouseup:function(t){e.handleMouseUp(t)},mouseleave:function(t){e.handleMouseLeave(t)},click:function(t){e.handleClick(t)},dblclick:function(t){e.handleMouseDblClick(t)},contextmenu:function(t){t.preventDefault(),e.showMenu(t)}}},[o("tr",{staticClass:"noselect",attrs:{draggable:"false",ondragstart:"javascript: return false;"},on:{mouseleave:e.handleHeadMouseLeave}},[o("td",{staticClass:"fe-content-table-table-th-0",style:{height:e.defaultRowHeight+"px",width:"46px",cursor:"cell"},attrs:{draggable:"false",ondragstart:"javascript: return false;","table-selector":""}}),e._v(" "),e._l(e.cells[0],function(t,i){return 0!==i?o("td",{key:"th"+i,staticClass:"fe-content-table-table-line0",style:{height:e.defaultRowHeight+"px",width:(e.getColWidth(i)||e.defaultColWidth)+"px",boxSizing:"border-box",background:i>=e.area.beginCell.col&&i<=e.area.endCell.col?"#abd5ff":""},attrs:{col:i,draggable:"false",ondragstart:"javascript: return false;","col-header":""}},[e._v("\n          "+e._s(e.displayHeadCharactor(i))+"\n        ")]):e._e()})],2),e._v(" "),e._l(e.cells,function(t,i){return 0!==i?o("tr",{key:i,attrs:{draggable:"false",ondragstart:"javascript: return false;"}},[o("td",{staticClass:"fe-content-table-table-th-1 noselect",style:{height:(e.getRowHeight(i)||e.defaultRowHeight)+"px",background:i>=e.area.beginCell.row&&i<=e.area.endCell.row?"#abd5ff":""},attrs:{draggable:"false",ondragstart:"javascript: return false;","row-header":"",row:i}},[e._v("\n        "+e._s(i)+"\n      ")]),e._v(" "),e._l(t,function(t,l){return 0!==l?o("td",{directives:[{name:"show",rawName:"v-show",value:e.isTdShow(i,l),expression:"isTdShow(row, col)"}],key:l+"@"+i,staticClass:"fe-content-table-table-td",class:{"fe-content-table-copy":e.copy.row===i&&e.copy.col===l,"style-bold-1":t&&t.bold,"style-text-decoration-1":t&&t.textDecoration,"style-italic-1":t&&t.italic},style:e.getCellStyle(i,l,t),attrs:{id:"td_"+i+"_"+l,draggable:"false","table-content":"",row:i,col:l,rowspan:e.getCellRowspan(i,l,t),colspan:e.getCellColspan(i,l,t)}},[t&&"input"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,placeholder:t.attribute.name,clearable:""}}):t&&"textarea"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%",height:t.attribute.height?t.attribute.height+"px":"100%"},attrs:{size:"mini",readonly:!0,autosize:{minRows:2,maxRows:4},type:"textarea",row:10,resize:"none",placeholder:t.attribute.name,clearable:""}}):t&&"date"===t.type?o("el-date-picker",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,type:"date",placeholder:t.attribute.name,clearable:""}}):t&&"select"===t.type?o("el-select",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,disabled:"",placeholder:t.attribute.name}},e._l(t.attribute.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})):t&&"checkbox"===t.type?o("el-checkbox-group",{attrs:{disabled:"",size:"mini"}},[e._l(t.attribute.options,function(i,l){return[o("el-checkbox",{key:i.value,attrs:{label:i.text}},[e._v(e._s(i.text))]),e._v(" "),t.attribute.horizon||l===t.attribute.options.length-1?e._e():[o("br",{key:"br"+i.value})]]})],2):t&&"radio"===t.type?o("el-radio-group",{attrs:{disabled:"",size:"mini"}},[e._l(t.attribute.options,function(i,l){return[o("el-radio",{key:i.value,attrs:{label:i.text}},[e._v(e._s(i.text))]),e._v(" "),t.attribute.horizon||l===t.attribute.options.length-1?e._e():[o("br",{key:"br"+i.value})]]})],2):t&&"numeric"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,type:"numeric",placeholder:t.attribute.name,clearable:""}}):t&&"sequence"===t.type?o("div",[e._v("\n          No.\n        ")]):t&&"refer"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,type:"refer",placeholder:t.attribute.name,clearable:""}}):o("div",{staticClass:"fe-content-table-table-td-div",style:{userSelect:e.isCellContentEditable(i,l)?"":"none"},attrs:{contenteditable:e.isCellContentEditable(i,l),id:"td_content_"+i+"_"+l,draggable:"false"},domProps:{innerHTML:e._s(e.getCellContent(i,l,t))},on:{blur:function(t){e.endEditCell({row:i,col:l})}}})],1):e._e()})],2):e._e()})],2)])},staticRenderFns:[]};var D={name:"FormEditor",components:{Toolbar:C,EditorToolbar:y,ContentTable:o("VU/8")(T,S,!1,function(e){o("AO/F")},"data-v-30b51f4a",null).exports,AllSelector:d,ColSelector:h,RowSelector:m},computed:{cacheType:function(){return this.$store.state.cache.type}},methods:{emitLoading:function(){this.$emit("loading")}}},x={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"flex","flex-direction":"column"}},[t("toolbar",{on:{loading:this.emitLoading}}),this._v(" "),t("content-table")],1)},staticRenderFns:[]};var R=o("VU/8")(D,x,!1,function(e){o("5OHi")},"data-v-54350504",null).exports,L={name:"fe-content-menu",computed:{contextMenu:function(){return this.$store.state.contextMenu}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({},Object(v.b)(["hideContentMenu"]))},I={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.contextMenu.menuItemList.length>0?o("div",{staticClass:"fe-content-menu",style:{left:e.contextMenu.e.clientX+e.contextMenu.width/2-2+"px",top:e.contextMenu.e.clientY-2+"px",minWidth:e.contextMenu.width+"px"},on:{mouseout:function(t){e.hideContentMenu(t)}}},[o("ul",e._l(e.contextMenu.menuItemList,function(t,i){return o("li",{key:i,class:t.disabled?"fe-content-menu-disabled":"",on:{click:t.handler}},[o("i",{class:"iconfont fe-content-menu-icon "+t.icon}),e._v("   "),o("span",{staticClass:"fe-content-menu-text"},[e._v(e._s(t.text))])])}))]):e._e()},staticRenderFns:[]};var O=o("VU/8")(L,I,!1,function(e){o("ZkdS")},"data-v-91e0aaec",null).exports,k={name:"UEditorToolbar",methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({endEdit:function(){console.log("endEdit"),this.$emit("save")}},Object(v.b)(["cancelUEdit"]))},z={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fe-ueditor-toolbar-buttons"},[t("el-button-group",[t("el-button",{attrs:{type:"danger",size:"mini",title:"返回"},on:{click:this.cancelUEdit}},[t("i",{staticClass:"iconfont fe-iconfont-back"})]),this._v(" "),t("el-button",{attrs:{type:"primary",size:"mini",title:"确定"},on:{click:this.endEdit}},[t("i",{staticClass:"iconfont fe-iconfont-yes"})])],1)],1)},staticRenderFns:[]};var P=o("VU/8")(k,z,!1,function(e){o("9YMo")},"data-v-18f7cceb",null).exports,B={name:"NEditorToolbar",methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({endEdit:function(){this.$emit("save")}},Object(v.b)(["cancelUEdit"]))},H={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-ueditor-toolbar-buttons"},[o("el-button-group",[o("el-button",{attrs:{size:"mini",title:"返回"},on:{click:e.cancelUEdit}},[o("i",{staticClass:"iconfont fe-iconfont-back"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"确定"},on:{click:e.endEdit}},[o("i",{staticClass:"iconfont fe-iconfont-yes"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{size:"mini",type:"primary",title:"普通文本框"}},[o("i",{staticClass:"iconfont "},[e._v("文本框")])]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary",title:"日期选择框"}},[o("i",{staticClass:"iconfont "},[e._v("日期控件")])]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary",title:"多行文本框"}},[o("i",{staticClass:"iconfont "},[e._v("多行文本")])])],1)],1)},staticRenderFns:[]};var $=o("VU/8")(B,H,!1,function(e){o("EwKG")},"data-v-31d0ead8",null).exports,M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},N={name:"UEditor",components:{UEditorToolbar:P,NEditorToolbar:$},data:function(){return{editor:null}},props:{defaultMsg:{type:String},config:{type:Object},id:{type:String}},computed:{ueditContent:function(){return this.$store.state.cache.uedit.content}},mounted:function(){var e=this;this.editor=UE.getEditor(this.id,this.config),window.__EDITOR__=this.editor,this.editor.commands.cancel={execCommand:function(){e.cancelUEdit()},queryCommandState:function(){}},this.editor.commands.yes={execCommand:function(){e.saveUEContent()},queryCommandState:function(){}},this.editor.addListener("ready",function(){e.editor.setContent(e.ueditContent||"")})},methods:M({getUEContent:function(){return this.editor.getContent()},getUEContentText:function(){return this.editor.getContentTxt()},saveUEContent:function(){console.log("saveUEContent");var e=this.getUEContent();this.endUEdit({source:e})}},Object(v.b)(["endUEdit","cancelUEdit"])),destroyed:function(){this.editor.destroy()}},U={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("script",{attrs:{id:this.id,type:"text/plain"}})])},staticRenderFns:[]},W={name:"app",components:{FormEditor:R,ContentMenu:O,NEditor:o("VU/8")(N,U,!1,null,null,null).exports},computed:{type:function(){return this.$store.state.cache.type},ueditorConfig:function(){return this.$store.state.config.ueditorConfig}},data:function(){return{contentLoading:!1}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e})({saveUEContent:function(){var e=this.$refs.ueditor.getUEContent();this.endUEdit({source:e})},switchLoading:function(){this.contentLoading=!this.contentLoading},getForm:function(e){var t=this,o=this.$loading({fullscreen:!0,text:"正在请求资源..."});l.a.post("api/field/form/getForm",{id:c,formKey:a}).then(function(e){o.close();var i=e.data,l=JSON.parse(i.json);l.form=i,t.$store.replaceState(Object.assign({},t.$store.state,l))}).catch(function(e){console.log(e)})},getFormType:function(e){var t=this;l.a.post("api/field/formType/list",{refreshToken:e}).then(function(e){var o=e.data.list;t.$store.replaceState(Object.assign({},t.$store.state,{formTypeList:o}))}).catch(function(e){console.log(e)})},async:function(e){var t=this;return new Promise(function(o,i){t.getForm(e)})()}},Object(v.b)(["recordInitState","setCacheType","setForm"])),mounted:function(){this.recordInitState();var e=window.name.split("|")[0];n.a.all([this.getFormType(e),this.getForm(e)]).then(n.a.spread(function(e,t){}))},beforeMount:function(){},beforeUpdate:function(){},updated:function(){}},F={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:this.contentLoading,expression:"contentLoading"}],attrs:{draggable:"false",ondragstart:"javascript: return false;","element-loading-text":"拼命加载中"}},[t("FormEditor",{on:{loading:this.switchLoading}}),this._v(" "),t("ContentMenu")],1)},staticRenderFns:[]};var K=o("VU/8")(W,F,!1,function(e){o("01ie")},null,null).exports,j=o("zL8q"),q=o.n(j),V=0,Y=8;function G(e){return oe(Z(te(e),e.length*Y))}function Z(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var o=Array(80),i=1732584193,l=-271733879,r=-1732584194,n=271733878,a=-1009589776,c=0;c<e.length;c+=16){for(var s=i,d=l,u=r,f=n,h=a,b=0;b<80;b++){o[b]=b<16?e[c+b]:ee(o[b-3]^o[b-8]^o[b-14]^o[b-16],1);var m=Q(Q(ee(i,5),X(b,l,r,n)),Q(Q(a,o[b]),J(b)));a=n,n=r,r=ee(l,30),l=i,i=m}i=Q(i,s),l=Q(l,d),r=Q(r,u),n=Q(n,f),a=Q(a,h)}return Array(i,l,r,n,a)}function X(e,t,o,i){return e<20?t&o|~t&i:e<40?t^o^i:e<60?t&o|t&i|o&i:t^o^i}function J(e){return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514}function Q(e,t){var o=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(o>>16)<<16|65535&o}function ee(e,t){return e<<t|e>>>32-t}function te(e){for(var t=Array(),o=(1<<Y)-1,i=0;i<e.length*Y;i+=Y)t[i>>5]|=(e.charCodeAt(i/Y)&o)<<24-i%32;return t}function oe(e){for(var t=V?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<4*e.length;i++)o+=t.charAt(e[i>>2]>>8*(3-i%4)+4&15)+t.charAt(e[i>>2]>>8*(3-i%4)&15);return o}var ie=o("uAC3"),le=o.n(ie),re=o("kD8Z"),ne=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e};i.default.use(v.a);var ae={config:{defaultColWidth:72,defaultRowHeight:20,predefinedColors:["#000000","#FFFFFF","#FF0000","#FFC000","#FFFF00","#92D050","#00B0F0","#0070C0","#002060","#7030A0"],borderDefaultColor:"#dddddd",borderDefaultStyle:"solid",borderDefaultWidth:"1",borderDefault:"solid 1px #dddddd",selectedBorderDefaultColor:"#000000",selectedBorderDefaultStyle:"solid",selectedBorderDefaultWidth:"2",selectedBorderDefault:"solid 2px #000000",selectedCellBackground:"#EAECF5",editInCell:!1,ueditorConfig:{zIndex:10,customtoolbar:!0,initialFrameWidth:null,initialFrameHeight:null,wordCount:!1,elementPathEnabled:!1,toolbars:[["yes","cancel","|","fullscreen","|","bold","italic","underline","|","forecolor","insertunorderedlist","|","fontfamily","fontsize","|","preview","insertframe","|","controlinput"]],labelMap:{controlinput:"插入文本框",yes:"确定",cancel:"取消编辑"},fontfamily:[{label:"",name:"songti",val:"宋体,SimSun"},{label:"",name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{label:"",name:"yahei",val:"微软雅黑,Microsoft YaHei"},{label:"",name:"heiti",val:"黑体, SimHei"},{label:"",name:"lishu",val:"隶书, SimLi"},{label:"",name:"arial",val:"arial, helvetica,sans-serif"}],fontsize:[10,11,12,14,16,18,20,24,36,72],enableContextMenu:!1,theme:"notadd",xssFilterRules:!1,inputXssFilter:!1,outputXssFilter:!1,iframeCssUrl:"static/neditor/ext/neditor-ext.css"}},cache:{type:"",select:{beginCell:{row:void 0,col:void 0},endCell:{row:void 0,col:void 0},selectedArea:{begin:{row:void 0,col:void 0},end:{row:void 0,col:void 0}}},resizeCol:{targetCol:void 0,initWidth:void 0,begin:{x:void 0,y:void 0},end:{x:void 0,y:void 0}},resizeRow:{targetRow:void 0,initHeight:void 0,begin:{x:void 0,y:void 0},end:{x:void 0,y:void 0}},editCell:{row:void 0,col:void 0},editControl:{type:void 0,row:void 0,col:void 0,attribute:{}},uedit:{row:void 0,col:void 0,content:""},copy:{row:void 0,col:void 0,cell:{}}},rowNum:32,rows:[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],colNum:26,cols:[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],selectedColIndexList:[],cells:[new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27)],contextMenu:{width:150,e:{offsetX:500,offsetY:280},menuItemList:[]},editor:null,stateIndex:void 0,editorToolbarStatus:{fontfamily:"",fontsize:"",fontFamilyItems:[{value:"SimSun",label:"宋体"},{value:"KaiTi",label:"楷体"},{value:"微软雅黑",label:"微软雅黑"},{value:"SimHei",label:"黑体"},{value:"SimLi",label:"隶书"}],fontSizeItems:[{value:"12px",label:"12px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"},{value:"18px",label:"18px"},{value:"20px",label:"20px"},{value:"24px",label:"24px"},{value:"36px",label:"36px"}]},toolbarConfig:{fontFamilyItems:[{value:"SimSun",label:"宋体"},{value:"KaiTi",label:"楷体"},{value:"微软雅黑",label:"微软雅黑"},{value:"SimHei",label:"黑体"},{value:"LiSu",label:"隶书"}],fontSizeItems:[{value:"12px",label:"12px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"},{value:"18px",label:"18px"},{value:"20px",label:"20px"},{value:"24px",label:"24px"},{value:"36px",label:"36px"}]},timestamp:0,form:{formKey:"",name:"",remark:""},formTypeList:[],area:{beginCell:{row:void 0,col:void 0},endCell:{row:void 0,col:void 0}},detail:{beginCell:{row:void 0,col:void 0},endCell:{row:void 0,col:void 0}}},ce={CLEAR_SELECT_AREA:function(e){e.selectedColIndexList=[]},PUSH_SELECTED_COL_INDEX:function(e,t){e.selectedColIndexList.push(t)},SET_CACHE_TYPE:function(e,t){e.cache.type=t},SET_CACHE_SELECTED_AREA_BEGIN:function(e,t){var o=t.row,i=t.col;e.cache.select.selectedArea.begin.row=o,e.cache.select.selectedArea.begin.col=i},SET_CACHE_SELECT_BEGIN_SELECT_CELL:function(e,t){var o=t.row,i=t.col;e.cache.select.beginCell.row=o,e.cache.select.beginCell.col=i},CLEAR_CACHE_SELECT_BEGIN_SELECT_CELL:function(e){e.cache.select.beginCell.row=void 0,e.cache.select.beginCell.col=void 0},SET_CACHE_SELECT_SELECTED_AREA_END:function(e,t){var o=t.row,i=t.col;e.cache.select.selectedArea.end.row=o,e.cache.select.selectedArea.end.col=i},SET_CACHE_SELECT_END_SELECT_CELL:function(e,t){var o=t.row,i=t.col;e.cache.select.endCell.row=o,e.cache.select.endCell.col=i,e.cache.select.selectedArea.begin.row=Math.min(e.cache.select.beginCell.row,e.cache.select.endCell.row),e.cache.select.selectedArea.begin.col=Math.min(e.cache.select.beginCell.col,e.cache.select.endCell.col),e.cache.select.selectedArea.end.row=Math.max(e.cache.select.beginCell.row,e.cache.select.endCell.row),e.cache.select.selectedArea.end.col=Math.max(e.cache.select.beginCell.col,e.cache.select.endCell.col)},SET_CELLS_SELECTED:function(e){for(var t=0;t<=e.cells.length-1;t++)for(var o=0;o<=e.cells[t].length-1;o++){var l=e.cells[t][o];if(t>=e.cache.select.selectedArea.begin.row&&t<=e.cache.select.selectedArea.end.row&&o>=e.cache.select.selectedArea.begin.col&&o<=e.cache.select.selectedArea.end.col)l||(l={},i.default.set(e.cells[t],o,l)),void 0!==l.selected&&!1!==l.selected||i.default.set(l,"selected",!0),t===e.cache.select.selectedArea.begin.row?void 0!==l.selected_is_top&&!1!==l.selected_is_top||i.default.set(l,"selected_is_top",!0):!0===l.selected_is_top&&i.default.set(l,"selected_is_top",!1),t===e.cache.select.selectedArea.end.row||l.row_end===e.cache.select.selectedArea.end.row?void 0!==l.selected_is_bottom&&!1!==l.selected_is_bottom||i.default.set(l,"selected_is_bottom",!0):!0===l.selected_is_bottom&&i.default.set(l,"selected_is_bottom",!1),o===e.cache.select.selectedArea.begin.col?void 0!==l.selected_is_left&&!1!==l.selected_is_left||i.default.set(l,"selected_is_left",!0):!0===l.selected_is_left&&i.default.set(l,"selected_is_left",!1),o===e.cache.select.selectedArea.end.col||l.col_end===e.cache.select.selectedArea.end.col?void 0!==l.selected_is_right&&!1!==l.selected_is_right||i.default.set(l,"selected_is_right",!0):!0===l.selected_is_right&&i.default.set(l,"selected_is_right",!1);else{var r=e.cells[t][o];r&&(!0===r.selected&&i.default.set(r,"selected",!1),!0===r.selected_is_top&&i.default.set(r,"selected_is_top",!1),!0===r.selected_is_bottom&&i.default.set(r,"selected_is_bottom",!1),!0===r.selected_is_left&&i.default.set(r,"selected_is_left",!1),!0===r.selected_is_right&&i.default.set(r,"selected_is_right",!1))}}},SET_CACHE_SELECT_SELECTED_AREA:function(e,t){var o=t.row,i=t.col;e.cache.select.selectedArea.begin.row=Math.min(e.cache.select.selectedArea.begin.row,o),e.cache.select.selectedArea.begin.col=Math.min(e.cache.select.selectedArea.begin.col,i),e.cache.select.selectedArea.end.row=Math.max(e.cache.select.selectedArea.end.row,o),e.cache.select.selectedArea.end.col=Math.max(e.cache.select.selectedArea.end.col,i)},CLEAR_CACHE_SELECT_END_SELECT_CELL:function(e){e.cache.select.endCell.row=void 0,e.cache.select.endCell.col=void 0},SET_CELL_PROPERTIES:function(e,t){var o=t.row,l=t.col,r=t.properties;for(var n in e.cells[o][l]||(e.cells[o][l]={},i.default.set(e.cells[o],l,{})),r)i.default.set(e.cells[o][l],n,r[n])},REMOVE_CELL_PROPERTIES:function(e,t){var o=t.row,l=t.col,r=t.key;i.default.delete(e.cells[o][l],r)},SET_CELL_CONTROL_ATTRIBUTE:function(e,t){var o=t.row,l=t.col,r=t.attribute;for(var n in e.cells[o][l].attribute||i.default.set(e.cells[o][l],"attribute",{}),r)i.default.set(e.cells[o][l].attribute,n,r[n])},REMOVE_CELL_CONTROL_ATTRIBUTE:function(e,t){var o=t.row,l=t.col;e.cells[o][l].attribute&&i.default.delete(e.cells[o][l],"attribute")},INIT_CELL_PROPERTIES:function(e,t){var o=t.row,l=t.col;i.default.set(e.cells[o],l,void 0)},SET_CACHE_RESIZECOL_TARGETCOL:function(e,t){e.cache.resizeCol.targetCol=t},CLEAR_CACHE_RESIZECOL_TARGETCOL:function(e){e.cache.resizeCol.targetCol=void 0},SET_CACHE_RESIZECOL_INITWIDTH:function(e,t){e.cache.resizeCol.initWidth=t},CLEAR_CACHE_RESIZECOL_INITWIDTH:function(e){e.cache.resizeCol.initWidth=void 0},SET_CACHE_RESIZECOL_BEGIN:function(e,t){var o=t.x,i=t.y;e.cache.resizeCol.begin.x=o,e.cache.resizeCol.begin.y=i},CLEAR_CACHE_RESIZECOL_BEGIN:function(e){e.cache.resizeCol.begin.x=void 0,e.cache.resizeCol.begin.y=void 0},SET_CACHE_RESIZECOL_END:function(e,t){var o=t.x,i=t.y;e.cache.resizeCol.end.x=o,e.cache.resizeCol.end.y=i},CLEAR_CACHE_RESIZECOL_END:function(e){e.cache.resizeCol.end.x=void 0,e.cache.resizeCol.end.y=void 0},SET_COL_WIDTH:function(e){if("resize-col"===e.cache.type){var t=e.cache.resizeCol.targetCol;if(t>=1){var o=(e.cache.resizeCol.initWidth||e.config.defaultColWidth)+e.cache.resizeCol.end.x-e.cache.resizeCol.begin.x;o<0?i.default.set(e.cols[t],"width",3):i.default.set(e.cols[t],"width",o)}}},SET_CACHE_RESIZEROW_TARGETROW:function(e,t){e.cache.resizeRow.targetRow=t},CLEAR_CACHE_RESIZEROW_TARGETROW:function(e){e.cache.resizeRow.targetRow=void 0},SET_CACHE_RESIZEROW_INITHEIGHT:function(e,t){e.cache.resizeRow.initHeight=t},CLEAR_CACHE_RESIZEROW_INITHEIGHT:function(e){e.cache.resizeRow.initHeight=void 0},SET_CACHE_RESIZEROW_BEGIN:function(e,t){var o=t.x,i=t.y;e.cache.resizeRow.begin.x=o,e.cache.resizeRow.begin.y=i},CLEAR_CACHE_RESIZEROW_BEGIN:function(e){e.cache.resizeRow.begin.x=void 0,e.cache.resizeRow.begin.y=void 0},SET_CACHE_RESIZEROW_END:function(e,t){var o=t.x,i=t.y;e.cache.resizeRow.end.x=o,e.cache.resizeRow.end.y=i},CLEAR_CACHE_RESIZEROW_END:function(e){e.cache.resizeRow.end.x=void 0,e.cache.resizeRow.end.y=void 0},SET_ROW_HEIGHT:function(e){if("resize-row"===e.cache.type){var t=e.cache.resizeRow.targetRow;if(t>=1){var o=(e.cache.resizeRow.initHeight||e.config.defaultRowHeight)+e.cache.resizeRow.end.y-e.cache.resizeRow.begin.y;o<0?i.default.set(e.rows[t],"height",3):i.default.set(e.rows[t],"height",o)}}},SET_CACHE_EDITCELL_TARGETCELL:function(e,t){var o=t.row,i=t.col;e.cache.editCell.row=o,e.cache.editCell.col=i},CLEAR_CACHE_EDITCELL_TARGETCELL:function(e,t){t.row,t.col;e.cache.editCell.row=void 0,e.cache.editCell.col=void 0},SET_CACHE_EDITCONTROL:function(e,t){var o=t.row,i=t.col,l=t.type;e.cache.editControl.row=o,e.cache.editControl.col=i,e.cache.editControl.type=l},CLEAR_CACHE_EDITCONTROL:function(e){e.cache.editControl.row=void 0,e.cache.editControl.col=void 0,e.cache.editControl.type=void 0},SET_CACHE_EDITCONTROL_ATTRIBUTE:function(e,t){var o=t.attribute;for(var l in o)void 0===e.cache.editControl.attribute[l]?i.default.set(e.cache.editControl.attribute,l,o[l]):e.cache.editControl.attribute[l]=o[l]},CLEAR_CACHE_EDITCONTROL_ATTRIBUTE:function(e){for(var t in e.cache.editControl.attribute)i.default.delete(e.cache.editControl.attribute,t)},INSERT_COL:function(e,t){e.cols.splice(t+1,0,{});for(var o=1;o<e.rowNum;o++){var i=e.cells[o][t+1]&&e.cells[o][t+1].hidden;i?e.cells[o].splice(t+1,0,{hidden:i}):e.cells[o].splice(t+1,0,{})}for(var l=0;l<=e.rowNum;l++)for(var r=0;r<=e.colNum;r++){var n=e.cells[l][r];n&&!n.hidden&&n.colspan&&n.colspan>1&&t>=r&&t<n.col_end&&(n.colspan=n.colspan+1,n.col_end=n.col_end+1)}e.colNum=e.colNum+1},DELETE_COL:function(e,t){e.cols.splice(t,1);for(var o=1;o<e.rowNum;o++){var i=e.cells[o][t];if(i&&i.colspan>1&&!i.hidden)do{e.cells[o][t+1].hidden=!1,i.colspan=i.colspan-1}while(i.colspan>1);if(!0===i.hidden&&e.cells[e.cells[o][t].row_parent][e.cells[o][t].col_parent].row_end===o){var l=e.cells[e.cells[o][t].row_parent][e.cells[o][t].col_parent];l.colspan=l.colspan-1,l.col_end=l.col_end-1}e.cells[o].splice(t,1)}e.colNum=e.colNum-1},INSERT_ROW:function(e,t){e.rows.splice(t+1,0,{}),e.cells.splice(t+1,0,[]),e.rowNum=e.rowNum+1;for(var o=1;o<e.colNum;o++){e.cells[t+2][o]&&e.cells[t+2][o].hidden?(e.cells[t+1][o]||i.default.set(e.cells[t+1],o,{}),i.default.set(e.cells[t+1][o],"hidden",!0)):e.cells[t+1][o]||i.default.set(e.cells[t+1],o,{})}for(var l=0;l<=e.rowNum;l++)for(var r=0;r<=e.colNum;r++){var n=e.cells[l][r];n&&!n.hidden&&n.rowspan&&n.rowspan>1&&t>=l&&t<n.row_end&&(n.rowspan=n.rowspan+1,n.row_end=n.row_end+1)}},DELETE_ROW:function(e,t){e.rows.splice(t,1);for(var o=1;o<e.colNum;o++){var i=e.cells[t][o];if(i&&i.rowspan>1&&!i.hidden)do{e.cells[t+1][o].hidden=!1,i.rowspan=i.rowspan-1}while(i.rowspan>1);if(!0===i.hidden&&e.cells[e.cells[t][o].row_parent][e.cells[t][o].col_parent].col_end===o){var l=e.cells[e.cells[t][o].row_parent][e.cells[t][o].col_parent];l.rowspan=l.rowspan-1,l.row_end=l.row_end-1}}e.cells.splice(t,1),e.rowNum=e.rowNum-1},SET_CACHE_UEDIT:function(e,t){var o=t.key,i=t.value;e.cache.uedit[o]=i},PUSH_BACKLIST:function(e){console.time("PUSH_BACKLIST");var t=JSON.parse(Object(A.a)(re.b)||"[]"),o=Object(A.e)(Object(A.a)(re.a));o+=1,t.splice(o,999),t.push(JSON.parse(JSON.stringify(e))),Object(A.d)(re.b,JSON.stringify(t)),Object(A.d)(re.a,o),e.stateIndex=o,console.timeEnd("PUSH_BACKLIST")},SET_CACHE_COPY:function(e,t){var o=t.row,i=t.col,l=t.cell;for(var r in e.cache.copy.row=o,e.cache.copy.col=i,l)e.cache.copy.cell[r]=l[r]},CLEAR_CACHE_COPY:function(e){for(var t in e.cache.copy.row=void 0,e.cache.copy.col=void 0,e.cache.copy.cell)i.default.delete(e.cache.copy,t)},SET_EDITOR:function(e,t){i.default.set(e,"editor",t)},SET_EDITOR_TOOLBAR_STATUS:function(e,t){var o=t.fontsize,i=t.fontfamily;void 0!==o&&(e.editorToolbarStatus.fontsize=o),void 0!==i&&(e.editorToolbarStatus.fontfamily=i)},REFRESH_TIMESTAMP:function(e){e.timestamp=(new Date).getTime()},SET_CELLS_BOLD:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,l=e.cache.select.selectedArea.begin.col,r=e.cache.select.selectedArea.end.col,n=!0,a=t;a<=o;a++)for(var c=l;c<=r;c++)if(e.cells[a][c]&&!0!==e.cells[a][c].hidden&&!0!==e.cells[a][c].bold){n=!1;break}if(n)for(var s=t;s<=o;s++)for(var d=l;d<=r;d++)e.cells[s][d]&&e.cells[s][d].bold&&i.default.delete(e.cells[s][d],"bold");else for(var u=t;u<=o;u++)for(var f=l;f<=r;f++)e.cells[u][f]?e.cells[u][f]&&i.default.set(e.cells[u][f],"bold",!0):(i.default.set(e.cells[u],f,{}),i.default.set(e.cells[u][f],"bold",!0))}},SET_CELLS_TEXT_DECORATION:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,l=e.cache.select.selectedArea.begin.col,r=e.cache.select.selectedArea.end.col,n=!0,a=t;a<=o;a++)for(var c=l;c<=r;c++)if(e.cells[a][c]&&!0!==e.cells[a][c].hidden&&!0!==e.cells[a][c].textDecoration){n=!1;break}if(n)for(var s=t;s<=o;s++)for(var d=l;d<=r;d++)e.cells[s][d]&&e.cells[s][d].textDecoration&&i.default.delete(e.cells[s][d],"textDecoration");else for(var u=t;u<=o;u++)for(var f=l;f<=r;f++)e.cells[u][f]?e.cells[u][f]&&i.default.set(e.cells[u][f],"textDecoration",!0):(i.default.set(e.cells[u],f,{}),i.default.set(e.cells[u][f],"textDecoration",!0))}},SET_CELLS_ITALIC:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,l=e.cache.select.selectedArea.begin.col,r=e.cache.select.selectedArea.end.col,n=!0,a=t;a<=o;a++)for(var c=l;c<=r;c++)if(e.cells[a][c]&&!0!==e.cells[a][c].hidden&&!0!==e.cells[a][c].italic){n=!1;break}if(n)for(var s=t;s<=o;s++)for(var d=l;d<=r;d++)e.cells[s][d]&&e.cells[s][d].italic&&i.default.delete(e.cells[s][d],"italic");else for(var u=t;u<=o;u++)for(var f=l;f<=r;f++)e.cells[u][f]?e.cells[u][f]&&i.default.set(e.cells[u][f],"italic",!0):(i.default.set(e.cells[u],f,{}),i.default.set(e.cells[u][f],"italic",!0))}},SET_FORM:function(e,t){e.form=t},SET_AREA:function(e){e.area.beginCell.row=e.cache.select.selectedArea.begin.row,e.area.beginCell.col=e.cache.select.selectedArea.begin.col,e.area.endCell.row=e.cache.select.selectedArea.end.row,e.area.endCell.col=e.cache.select.selectedArea.end.col},SET_DETAIL:function(e){e.detail.beginCell.row=e.cache.select.selectedArea.begin.row,e.detail.beginCell.col=e.cache.select.selectedArea.begin.col,e.detail.endCell.row=e.cache.select.selectedArea.begin.row,e.detail.endCell.col=e.cache.select.selectedArea.end.col},RESET_DETAIL:function(e,t){var o=t.beginCell,i=t.endCell;e.detail.beginCell.row=o.row,e.detail.beginCell.col=o.col,e.detail.endCell.row=i.row,e.detail.endCell.col=i.col},CLEAR_DETAIL:function(e){e.detail.beginCell.row=void 0,e.detail.beginCell.col=void 0,e.detail.endCell.row=void 0,e.detail.endCell.col=void 0}},se={selectCol:function(e,t){var o=e.state,i=(e.dispatch,e.commit);i("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:1,col:t}),i("SET_CACHE_SELECT_END_SELECT_CELL",{row:o.rowNum,col:t}),i("SET_CELLS_SELECTED")},selectRow:function(e,t){var o=e.state,i=(e.dispatch,e.commit);i("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:t,col:1}),i("SET_CACHE_SELECT_END_SELECT_CELL",{row:t,col:o.colNum}),i("SET_CELLS_SELECTED")},selectTable:function(e){var t=e.state,o=(e.dispatch,e.commit);o("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:1,col:1}),o("SET_CACHE_SELECT_END_SELECT_CELL",{row:t.rowNum,col:t.colNum})},beginSelectCell:function(e,t){var o=e.state,i=(e.dispatch,e.commit),l=(t.event,t.row),r=t.col;console.log("beginSelectCell"),console.time("beginSelectCell"),""!==o.cache.type&&"edit-cell"!==o.cache.type||(i("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:l,col:r}),i("SET_CACHE_SELECT_END_SELECT_CELL",{row:l,col:r}),i("SET_CELLS_SELECTED"),i("SET_CACHE_TYPE","select"),console.timeEnd("beginSelectCell"))},endSelectCell:function(e,t){e.state,e.dispatch;var o=e.commit;t.event,t.row,t.col;console.log("endSelectCell"),o("SET_CACHE_TYPE","")},mergeSelectedCells:function(e){e.state,e.dispatch,e.commit},doDragSelect:function(e,t){for(var o=e.state,i=e.dispatch,l=e.commit,r=t.event,n=(t.row,t.col,t.stateStr),a=void 0,c=void 0,s=1;s<=o.rowNum;s++)for(var d=1;d<=o.colNum;d++){var u=o.cells[s][d];if(u&&u.row_end&&u.col_end){for(var f=!1,h=s;h<=s+u.rowspan-1;h++)for(var b=d;b<=d+u.colspan-1;b++)if(h>=o.cache.select.selectedArea.begin.row&&h<=o.cache.select.selectedArea.end.row&&b>=o.cache.select.selectedArea.begin.col&&b<=o.cache.select.selectedArea.end.col){f=!0;break}f&&(a=s,c=d,l("SET_CACHE_SELECT_SELECTED_AREA",{row:s,col:d}),l("SET_CACHE_SELECT_SELECTED_AREA",{row:u.row_end,col:u.col_end}))}}l("SET_CELLS_SELECTED");var m=JSON.stringify({begin:{row:o.cache.select.selectedArea.begin.row,col:o.cache.select.selectedArea.begin.col},end:{row:o.cache.select.selectedArea.end.row,col:o.cache.select.selectedArea.end.col}});return m===n?n:i("doDragSelect",{event:r,row:a,col:c,stateStr:m})},dragSelect:function(e,t){var o=e.state,i=e.dispatch,l=e.commit,r=t.event,n=t.row,a=t.col;t.stateStr;console.log("dragSelect"),"select"===o.cache.type&&(l("SET_CACHE_SELECT_END_SELECT_CELL",{row:n,col:a}),i("doDragSelect",{event:r,row:n,col:a,stateStr:null}))},exitSelectMode:function(e){e.state;(0,e.commit)("SET_CACHE_TYPE","")},mergeCells:function(e,t){var o=e.state,i=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col){i("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row,col:o.cache.select.selectedArea.begin.col,properties:{rowspan:o.cache.select.selectedArea.end.row-o.cache.select.selectedArea.begin.row+1,colspan:o.cache.select.selectedArea.end.col-o.cache.select.selectedArea.begin.col+1,row_end:o.cache.select.selectedArea.begin.row+o.cache.select.selectedArea.end.row-o.cache.select.selectedArea.begin.row,col_end:o.cache.select.selectedArea.begin.col+o.cache.select.selectedArea.end.col-o.cache.select.selectedArea.begin.col,selected:!0,selected_is_top:!0,selected_is_bottom:!0,selected_is_left:!0,selected_is_right:!0}});for(var l=o.cache.select.selectedArea.begin.row;l<=o.cache.select.selectedArea.end.row;l++)for(var r=o.cache.select.selectedArea.begin.col;r<=o.cache.select.selectedArea.end.col;r++)l===o.cache.select.selectedArea.begin.row&&r===o.cache.select.selectedArea.begin.col||i("SET_CELL_PROPERTIES",{row:l,col:r,properties:{hidden:!0,content:void 0,row_parent:o.cache.select.selectedArea.begin.row,col_parent:o.cache.select.selectedArea.begin.col,rowspan:1,colspan:1}})}i("PUSH_BACKLIST")},splitCells:function(e){var t=e.state,o=e.commit;if(t.cache.select.selectedArea.begin.row&&t.cache.select.selectedArea.begin.col&&t.cache.select.selectedArea.end.row&&t.cache.select.selectedArea.end.col){var i=t.cache.select.selectedArea.begin.row,l=t.cache.select.selectedArea.begin.col;o("SET_CACHE_SELECT_SELECTED_AREA",{row:i+(t.cells[i][l].rowspan||1)-1,col:l+(t.cells[i][l].colspan||1)-1}),o("REMOVE_CELL_PROPERTIES",{row:i,col:l,key:"rowspan"}),o("REMOVE_CELL_PROPERTIES",{row:i,col:l,key:"colspan"}),o("REMOVE_CELL_PROPERTIES",{row:i,col:l,key:"row_end"}),o("REMOVE_CELL_PROPERTIES",{row:i,col:l,key:"col_end"}),o("SET_CELL_PROPERTIES",{row:i,col:l,properties:{selected:!0,selected_is_top:!0,selected_is_bottom:!1,selected_is_left:!0,selected_is_right:!1}});for(var r=t.cache.select.selectedArea.begin.row;r<=t.cache.select.selectedArea.end.row;r++)for(var n=t.cache.select.selectedArea.begin.col;n<=t.cache.select.selectedArea.end.col;n++)r===t.cache.select.selectedArea.begin.row&&n===t.cache.select.selectedArea.begin.col||(o("INIT_CELL_PROPERTIES",{row:r,col:n}),o("SET_CELL_PROPERTIES",{row:r,col:n,properties:{selected:!0,selected_is_top:r===t.cache.select.selectedArea.begin.row,selected_is_bottom:r===t.cache.select.selectedArea.end.row,selected_is_left:n===t.cache.select.selectedArea.begin.col,selected_is_right:n===t.cache.select.selectedArea.end.col}}))}o("PUSH_BACKLIST")},setCellsTextAlign:function(e,t){var o=e.state,i=e.commit,l=t.align;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var n=o.cache.select.selectedArea.begin.col;n<=o.cache.select.selectedArea.end.col;n++)i("SET_CELL_PROPERTIES",{row:r,col:n,properties:{textAlign:l}});i("PUSH_BACKLIST")},setCellsTextValign:function(e,t){var o=e.state,i=e.commit,l=t.align;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var n=o.cache.select.selectedArea.begin.col;n<=o.cache.select.selectedArea.end.col;n++)i("SET_CELL_PROPERTIES",{row:r,col:n,properties:{verticalAlign:l}});i("PUSH_BACKLIST")},setCellsTextFontSize:function(e,t){var o=e.state,i=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var l=o.cache.select.selectedArea.begin.row;l<=o.cache.select.selectedArea.end.row;l++)for(var r=o.cache.select.selectedArea.begin.col;r<=o.cache.select.selectedArea.end.col;r++)i("SET_CELL_PROPERTIES",{row:l,col:r,properties:{fontSize:t}});i("PUSH_BACKLIST")},setCellsTextFontFamily:function(e,t){var o=e.state,i=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var l=o.cache.select.selectedArea.begin.row;l<=o.cache.select.selectedArea.end.row;l++)for(var r=o.cache.select.selectedArea.begin.col;r<=o.cache.select.selectedArea.end.col;r++)i("SET_CELL_PROPERTIES",{row:l,col:r,properties:{fontFamily:t}});i("PUSH_BACKLIST")},setCellsBackground:function(e,t){var o=e.state,i=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var l=o.cache.select.selectedArea.begin.row;l<=o.cache.select.selectedArea.end.row;l++)for(var r=o.cache.select.selectedArea.begin.col;r<=o.cache.select.selectedArea.end.col;r++)i("SET_CELL_PROPERTIES",{row:l,col:r,properties:{background:t}});i("PUSH_BACKLIST")},setCellsTextColor:function(e,t){var o=e.state,i=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var l=o.cache.select.selectedArea.begin.row;l<=o.cache.select.selectedArea.end.row;l++)for(var r=o.cache.select.selectedArea.begin.col;r<=o.cache.select.selectedArea.end.col;r++)i("SET_CELL_PROPERTIES",{row:l,col:r,properties:{color:t}});i("PUSH_BACKLIST")},beginEditCell:function(e,t){var o=e.state,i=e.commit,l=e.dispatch,r=t.row,n=t.col;if(console.log("beginEditCell"),o.config.editInCell){"edit-cell"===o.cache.type&&l("endEditCell");var a=document.querySelector("#td_"+r+"_"+n).clientHeight;i("SET_CACHE_EDITCELL_TARGETCELL",{row:r,col:n}),setTimeout(function(){document.querySelector("#editor_"+r+"_"+n).style.display="block",console.time("createeditor");var e=UE.getEditor("editor_"+r+"_"+n,Object.assign(o.config.ueditorConfig,{initialFrameHeight:a}));console.timeEnd("createeditor"),window.__EDITOR__=e,function(e,t){e.addListener("selectionchange",function(e){var o=window.__EDITOR__.queryCommandValue("fontsize");t("setEditorToolbarStatusFontsize",o);var i=window.__EDITOR__.queryCommandValue("fontfamily");t("setEditorToolbarStatusFontfamily",i)})}(e,l),i("SET_CACHE_TYPE","edit-cell"),i("SET_CELL_PROPERTIES",{row:r,col:n,properties:{contenteditable:!0}}),i("SET_CACHE_EDITCELL_TARGETCELL",{row:r,col:n}),setTimeout(function(){document.querySelector("#editor_"+r+"_"+n).classList.add("whole-size"),document.querySelector("#editor_"+r+"_"+n).style.width="100%",UE.getEditor("editor_"+r+"_"+n).focus()},0)},0)}else{var c=o.cells[r][n];if(c&&c.type)return i("SET_CACHE_EDITCONTROL",{row:r,col:n,type:c.type}),i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:c.attribute}),void i("SET_CACHE_TYPE","edit-control");i("SET_CACHE_TYPE","edit-cell"),i("SET_CELL_PROPERTIES",{row:r,col:n,properties:{contenteditable:!0}}),i("SET_CACHE_EDITCELL_TARGETCELL",{row:r,col:n}),setTimeout(function(){document.querySelector("#td_content_"+r+"_"+n).focus(),document.querySelector("#td_content_"+r+"_"+n).style.cursor="text"},0)}},endEditCell:function(e){var t=e.state,o=e.commit;if(console.log("endEditCell"),t.cache.editCell.row&&t.cache.editCell.col){var l=t.cache.editCell.row,r=t.cache.editCell.col;if(t.config.editInCell){console.log("destroying.........."),console.log(i.default),console.log(i.default.$nextTick);var n=window.__EDITOR__.getContent();window.__EDITOR__.destroy(),o("SET_CELL_PROPERTIES",{row:l,col:r,properties:{content:n,contenteditable:!1}}),o("CLEAR_CACHE_EDITCELL_TARGETCELL",{row:l,col:r}),setTimeout(function(){document.querySelector("#td_content_"+l+"_"+r).style.cursor=null,document.querySelector("#td_content_"+l+"_"+r).classList.add("nodisplay"),o("SET_CACHE_TYPE",""),document.querySelector("#editor_"+l+"_"+r).style.display="none",console.log("destroyed")},0)}else o("SET_CELL_PROPERTIES",{row:l,col:r,properties:{content:document.querySelector("#td_content_"+l+"_"+r).innerHTML,contenteditable:!1}}),o("CLEAR_CACHE_EDITCELL_TARGETCELL",{row:l,col:r}),document.querySelector("#td_content_"+l+"_"+r).style.cursor=null,o("REMOVE_CELL_PROPERTIES",{row:l,col:r,key:"contenteditable"}),o("SET_CACHE_TYPE","")}},beginResizeCol:function(e,t){var o=e.state,i=e.commit,l=t.col,r=t.beginLocation;console.log("beginResizeCol"),""===o.cache.type&&(i("SET_CACHE_TYPE","resize-col"),i("SET_CACHE_RESIZECOL_TARGETCOL",l),i("SET_CACHE_RESIZECOL_INITWIDTH",o.cols[l].width||o.config.defaultColWidth),i("SET_CACHE_RESIZECOL_BEGIN",ne({},r)))},dragResizeCol:function(e,t){var o=e.state,i=e.commit,l=t.location;console.log("dragResizeCol"),"resize-col"===o.cache.type&&(i("SET_CACHE_RESIZECOL_END",ne({},l)),i("SET_COL_WIDTH"))},endResizeCol:function(e,t){var o=e.state,i=e.commit,l=t.location;console.log("endResizeCol"),"resize-col"===o.cache.type&&(i("SET_CACHE_RESIZECOL_END",ne({},l)),i("SET_COL_WIDTH"),i("SET_CACHE_TYPE",""),i("PUSH_BACKLIST"))},beginResizeRow:function(e,t){var o=e.state,i=e.commit,l=t.row,r=t.beginLocation;console.log("beginResizeRow"),""===o.cache.type&&(i("SET_CACHE_TYPE","resize-row"),i("SET_CACHE_RESIZEROW_TARGETROW",l),i("SET_CACHE_RESIZEROW_INITHEIGHT",o.rows[l].height||o.config.defaultRowHeight),i("SET_CACHE_RESIZEROW_BEGIN",ne({},r)))},dragResizeRow:function(e,t){var o=e.state,i=e.commit,l=t.location;console.log("dragResizeRow"),"resize-row"===o.cache.type&&(i("SET_CACHE_RESIZEROW_END",ne({},l)),i("SET_ROW_HEIGHT"))},endResizeRow:function(e,t){var o=e.state,i=e.commit,l=t.location;console.log("endResizeRow"),"resize-row"===o.cache.type&&(i("SET_CACHE_RESIZEROW_END",ne({},l)),i("SET_ROW_HEIGHT"),i("SET_CACHE_TYPE",""),i("PUSH_BACKLIST"))},setCellsBorder:function(e,t){var o=e.state,i=e.commit,l=t.borderTop,r=t.borderHorizon,n=t.borderBottom,a=t.borderLeft,c=t.borderVertical,s=t.borderRight;if(console.log("setCellsBorder"),o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col){if(l.width)for(var d=o.cache.select.selectedArea.begin.col;d<=o.cache.select.selectedArea.end.col;d++)void 0!==o.cells[o.cache.select.selectedArea.begin.row][d]&&null!==o.cells[o.cache.select.selectedArea.begin.row][d]&&!0===o.cells[o.cache.select.selectedArea.begin.row][d].hidden||(i("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row,col:d,properties:{borderTopWidth:l.width,borderTopStyle:l.style,borderTopColor:l.color,borderTop:l.width+"px "+l.style+" "+l.color,border:!0}}),void 0!==o.cells[o.cache.select.selectedArea.begin.row-1][d]&&null!==o.cells[o.cache.select.selectedArea.begin.row-1][d]&&!0===o.cells[o.cache.select.selectedArea.begin.row-1][d].hidden||i("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row-1,col:d,properties:{borderBottomWidth:l.width,borderBottomStyle:l.style,borderBottomColor:l.color,borderBottom:l.width+"px "+l.style+" "+l.color,border:!0}}));if(a.width)for(var u=o.cache.select.selectedArea.begin.row;u<=o.cache.select.selectedArea.end.row;u++)void 0!==o.cells[u][o.cache.select.selectedArea.begin.col]&&null!==o.cells[u][o.cache.select.selectedArea.begin.col]&&!0===o.cells[u][o.cache.select.selectedArea.begin.col].hidden||(i("SET_CELL_PROPERTIES",{row:u,col:o.cache.select.selectedArea.begin.col,properties:{borderLeftWidth:a.width,borderLeftStyle:a.style,borderLeftColor:a.color,borderLeft:a.width+"px "+a.style+" "+a.color,border:!0}}),void 0!==o.cells[u][o.cache.select.selectedArea.begin.col-1]&&null!==o.cells[u][o.cache.select.selectedArea.begin.col-1]&&!0===o.cells[u][o.cache.select.selectedArea.begin.col-1].hidden||i("SET_CELL_PROPERTIES",{row:u,col:o.cache.select.selectedArea.begin.col-1,properties:{borderRightWidth:a.width,borderRightStyle:a.style,borderRightColor:a.color,borderRight:a.width+"px "+a.style+" "+a.color,border:!0}}));if(n.width){for(var f=o.cache.select.selectedArea.begin.col;f<=o.cache.select.selectedArea.end.col;f++)void 0!==o.cells[o.cache.select.selectedArea.end.row][f]&&null!==o.cells[o.cache.select.selectedArea.end.row][f]&&!0===o.cells[o.cache.select.selectedArea.end.row][f].hidden||(i("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.end.row,col:f,properties:{borderBottomWidth:n.width,borderBottomStyle:n.style,borderBottomColor:n.color,borderBottom:n.width+"px "+n.style+" "+n.color,border:!0}}),void 0!==o.cells[o.cache.select.selectedArea.end.row+1][f]&&null!==o.cells[o.cache.select.selectedArea.end.row+1][f]&&!0===o.cells[o.cache.select.selectedArea.end.row+1][f].hidden||i("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.end.row+1,col:f,properties:{borderTopWidth:n.width,borderTopStyle:n.style,borderTopColor:n.color,borderTop:n.width+"px "+n.style+" "+n.color,border:!0}}));for(var h=o.cache.select.selectedArea.begin.row;h<o.cache.select.selectedArea.end.row;h++)for(var b=o.cache.select.selectedArea.begin.col;b<=o.cache.select.selectedArea.end.row;b++)o.cells[h][b]&&!0!==o.cells[h][b].hidden&&h+o.cells[h][b].rowspan-1===o.cache.select.selectedArea.end.row&&(i("SET_CELL_PROPERTIES",{row:h,col:b,properties:{borderBottomWidth:n.width,borderBottomStyle:n.style,borderBottomColor:n.color,borderBottom:n.width+"px "+n.style+" "+n.color,border:!0}}),void 0!==o.cells[h+1][h]&&!0===o.cells[h+1][h].hidden||i("SET_CELL_PROPERTIES",{row:h+1,col:b,properties:{borderTopWidth:n.width,borderTopStyle:n.style,borderTopColor:n.color,borderTop:n.width+"px "+n.style+" "+n.color,border:!0}}))}if(s.width){for(var m=o.cache.select.selectedArea.begin.row;m<=o.cache.select.selectedArea.end.row;m++)void 0!==o.cells[m][o.cache.select.selectedArea.end.col]&&null!==o.cells[m][o.cache.select.selectedArea.end.col]&&!0===o.cells[m][o.cache.select.selectedArea.end.col].hidden||(i("SET_CELL_PROPERTIES",{row:m,col:o.cache.select.selectedArea.end.col,properties:{borderRightWidth:s.width,borderRightStyle:s.style,borderRightColor:s.color,borderRight:s.width+"px "+s.style+" "+s.color,border:!0}}),void 0!==o.cells[m][o.cache.select.selectedArea.end.col+1]&&null!==o.cells[m][o.cache.select.selectedArea.end.col+1]&&!0===o.cells[m][o.cache.select.selectedArea.end.col+1].hidden||i("SET_CELL_PROPERTIES",{row:m,col:o.cache.select.selectedArea.end.col+1,properties:{borderLeftWidth:s.width,borderLeftStyle:s.style,borderLeftColor:s.color,borderLeft:s.width+"px "+s.style+" "+s.color,border:!0}}));for(var _=o.cache.select.selectedArea.begin.row;_<=o.cache.select.selectedArea.end.row;_++)for(var p=o.cache.select.selectedArea.begin.col;p<o.cache.select.selectedArea.end.row;p++)o.cells[_][p]&&!0!==o.cells[_][p].hidden&&p+o.cells[_][p].colspan-1===o.cache.select.selectedArea.end.col&&(i("SET_CELL_PROPERTIES",{row:_,col:p,properties:{borderRightWidth:s.width,borderRightStyle:s.style,borderRightColor:s.color,borderRight:s.width+"px "+s.style+" "+s.color,border:!0}}),void 0!==o.cells[_][p+1]&&!0===o.cells[_][p+1].hidden||i("SET_CELL_PROPERTIES",{row:_,col:p+1,properties:{borderLeftWidth:s.width,borderLeftStyle:s.style,borderLeftColor:s.color,borderLeft:s.width+"px "+s.style+" "+s.color,border:!0}}))}if(c.width)for(var g=o.cache.select.selectedArea.begin.row;g<=o.cache.select.selectedArea.end.row;g++)for(var C=o.cache.select.selectedArea.begin.col;C<o.cache.select.selectedArea.end.col;C++)void 0!==o.cells[g][C]&&!0===o.cells[g][C].hidden||(i("SET_CELL_PROPERTIES",{row:g,col:C,properties:{borderRightWidth:c.width,borderRightStyle:c.style,borderRightColor:c.color,borderRight:c.width+"px "+c.style+" "+c.color,border:!0}}),void 0!==o.cells[g][C+1]&&!0===o.cells[g][C+1].hidden||i("SET_CELL_PROPERTIES",{row:g,col:C+1,properties:{borderLeftWidth:c.width,borderLeftStyle:c.style,borderLeftColor:c.color,borderLeft:c.width+"px "+c.style+" "+c.color,border:!0}}));if(r.width)for(var v=o.cache.select.selectedArea.begin.row;v<o.cache.select.selectedArea.end.row;v++)for(var E=o.cache.select.selectedArea.begin.col;E<=o.cache.select.selectedArea.end.col;E++)void 0!==o.cells[v][E]&&!0===o.cells[v][E].hidden||(i("SET_CELL_PROPERTIES",{row:v,col:E,properties:{borderBottomWidth:r.width,borderBottomStyle:r.style,borderBottomColor:r.color,borderBottom:r.width+"px "+r.style+" "+r.color,border:!0}}),void 0!==o.cells[v+1][E]&&!0===o.cells[v+1][E].hidden||i("SET_CELL_PROPERTIES",{row:v+1,col:E,properties:{borderTopWidth:r.width,borderTopStyle:r.style,borderTopColor:r.color,borderTop:r.width+"px "+r.style+" "+r.color,border:!0}}))}i("PUSH_BACKLIST")},showContentMenu:function(e,t){var o=e.state;e.dispatch;o.contextMenu.e=t.e,o.contextMenu.width=t.width||150;var i=function(e){var i;t.menus[e].disabled?t.menus[e].handler=function(){}:(i=t.menus[e].handler,t.menus[e].handler=function(){i(),o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1})})};for(var l in t.menus)i(l);o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1}).concat(t.menus)},hideContentMenu:function(e,t){e.commit;var o=e.state;(t.clientX<o.contextMenu.e.clientX||t.clientX>o.contextMenu.e.clientX+o.contextMenu.width-5||t.clientY<o.contextMenu.e.clientY||t.clientY>o.contextMenu.e.clientY+document.querySelector(".fe-content-menu").clientHeight-5)&&(o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1}))},insertCol:function(e){var t=e.state,o=e.commit,i=t.cache.select.selectedArea.end.col;o("INSERT_COL",i),i>=t.detail.endCell.col||(i>=t.detail.beginCell.col&&i<=t.detail.endCell.col?o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row,col:t.detail.beginCell.col},endCell:{row:t.detail.endCell.row,col:t.detail.endCell.col+1}}):i<=t.detail.beginCell.col&&o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row,col:t.detail.beginCell.col+1},endCell:{row:t.detail.endCell.row,col:t.detail.endCell.col+1}})),o("PUSH_BACKLIST")},deleteCol:function(e){var t=e.state,o=e.commit,i=t.cache.select.selectedArea.end.col;o("DELETE_COL",i),i>t.detail.endCell.col||(i>=t.detail.beginCell.col&&i<=t.detail.endCell.col?o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row,col:t.detail.beginCell.col},endCell:{row:t.detail.endCell.row,col:t.detail.endCell.col-1}}):i<t.detail.beginCell.col&&o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row,col:t.detail.beginCell.col-1},endCell:{row:t.detail.endCell.row,col:t.detail.endCell.col-1}})),o("PUSH_BACKLIST")},insertRow:function(e){var t=e.state,o=e.commit,i=t.cache.select.selectedArea.end.row;o("INSERT_ROW",i),i>t.detail.beginCell.row||i===t.detail.beginCell.row||i<t.detail.beginCell.row&&o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row+1,col:t.detail.beginCell.col},endCell:{row:t.detail.endCell.row+1,col:t.detail.endCell.col}}),o("PUSH_BACKLIST")},deleteRow:function(e){var t=e.state,o=e.commit,i=t.cache.select.selectedArea.end.row;o("DELETE_ROW",i),i>t.detail.beginCell.row||(i===t.detail.beginCell.row?o("CLEAR_DETAIL"):i<t.detail.beginCell.row&&o("RESET_DETAIL",{beginCell:{row:t.detail.beginCell.row-1,col:t.detail.beginCell.col},endCell:{row:t.detail.endCell.row-1,col:t.detail.endCell.col}})),o("PUSH_BACKLIST")},beginUEdit:function(e){var t=e.state,o=e.commit;o("SET_CACHE_TYPE","edit");var i=t.cache.select.beginCell.row,l=t.cache.select.beginCell.col;o("SET_CACHE_UEDIT",{key:"row",value:i}),o("SET_CACHE_UEDIT",{key:"col",value:l}),o("SET_CACHE_UEDIT",{key:"content",value:t.cells[i][l]?t.cells[i][l].content:""})},cancelUEdit:function(e){e.state;var t=e.commit;t("SET_CACHE_TYPE",""),t("SET_CACHE_UEDIT",{key:"row",value:void 0}),t("SET_CACHE_UEDIT",{key:"col",value:void 0}),t("SET_CACHE_UEDIT",{key:"content",value:""})},endUEdit:function(e,t){var o=e.state,i=e.commit,l=e.history,r=t.source;console.log("endUEdit"),console.log(l),i("SET_CELL_PROPERTIES",{row:o.cache.uedit.row,col:o.cache.uedit.col,properties:{content:r}}),i("SET_CACHE_TYPE",""),i("PUSH_BACKLIST")},doClearCellsContent:function(e){for(var t=e.state,o=e.commit,i=t.cache.select.selectedArea.begin.row;i<=t.cache.select.selectedArea.end.row;i++)for(var l=t.cache.select.selectedArea.begin.col;l<=t.cache.select.selectedArea.end.col;l++)o("SET_CELL_PROPERTIES",{row:i,col:l,properties:{content:"",type:""}}),o("REMOVE_CELL_CONTROL_ATTRIBUTE",{row:i,col:l});o("PUSH_BACKLIST")},recordInitState:function(e){e.state;var t=e.commit;Object(A.d)(re.b,"[]"),Object(A.d)(re.a,-1),t("PUSH_BACKLIST")},doUndo:function(e){var t=e.state,o=e.commit;t.backList.length<=0||setTimeout(function(){o("SET_CACHE_TYPE","undo"),o("UNDO"),o("SET_CACHE_TYPE","")},0)},doRedo:function(e){var t=e.state,o=e.commit;t.nextList.length<=0||setTimeout(function(){o("SET_CACHE_TYPE","redo"),o("REDO"),o("SET_CACHE_TYPE","")},0)},setCacheType:function(e,t){e.state;(0,e.commit)("SET_CACHE_TYPE",t)},copyCell:function(e){var t=e.state,o=e.commit,i=t.cache.select.beginCell.row,l=t.cache.select.beginCell.col;o("SET_CACHE_COPY",{row:i,col:l,cell:t.cells[i][l]})},setEditorToolbarStatusFontsize:function(e,t){e.state;(0,e.commit)("SET_EDITOR_TOOLBAR_STATUS",{fontsize:t})},setEditorToolbarStatusFontfamily:function(e,t){e.state;(0,e.commit)("SET_EDITOR_TOOLBAR_STATUS",{fontfamily:t})},setBold:function(e){e.state;var t=e.commit;t("SET_CELLS_BOLD"),t("PUSH_BACKLIST")},setTextDecoration:function(e){e.state;var t=e.commit;t("SET_CELLS_TEXT_DECORATION"),t("PUSH_BACKLIST")},setItalic:function(e){e.state;var t=e.commit;t("SET_CELLS_ITALIC"),t("PUSH_BACKLIST")},addControl:function(e,t){var o=e.state,i=e.commit,l=t.type,r=t.attribute;console.log("addControl");var n=o.cache.select.beginCell.row,a=o.cache.select.beginCell.col;i("SET_CELL_PROPERTIES",{row:n,col:a,properties:{content:"",type:l}}),r.itemid=G(r.name||""),i("SET_CELL_CONTROL_ATTRIBUTE",{row:n,col:a,attribute:r}),i("PUSH_BACKLIST")},beginAddControl:function(e,t){var o=e.state,i=e.commit,l=t.type,r=o.cache.select.beginCell.row,n=o.cache.select.beginCell.col;console.log(l),i("SET_CACHE_EDITCONTROL",{row:r,col:n,type:l}),"input"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:""}}):"textarea"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",height:""}}):"date"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",format:""}}):"select"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",options:[]}}):"checkbox"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",horizon:!0,options:[]}}):"radio"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",horizon:!0,options:[]}}):"numeric"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",precision:"",numericItem:"",expressionItem:[],relateItems:[],displayItems:[]}}):"sequence"===l?i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:""}}):"refer"===l&&i("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",referCode:"",maps:[]}})},cancelAddControl:function(e,t){e.state;var o=e.commit;t?o("CLEAR_CACHE_EDITCONTROL_ATTRIBUTE"):(o("SET_CACHE_TYPE",""),o("CLEAR_CACHE_EDITCONTROL"),o("CLEAR_CACHE_EDITCONTROL_ATTRIBUTE"))},save:function(e,t){var o=e.state,i=(e.commit,t.name),r=t.formType,n=t.remark;if(console.log("save"),!(o.area.beginCell.row&&o.area.beginCell.col&&o.area.endCell.row&&o.area.endCell.col))return j.Message.warning("请设置工作区域"),!1;if(void 0!==o.detail.beginCell.row&&(o.detail.beginCell.col!==o.area.beginCell.col||o.detail.endCell.col!==o.area.endCell.col))return j.Message.warning("明细控件宽度应与工作区域等宽"),!1;var c=[],s=!1;for(var d in o.cells)for(var u in o.cells[d]){var f=o.cells[d][u];if(f&&(!f.hidden&&f.type)){var h=Object(A.c)(d,u,o.detail);c.push({itemId:f.attribute.itemid,itemName:f.attribute.name,type:f.type,json:f.attribute,isDetail:h?"1":"0"}),h&&(s=!0)}}s&&c.push({itemId:G("detail"),itemName:"detail",type:"detail",json:o.detail,isDetail:"1",remark:"明细"});var b={cells:o.cells,cols:o.cols,rows:o.rows,rowNum:o.rowNum,colNum:o.colNum,area:o.area,detail:o.detail},m=o.form.id,_="0";o.detail.beginCell.row&&o.detail.beginCell.col&&o.detail.endCell.row&&o.detail.endCell.col&&(_="1");var p=j.Loading.service({fullscreen:!0,text:"提交中..."});l.a.post("../api/field/form/save",{id:m,formKey:a,isDetail:_,name:i,formType:r,remark:n,json:b,items:c}).then(function(e){p.close(),e.data.flag&&j.MessageBox.alert("保存成功","提示",{confirmButtonText:"确定",callback:function(){var t=e.data.id;window.name=le.a.get("token")+"|"+le.a.get("refreshToken")+"||"+t,window.location.href=window.location.href}})}).catch(function(e){console.log(e)})},setForm:function(e,t){e.state;(0,e.commit)("SET_FORM",t)},setArea:function(e){e.state;var t=e.commit;t("SET_AREA"),t("PUSH_BACKLIST")},setDetail:function(e){e.state;var t=e.commit;t("SET_DETAIL"),t("PUSH_BACKLIST")},clearDetail:function(e){e.state;var t=e.commit;t("CLEAR_DETAIL"),t("PUSH_BACKLIST")}},de=new v.a.Store({state:ae,actions:se,mutations:ce,strict:!1});o("tvR6");i.default.use(q.a),i.default.config.productionTip=!1,new i.default({el:"#app",store:de,template:"<Editor/>",components:{Editor:K}})},TnnG:function(e,t){},ZUP7:function(e,t){},ZkdS:function(e,t){},ZoQJ:function(e,t,o){"use strict";o.d(t,"b",function(){return i}),o.d(t,"e",function(){return l}),o.d(t,"a",function(){return r}),o.d(t,"d",function(){return n}),o.d(t,"c",function(){return a});document.documentElement.contains;var i=function(e,t){for(var o in e.path){if(e.path[o]===document.querySelector("body"))return!1;if(e.path[o].hasAttribute(t))return e.path[o]}return!1},l=function(e){return e-0},r=function(e){return localStorage.getItem(e)},n=function(e,t){return localStorage.setItem(e,t)},a=function(e,t,o){return console.log(e,t,o),e&&t&&o?o.beginCell&&o.endCell?o.beginCell.row&&o.beginCell.col?o.endCell.row&&o.endCell.col?(console.log(e>=o.beginCell.row&&e<=o.endCell.row&&t>=o.beginCell.col&&t<=o.endCell.col),e>=o.beginCell.row&&e<=o.endCell.row&&t>=o.beginCell.col&&t<=o.endCell.col):(console.log(444),!1):(console.log(333),!1):(console.log(222),!1):(console.log(111),!1)}},cDxm:function(e,t){},kD8Z:function(e,t,o){"use strict";o.d(t,"b",function(){return i}),o.d(t,"a",function(){return l});var i="FormEditorStateList",l="FormEditorStateIndex"},peKb:function(e,t){},q4eC:function(e,t){},t8Qy:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.38d351fa5d467c77818c.js.map