webpackJsonp([1],{"2op3":function(e,t){},"9YMo":function(e,t){},EwKG:function(e,t){},HJGo:function(e,t){},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=o("7+uW"),r={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"fe-all-selector-box",style:{height:this.defaultRowHeight+0+"px"}})},staticRenderFns:[]};var i=o("VU/8")({name:"AllSelector",computed:{cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},defaultColWidth:function(){return this.$store.state.config.defaultColWidth}}},r,!1,function(e){o("cDxm")},"data-v-1f7a53ba",null).exports,c={name:"ColSelector",computed:{cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},defaultColWidth:function(){return this.$store.state.config.defaultColWidth}},methods:{displayHeadCharactor:function(e){var t=parseInt((e-1)/26),o=(e-1)%26;return(0===t?"":"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(t-1,t))+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(o,o+1)}}},n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-col-selector",style:{height:e.defaultRowHeight+"px"}},[o("table",{staticClass:"fe-col-selector-table",style:{width:e.defaultColWidth*e.colNum+"px"},attrs:{cellpadding:"0",cellspacing:"0"}},[o("tr",e._l(e.colNum,function(t){return o("td",{key:t,staticClass:"fe-col-selector-table-td"},[e._v(e._s(e.displayHeadCharactor(t)))])}))])])},staticRenderFns:[]};var s=o("VU/8")(c,n,!1,function(e){o("HJGo")},"data-v-8166a566",null).exports,a={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-row-selector"},[o("table",{staticClass:"fe-row-selector-table",attrs:{cellpadding:"0",cellspacing:"0"}},e._l(e.rowNum,function(t){return o("tr",{key:t},[o("td",{staticClass:"fe-row-selector-table-td",style:{height:e.defaultRowHeight-1+"px"}},[e._v(e._s(t))])])}))])},staticRenderFns:[]};var d=o("VU/8")({name:"RowSelector",computed:{rows:function(){return this.$store.state.rows},rowNum:function(){return this.$store.state.rowNum},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight}}},a,!1,function(e){o("q4eC")},"data-v-642ed4c8",null).exports,u=o("NYxO"),h=o("zL8q"),f=o.n(h),b=(document.documentElement.contains,function(e,t){for(var o in e.path){if(e.path[o]===document.querySelector("body"))return!1;if(e.path[o].hasAttribute(t))return e.path[o]}return!1}),p=function(e){return e-0},C=function(e){return localStorage.getItem(e)},g=function(e,t){return localStorage.setItem(e,t)},_=o("gQ/s"),m=o.n(_),E=(o("peKb"),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e}),v={name:"Toolbar",components:{Swatches:m.a},computed:{type:function(){return this.$store.state.cache.type},editControl:function(){return this.$store.state.cache.editControl},fontFamilyItems:function(){return this.$store.state.toolbarConfig.fontFamilyItems},fontSizeItems:function(){return this.$store.state.toolbarConfig.fontSizeItems},predefinedColors:function(){return this.$store.state.config.predefinedColors},backList:function(){return this.$store.state.backList},nextList:function(){return this.$store.state.nextList},isUndoEnable:function(){return this.$store.state.stateIndex>0},isRedoEnable:function(){var e=JSON.parse(C("FormEditorStateList")||"[]"),t=this.$store.state.stateIndex;return console.log("---",t,e),t<e.length-1&&t>=0},fontsize:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].fontSize:""},fontfamily:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].fontFamily:""},backgroundColor:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].background:""},textColor:function(){var e=this.$store.state.cache.select.beginCell.row,t=this.$store.state.cache.select.beginCell.col;return e&&t&&this.$store.state.cells[e][t]?this.$store.state.cells[e][t].color:""}},data:function(){return{tempColor:"",borderPropertyDialog:!1,borderPropertyStyleOptions:[{value:"none",label:"无"},{value:"solid",label:"实线"},{value:"dotted",label:"短虚线"},{value:"dashed",label:"长虚线"}],borderStyle:"",borderColor:"",borderWidth:"1",borderTop:{style:void 0,width:void 0,color:void 0},borderHorizon:{style:void 0,width:void 0,color:void 0},borderBottom:{style:void 0,width:void 0,color:void 0},borderLeft:{style:void 0,width:void 0,color:void 0},borderVertical:{style:void 0,width:void 0,color:void 0},borderRight:{style:void 0,width:void 0,color:void 0},borderPosition:{top:void 0,horizon:void 0,bottom:void 0,left:void 0,vertical:void 0,right:void 0},controlDialog:{dialogWidth:"300px",dialogWidth2:"500px",inputDialog:!1,inputAttribute:{name:"",width:""},inputRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}]},textareaDialog:!1,textareaAttribute:{name:"",width:"",height:""},textareaRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}],height:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}]},dateDialog:!1,dateAttribute:{name:"",width:""},dateRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},selectDialog:!1,selectAttribute:{name:"",width:"",options:[]},selectRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},checkboxDialog:!1,checkboxAttribute:{name:"",horizon:!0,options:[]},checkboxRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]},radioDialog:!1,radioAttribute:{name:"",horizon:!0,options:[]},radioRules:{name:[{required:!0,message:"请输入控件名称",trigger:"blur"}],width:[{type:"number",min:0,max:999,message:"请输入0-999之间的数字"}],format:[{required:!0,message:"请选择格式",trigger:"blur"}]}}}},methods:E({setBorderNone:function(){this.borderPosition.top=!1,this.borderPosition.bottom=!1,this.borderPosition.left=!1,this.borderPosition.right=!1,this.borderPosition.horizon=!1,this.borderPosition.vertical=!1,this.borderTop.style="",this.borderTop.width="",this.borderTop.color="",this.borderHorizon.style="",this.borderHorizon.width="",this.borderHorizon.color="",this.borderBottom.style="",this.borderBottom.width="",this.borderBottom.color="",this.borderLeft.style="",this.borderLeft.width="",this.borderLeft.color="",this.borderVertical.style="",this.borderVertical.width="",this.borderVertical.color="",this.borderRight.style="",this.borderRight.width="",this.borderRight.color=""},setBorderOuter:function(){this.borderPosition.top=!0,this.borderPosition.bottom=!0,this.borderPosition.left=!0,this.borderPosition.right=!0,this.borderTop.style=this.borderStyle,this.borderTop.width="1",this.borderTop.color=this.borderColor,this.borderBottom.style=this.borderStyle,this.borderBottom.width="1",this.borderBottom.color=this.borderColor,this.borderLeft.style=this.borderStyle,this.borderLeft.width="1",this.borderLeft.color=this.borderColor,this.borderRight.style=this.borderStyle,this.borderRight.width="1",this.borderRight.color=this.borderColor},setBorderInner:function(){this.borderPosition.horizon=!0,this.borderPosition.vertical=!0,this.borderHorizon.style=this.borderStyle,this.borderHorizon.width="1",this.borderHorizon.color=this.borderColor,this.borderVertical.style=this.borderStyle,this.borderVertical.width="1",this.borderVertical.color=this.borderColor},setBorderLeft:function(){this.borderPosition.left?(this.borderLeft.color="",this.borderLeft.style="",this.borderLeft.width="",this.borderPosition.left=!1):(this.borderLeft.color=this.borderColor,this.borderLeft.style=this.borderStyle,this.borderLeft.width="1",this.borderPosition.left=!0)},setBorderVertical:function(){this.borderPosition.vertical?(this.borderVertical.color="",this.borderVertical.style="",this.borderVertical.width="",this.borderPosition.vertical=!1):(this.borderVertical.color=this.borderColor,this.borderVertical.style=this.borderStyle,this.borderVertical.width="1",this.borderPosition.vertical=!0)},setBorderRight:function(){this.borderPosition.right?(this.borderRight.color="",this.borderRight.style="",this.borderRight.width="",this.borderPosition.right=!1):(this.borderRight.color=this.borderColor,this.borderRight.style=this.borderStyle,this.borderRight.width="1",this.borderPosition.right=!0)},setBorderTop:function(){this.borderPosition.top?(this.borderTop.color="",this.borderTop.style="",this.borderTop.width="",this.borderPosition.top=!1):(this.borderTop.color=this.borderColor,this.borderTop.style=this.borderStyle,this.borderTop.width="1",this.borderPosition.top=!0)},setBorderHorizon:function(){this.borderPosition.horizon?(this.borderHorizon.color="",this.borderHorizon.style="",this.borderHorizon.width="",this.borderPosition.horizon=!1):(this.borderHorizon.color=this.borderColor,this.borderHorizon.style=this.borderStyle,this.borderHorizon.width="1",this.borderPosition.horizon=!0)},setBorderBottom:function(){this.borderPosition.bottom?(this.borderBottom.color="",this.borderBottom.style="",this.borderBottom.width="",this.borderPosition.bottom=!1):(this.borderBottom.color=this.borderColor,this.borderBottom.style=this.borderStyle,this.borderBottom.width="1",this.borderPosition.bottom=!0)},setBorder:function(){},showBorderPropertyDialog:function(){this.borderStyle="solid",this.borderColor="#000000",this.borderPropertyDialog=!0},clearCellsContent:function(){var e=this;h.MessageBox.confirm("是否要清除选中的内容","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.doClearCellsContent(),h.Message.success({type:"success",message:"清除成功"})}).catch(function(){h.Message.info({type:"info",message:"已取消"})})},undo:function(){var e=JSON.parse(C("FormEditorStateList")||"[]");if(!(e<=1)){this.$emit("loading");var t=this.$store.state.stateIndex,o=e[t-=1];o.stateIndex=t,this.$store.replaceState(Object.assign({},this.$store.state,o)),g("FormEditorStateIndex",t),this.$emit("loading")}},redo:function(){var e=JSON.parse(C("FormEditorStateList")||"[]"),t=this.$store.state.stateIndex;if(!(t>=e.length-1)){this.$emit("loading");var o=e[t+=1];o.stateIndex=t,this.$store.replaceState(Object.assign({},this.$store.state,o)),g("FormEditorStateIndex",t),this.$emit("loading")}},addInputSave:function(){var e=this;this.$refs.inputForm.validate(function(t){if(t){var o=e.controlDialog.inputAttribute;e.addControl({type:"input",attribute:o}),e.cancelAddControl()}})},addTextareaSave:function(){var e=this;this.$refs.textareaForm.validate(function(t){if(t){var o=e.controlDialog.textareaAttribute;e.addControl({type:"textarea",attribute:o}),e.cancelAddControl()}})},addDateSave:function(){var e=this;this.$refs.dateForm.validate(function(t){if(t){var o=e.controlDialog.dateAttribute;e.addControl({type:"date",attribute:o}),e.cancelAddControl()}})},addSelectSave:function(){var e=this;this.$refs.selectForm.validate(function(t){if(t){var o=e.controlDialog.selectAttribute;e.addControl({type:"select",attribute:o}),e.cancelAddControl()}})},addCheckboxSave:function(){var e=this;this.$refs.checkboxForm.validate(function(t){if(t){var o=e.controlDialog.checkboxAttribute;e.addControl({type:"checkbox",attribute:o}),e.cancelAddControl()}})},addRadioSave:function(){var e=this;this.$refs.radioForm.validate(function(t){if(t){var o=e.controlDialog.radioAttribute;e.addControl({type:"radio",attribute:o}),e.cancelAddControl()}})},addControlConfirm:function(e){var t=this,o=this.$store.state.cache.select.beginCell.row,l=this.$store.state.cache.select.beginCell.col,r=this.$store.state.cache.select.endCell.row,i=this.$store.state.cache.select.endCell.col;o===r&&l===i||(this.beginSelectCell({row:o,col:l}),this.endSelectCell({row:o,col:l}));var c=this.$store.state.cache.select.beginCell.row,n=this.$store.state.cache.select.beginCell.col,s=this.$store.state.cells;s[c][n]&&s[c][n].content&&"<br>"!==s[c][n].content?(console.log("content not empty"),this.$confirm("单元格已存在内容，是否进行覆盖？","提醒",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){t.beginAddControl({type:e})}).catch(function(){})):this.beginAddControl({type:e})},closeDialog:function(){this.cancelAddControl()},setDialogForm:function(){console.log("setDialogForm"),"input"===this.editControl.type?(this.controlDialog.inputAttribute.name=this.editControl.attribute.name,this.controlDialog.inputAttribute.width=this.editControl.attribute.width):"textarea"===this.editControl.type?(this.controlDialog.textareaAttribute.name=this.editControl.attribute.name,this.controlDialog.textareaAttribute.width=this.editControl.attribute.width,this.controlDialog.textareaAttribute.height=this.editControl.attribute.height):"date"===this.editControl.type?(this.controlDialog.dateAttribute.name=this.editControl.attribute.name,this.controlDialog.dateAttribute.width=this.editControl.attribute.width,this.controlDialog.dateAttribute.format=this.editControl.attribute.format):"select"===this.editControl.type?(this.controlDialog.selectAttribute.name=this.editControl.attribute.name,this.controlDialog.selectAttribute.width=this.editControl.attribute.width,this.controlDialog.selectAttribute.options=this.editControl.attribute.options):"checkbox"===this.editControl.type?(this.controlDialog.checkboxAttribute.name=this.editControl.attribute.name,this.controlDialog.checkboxAttribute.width=this.editControl.attribute.width,this.controlDialog.checkboxAttribute.options=this.editControl.attribute.options):"radio"===this.editControl.type&&(this.controlDialog.radioAttribute.name=this.editControl.attribute.name,this.controlDialog.radioAttribute.width=this.editControl.attribute.width,this.controlDialog.radioAttribute.options=this.editControl.attribute.options)}},Object(u.b)(["beginSelectCell","endSelectCell","mergeSelectedCells","mergeCells","splitCells","setCellsTextAlign","setCellsBackground","setCellsTextColor","setCellsBorder","beginUEdit","doClearCellsContent","doUndo","doRedo","copyCell","setBold","setTextDecoration","setItalic","setCellsTextFontSize","setCellsTextFontFamily","addControl","beginAddControl","cancelAddControl"])),mounted:function(){console.log("toolbar")}},w={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-toolbar-buttons"},[o("el-dialog",{attrs:{visible:e.borderPropertyDialog,width:"550px","custom-class":""},on:{"update:visible":function(t){e.borderPropertyDialog=t}}},[o("div",{staticClass:"fe-toolbar-buttons-border-property-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      边框属性\n    ")]),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset",staticStyle:{float:"left",width:"200px"}},[o("legend",[e._v("线条")]),e._v(" "),o("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:e.borderStyle,callback:function(t){e.borderStyle=t},expression:"borderStyle"}},e._l(e.borderPropertyStyleOptions,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset"},[o("legend",[e._v("预置")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderNone}},[o("i",{staticClass:"iconfont fe-iconfont-border-none"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("无边框")])])]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderOuter}},[o("i",{staticClass:"iconfont fe-iconfont-border-outer"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("外边框")])])]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderInner}},[o("i",{staticClass:"iconfont fe-iconfont-border-inner"},[o("span",{staticClass:"fe-toolbar-buttons-border-property-dialog-font-mini"},[e._v("内边框")])])])],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset",staticStyle:{float:"left",width:"200px"}},[o("legend",[e._v("颜色")]),e._v(" "),o("el-color-picker",{attrs:{predefine:e.predefinedColors,size:"small"},model:{value:e.borderColor,callback:function(t){e.borderColor=t},expression:"borderColor"}})],1),e._v(" "),o("fieldset",{staticClass:"fe-toolbar-buttons-border-property-dialog-fieldset"},[o("legend",[e._v("自定义")]),e._v(" "),o("table",{staticClass:"fe-toolbar-buttons-border-property-dialog-table-border-buttons"},[o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderTop}},[o("i",{staticClass:"iconfont fe-iconfont-border-top"})])],1),e._v(" "),o("td",{attrs:{colspan:"3",rowspan:"3"}},[o("table",{staticClass:"fe-toolbar-preview",class:{},style:{borderTopColor:e.borderTop.color,borderBottomColor:e.borderBottom.color,borderLeftColor:e.borderLeft.color,borderRightColor:e.borderRight.color,borderTopStyle:e.borderTop.style,borderBottomStyle:e.borderBottom.style,borderLeftStyle:e.borderLeft.style,borderRightStyle:e.borderRight.style,borderTopWidth:e.borderTop.width,borderBottomWidth:e.borderBottom.width,borderLeftWidth:e.borderLeft.width,borderRightWidth:e.borderRight.width},attrs:{cellspacing:"0",cellpadding:"0"}},[o("tr",[o("td",{style:{borderRightColor:e.borderVertical.color,borderBottomColor:e.borderHorizon.color,borderRightStyle:e.borderVertical.style,borderBottomStyle:e.borderHorizon.style,borderRightWidth:e.borderVertical.width,borderBottomWidth:e.borderHorizon.width}}),e._v(" "),o("td",{style:{borderBottomColor:e.borderHorizon.color,borderBottomStyle:e.borderHorizon.style,borderBottomWidth:e.borderHorizon.width}})]),e._v(" "),o("tr",[o("td",{style:{borderRightColor:e.borderVertical.color,borderRightStyle:e.borderVertical.style,borderRightWidth:e.borderVertical.width}}),e._v(" "),o("td")])])])]),e._v(" "),o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderHorizon}},[o("i",{staticClass:"iconfont fe-iconfont-border-horizontal"})])],1)]),e._v(" "),o("tr",[o("td",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderBottom}},[o("i",{staticClass:"iconfont fe-iconfont-borderbottom"})])],1)]),e._v(" "),o("tr",[o("td"),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"left"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderLeft}},[o("i",{staticClass:"iconfont fe-iconfont-borderleft"})])],1),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"center"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderVertical}},[o("i",{staticClass:"iconfont fe-iconfont-border-vertical"})])],1),e._v(" "),o("td",{staticStyle:{width:"50px","text-align":"right"}},[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.setBorderRight}},[o("i",{staticClass:"iconfont fe-iconfont-border-right"})])],1)])]),e._v(" "),o("br")]),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:function(t){e.borderPropertyDialog=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.setCellsBorder({borderTop:e.borderTop,borderHorizon:e.borderHorizon,borderBottom:e.borderBottom,borderLeft:e.borderLeft,borderVertical:e.borderVertical,borderRight:e.borderRight}),e.borderPropertyDialog=!1}}},[e._v("确 定")])],1)]),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.isUndoEnable,title:"撤销"},on:{click:e.undo}},[o("i",{staticClass:"iconfont fe-iconfont-undo"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.isRedoEnable,title:"重做"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-redo"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"合并单元格"},on:{click:e.mergeCells}},[o("i",{staticClass:"iconfont fe-iconfont-mergecell"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"取消合并"},on:{click:e.splitCells}},[o("i",{staticClass:"iconfont fe-iconfont-separatecell"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.showBorderPropertyDialog}},[o("i",{staticClass:"iconfont fe-iconfont-border-all"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"编辑"},on:{click:e.beginUEdit}},[o("i",{staticClass:"iconfont fe-iconfont-edit"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"清空内容"},on:{click:e.clearCellsContent}},[o("i",{staticClass:"iconfont fe-iconfont-clear"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"复制"},on:{click:e.copyCell}},[o("i",{staticClass:"iconfont fe-iconfont-copy"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"剪切"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-cut"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"粘贴"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-paste"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"取消复制、粘贴"},on:{click:e.redo}},[o("i",{staticClass:"iconfont fe-iconfont-cancel"})])],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"粗体"},on:{click:e.setBold}},[o("i",{staticClass:"iconfont fe-iconfont-bold"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"斜体"},on:{click:e.setItalic}},[o("i",{staticClass:"iconfont fe-iconfont-italic"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下划线"},on:{click:e.setTextDecoration}},[o("i",{staticClass:"iconfont fe-iconfont-underline"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"居左"},on:{click:function(t){e.setCellsTextAlign({align:"left"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignleft"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"居中"},on:{click:function(t){e.setCellsTextAlign({align:"center"})}}},[o("i",{staticClass:"iconfont fe-iconfont-aligncenter"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"居右"},on:{click:function(t){e.setCellsTextAlign({align:"right"})}}},[o("i",{staticClass:"iconfont fe-iconfont-alignright"})])],1),e._v(" "),o("el-select",{attrs:{size:"mini",value:e.fontfamily,placeholder:"字体"},on:{change:e.setCellsTextFontFamily}},e._l(e.fontFamilyItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-select",{attrs:{size:"mini",value:e.fontsize,placeholder:"字号"},on:{change:e.setCellsTextFontSize}},e._l(e.fontSizeItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-button-group",[o("swatches",{attrs:{value:e.backgroundColor,colors:"text-advanced"},on:{input:e.setCellsBackground}},[o("el-button",{attrs:{slot:"trigger",type:"primary",size:"mini",title:"背景色"},slot:"trigger"},[o("i",{staticClass:"iconfont fe-iconfont-background-color"})])],1),e._v(" "),o("swatches",{attrs:{value:e.textColor,colors:"text-advanced"},on:{input:e.setCellsTextColor}},[o("el-button",{attrs:{slot:"trigger",type:"primary",size:"mini",title:"背景色"},slot:"trigger"},[o("i",{staticClass:"iconfont fe-iconfont-text-color"})])],1)],1)],1),e._v(" "),o("div",{staticClass:"fe-toolbar-block"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"文本框"},on:{click:function(t){e.addControlConfirm("input")}}},[o("i",{staticClass:"iconfont fe-iconfont-input"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"文本域/多行文本"},on:{click:function(t){e.addControlConfirm("textarea")}}},[o("i",{staticClass:"iconfont fe-iconfont-text"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"日期控件"},on:{click:function(t){e.addControlConfirm("date")}}},[o("i",{staticClass:"iconfont fe-iconfont-date"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下拉框"},on:{click:function(t){e.addControlConfirm("select")}}},[o("i",{staticClass:"iconfont fe-iconfont-drop-down"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"多选框"},on:{click:function(t){e.addControlConfirm("checkbox")}}},[o("i",{staticClass:"iconfont fe-iconfont-checkbox"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"单选框"},on:{click:function(t){e.addControlConfirm("radio")}}},[o("i",{staticClass:"iconfont fe-iconfont-radio"})])],1)],1),e._v(" "),"input"===e.editControl.type?o("el-dialog",{attrs:{visible:"input"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'input'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      文本框属性\n    ")]),e._v(" "),o("el-form",{ref:"inputForm",attrs:{model:e.controlDialog.inputAttribute,rules:e.controlDialog.inputRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.inputAttribute.name,callback:function(t){e.$set(e.controlDialog.inputAttribute,"name",t)},expression:"controlDialog.inputAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"0表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.inputAttribute.width,callback:function(t){e.$set(e.controlDialog.inputAttribute,"width",e._n(t))},expression:"controlDialog.inputAttribute.width"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addInputSave}},[e._v("确 定")])],1)],1):"textarea"===e.editControl.type?o("el-dialog",{attrs:{visible:"textarea"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'textarea'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      文本域属性\n    ")]),e._v(" "),o("el-form",{ref:"textareaForm",attrs:{model:e.controlDialog.textareaAttribute,rules:e.controlDialog.textareaRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.textareaAttribute.name,callback:function(t){e.$set(e.controlDialog.textareaAttribute,"name",t)},expression:"controlDialog.textareaAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"0表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.textareaAttribute.width,callback:function(t){e.$set(e.controlDialog.textareaAttribute,"width",e._n(t))},expression:"controlDialog.textareaAttribute.width"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"height"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"0表示和单元格等高",autocomplete:"off"},model:{value:e.controlDialog.textareaAttribute.height,callback:function(t){e.$set(e.controlDialog.textareaAttribute,"height",e._n(t))},expression:"controlDialog.textareaAttribute.height"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addTextareaSave}},[e._v("确 定")])],1)],1):"date"===e.editControl.type?o("el-dialog",{attrs:{visible:"date"===e.editControl.type,width:e.controlDialog.dialogWidth},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'date'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      日期控件属性\n    ")]),e._v(" "),o("el-form",{ref:"dateForm",attrs:{model:e.controlDialog.dateAttribute,rules:e.controlDialog.dateRules,"label-width":"80px",size:"mini"}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.dateAttribute.name,callback:function(t){e.$set(e.controlDialog.dateAttribute,"name",t)},expression:"controlDialog.dateAttribute.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"0表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.dateAttribute.width,callback:function(t){e.$set(e.controlDialog.dateAttribute,"width",e._n(t))},expression:"controlDialog.dateAttribute.width"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"日期格式",prop:"height"}},[o("el-select",{staticStyle:{width:"100% !important"},attrs:{placeholder:"请选择日期格式"},model:{value:e.controlDialog.dateAttribute.format,callback:function(t){e.$set(e.controlDialog.dateAttribute,"format",t)},expression:"controlDialog.dateAttribute.format"}},[o("el-option",{key:"yyyy-MM-dd",attrs:{label:"yyyy-MM-dd",value:"yyyy-MM-dd"}}),e._v(" "),o("el-option",{key:"yyyy年MM月dd日",attrs:{label:"yyyy年MM月dd日",value:"yyyy年MM月dd日"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addDateSave}},[e._v("确 定")])],1)],1):"select"===e.editControl.type?o("el-dialog",{attrs:{visible:"select"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'select'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      下拉框属性\n    ")]),e._v(" "),o("el-form",{ref:"selectForm",attrs:{model:e.controlDialog.selectAttribute,rules:e.controlDialog.selectRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.selectAttribute.name,callback:function(t){e.$set(e.controlDialog.selectAttribute,"name",t)},expression:"controlDialog.selectAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件宽度",prop:"width"}},[o("el-input",{attrs:{min:0,max:999,placeholder:"0表示和单元格等宽",autocomplete:"off"},model:{value:e.controlDialog.selectAttribute.width,callback:function(t){e.$set(e.controlDialog.selectAttribute,"width",e._n(t))},expression:"controlDialog.selectAttribute.width"}})],1)],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.selectAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value",o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text",o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index-1,0,e.controlDialog.selectAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.selectAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.selectAttribute.options.splice(t.$index+1,0,e.controlDialog.selectAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.selectAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.selectAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addSelectSave}},[e._v("确 定")])],1)],1):"checkbox"===e.editControl.type?o("el-dialog",{attrs:{visible:"checkbox"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'checkbox'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      多选框属性\n    ")]),e._v(" "),o("el-form",{ref:"checkboxForm",attrs:{model:e.controlDialog.checkboxAttribute,rules:e.controlDialog.checkboxRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.checkboxAttribute.name,callback:function(t){e.$set(e.controlDialog.checkboxAttribute,"name",t)},expression:"controlDialog.checkboxAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}}),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-switch",{attrs:{"active-text":"水平布局","inactive-text":"垂直布局"},model:{value:e.controlDialog.checkboxAttribute.horizon,callback:function(t){e.$set(e.controlDialog.checkboxAttribute,"horizon",t)},expression:"controlDialog.checkboxAttribute.horizon"}})],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.checkboxAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value",o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text",o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index-1,0,e.controlDialog.checkboxAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.checkboxAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.checkboxAttribute.options.splice(t.$index+1,0,e.controlDialog.checkboxAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.checkboxAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.checkboxAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addCheckboxSave}},[e._v("确 定")])],1)],1):"radio"===e.editControl.type?o("el-dialog",{attrs:{visible:"radio"===e.editControl.type,width:e.controlDialog.dialogWidth2},on:{"update:visible":function(t){e.$set(e.editControl,"type === 'radio'",t)},opened:e.setDialogForm,close:e.closeDialog}},[o("div",{staticClass:"fe-dialog-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      多选框属性\n    ")]),e._v(" "),o("el-form",{ref:"radioForm",attrs:{model:e.controlDialog.radioAttribute,rules:e.controlDialog.radioRules,"label-width":"80px",size:"mini"}},[o("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:"控件名称",prop:"name"}},[o("el-input",{attrs:{autocomplete:"off"},model:{value:e.controlDialog.radioAttribute.name,callback:function(t){e.$set(e.controlDialog.radioAttribute,"name",t)},expression:"controlDialog.radioAttribute.name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:2}}),e._v(" "),o("el-col",{attrs:{span:10}},[o("el-switch",{attrs:{"active-text":"水平布局","inactive-text":"垂直布局"},model:{value:e.controlDialog.radioAttribute.horizon,callback:function(t){e.$set(e.controlDialog.radioAttribute,"horizon",t)},expression:"controlDialog.radioAttribute.horizon"}})],1)],1),e._v(" "),o("el-row",[o("el-col",{attrs:{span:24}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.controlDialog.radioAttribute.options,height:"280",border:""}},[o("el-table-column",{attrs:{prop:"value",label:"值",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入值"},model:{value:t.row.value,callback:function(o){e.$set(t.row,"value",o)},expression:"scope.row.value"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"label",label:"显示文本",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{attrs:{placeholder:"请输入显示文本"},model:{value:t.row.text,callback:function(o){e.$set(t.row,"text",o)},expression:"scope.row.text"}})]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-delete"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index,1)}}}),e._v(" "),0!==t.$index?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-up"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index-1,0,e.controlDialog.radioAttribute.options.splice(t.$index,1)[0])}}}):e._e(),e._v(" "),t.$index!==e.controlDialog.radioAttribute.options.length-1?o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-arrow-down"},on:{click:function(o){e.controlDialog.radioAttribute.options.splice(t.$index+1,0,e.controlDialog.radioAttribute.options.splice(t.$index,1)[0])}}}):e._e()],1)]}}])}),e._v(" "),o("div",{attrs:{slot:"empty"},slot:"empty"},[o("div",[e._v("\n                暂无数据...\n              ")]),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.radioAttribute.options.push({})}}})],1)]),e._v(" "),o("div",{staticStyle:{"text-align":"center",padding:"5px"},attrs:{slot:"append"},slot:"append"},[o("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.controlDialog.radioAttribute.options.push({})}}})],1)],1)],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"mini"},on:{click:e.closeDialog}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addRadioSave}},[e._v("确 定")])],1)],1):e._e()],1)},staticRenderFns:[]};var y=o("VU/8")(v,w,!1,function(e){o("lF5K"),o("dQCv")},"data-v-f877aa02",null).exports,T={name:"EditorToolbar",data:function(){return{}},computed:{fontFamilyItems:function(){return this.$store.state.editorToolbarStatus.fontFamilyItems},fontSizeItems:function(){return this.$store.state.editorToolbarStatus.fontSizeItems},fontsize:{get:function(){return this.$store.state.editorToolbarStatus.fontsize},set:function(e){this.setEditorToolbarStatusFontsize("newValue")}},fontfamily:{get:function(){return this.$store.state.editorToolbarStatus.fontfamily},set:function(e){this.setEditorToolbarStatusFontfamily("newValue")}}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({execEditorCommand:function(e,t){window.__EDITOR__&&window.__EDITOR__.execCommand(e,t)},select:function(){window.__EDITOR__.isFocus()||window.__EDITOR__.focus()}},Object(u.b)(["setEditorToolbarStatusFontsize","setEditorToolbarStatusFontfamily"]))},A={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-editor-toolbar-buttons"},[o("el-button-group",[o("el-button",{attrs:{type:"primary",size:"mini",title:"粗体"},on:{click:function(t){e.execEditorCommand("bold")}}},[o("i",{staticClass:"iconfont fe-iconfont-bold"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"斜体"},on:{click:function(t){e.execEditorCommand("italic")}}},[o("i",{staticClass:"iconfont fe-iconfont-italic"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"下划线"},on:{click:function(t){e.execEditorCommand("underline")}}},[o("i",{staticClass:"iconfont fe-iconfont-underline"})])],1),e._v(" "),o("el-select",{attrs:{size:"mini",placeholder:"字体"},on:{"visible-change":e.select,change:function(t){e.execEditorCommand("fontfamily",t)}},model:{value:e.fontfamily,callback:function(t){e.fontfamily=t},expression:"fontfamily"}},e._l(e.fontFamilyItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),o("el-select",{attrs:{size:"mini",placeholder:"字号"},on:{"visible-change":e.select,change:function(t){e.execEditorCommand("fontsize",t)}},model:{value:e.fontsize,callback:function(t){e.fontsize=t},expression:"fontsize"}},e._l(e.fontSizeItems,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)},staticRenderFns:[]};var S=o("VU/8")(T,A,!1,function(e){o("ZUP7")},"data-v-7ef39e1b",null).exports,L={name:"ContentTable",computed:{type:function(){return this.$store.state.cache.type},selectedColIndexList:function(){return this.$store.state.selectedColIndexList},rows:function(){return this.$store.state.rows},rowNum:function(){return this.$store.state.rowNum},cols:function(){return this.$store.state.cols},colNum:function(){return this.$store.state.colNum},defaultColWidth:function(){return this.$store.state.config.defaultColWidth},defaultRowHeight:function(){return this.$store.state.config.defaultRowHeight},begin:function(){return this.$store.state.cache.select.selectedArea.begin},end:function(){return this.$store.state.cache.select.selectedArea.end},cells:function(){return this.$store.state.cells},beginCell:function(){return this.$store.state.cache.select.beginCell},cacheEditCell:function(){return this.$store.state.cache.editCell},borderDefault:function(){return this.$store.state.config.borderDefault},borderDefaultColor:function(){return this.$store.state.config.borderDefaultColor},borderDefaultStyle:function(){return this.$store.state.config.borderDefaultStyle},borderDefaultWidth:function(){return this.$store.state.config.borderDefaultWidth},selectedBorderDefaultColor:function(){return this.$store.state.config.selectedBorderDefaultColor},selectedBorderDefaultStyle:function(){return this.$store.state.config.selectedBorderDefaultStyle},selectedBorderDefaultWidth:function(){return this.$store.state.config.selectedBorderDefaultWidth},selectedBorderDefault:function(){return this.$store.state.config.selectedBorderDefault},selectedCellBackground:function(){return this.$store.state.config.selectedCellBackground},copy:function(){return this.$store.state.cache.copy},editInCell:function(){return this.$store.state.config.editInCell},timestamp:function(){return this.$store.state.timestamp}},data:function(){return{tableOffsetTop:0,tableOffsetLeft:0,mouseoverRow:void 0,mouseoverCol:void 0,thisTimeStamp:0}},mounted:function(){this.tableOffsetTop=document.querySelector("#fe-content-table-table").offsetTop,this.tableOffsetLeft=document.querySelector("#fe-content-table-table").offsetLeft,this.$store.state.cache.select.selectedArea.begin.row||(this.beginSelectCell({row:1,col:1}),this.endSelectCell({row:1,col:1}))},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({isTdShow:function(e,t){return!this.cells[e][t]||!this.cells[e][t].hidden},showMenu:function(e){var t=this.copy.row&&this.copu.col;if(e.target.hasAttribute("col-header")){var o=[{icon:"fe-iconfont-insert-column",text:"插入列",disabled:!1,handler:this.insertCol},{icon:"fe-iconfont-delete-column",text:"删除列",disabled:!1,handler:this.deleteCol}];t&&o.splice(0,1),this.showContentMenu({e:e,width:135,menus:o})}else if(e.target.hasAttribute("row-header")){var l=[{icon:"fe-iconfont-insert-row",text:"插入行",disabled:!1,handler:this.insertRow},{icon:"fe-iconfont-delete-row",text:"删除行",disabled:!1,handler:this.deleteRow}];t&&l.splice(0,1),console.log(e),this.showContentMenu({e:e,width:135,menus:l})}},displayHeadCharactor:function(e){var t=parseInt((e-1)/26),o=(e-1)%26;return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(t-1,t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(o,o+1)},getCellBorderTop:function(e,t,o){return o&&o.selected&&o.selected_is_top?this.selectedBorderDefault:o&&o.borderTop?o.borderTop:this.borderDefault},getCellBorderLeft:function(e,t,o){return o&&o.selected&&o.selected_is_left?this.selectedBorderDefault:o&&o.borderLeft?o.borderLeft:this.borderDefault},getCellBorderBottom:function(e,t,o){return o&&o.selected&&o.selected_is_bottom?this.selectedBorderDefault:o&&o.borderBottom?o.borderBottom:this.borderDefault},getCellBorderRight:function(e,t,o){return o&&o.selected&&o.selected_is_right?this.selectedBorderDefault:o&&o.borderRight?o.borderRight:this.borderDefault},getCellStyle:function(e,t,o){return{borderTop:this.getCellBorderTop(e,t,o),borderLeft:this.getCellBorderLeft(e,t,o),borderBottom:this.getCellBorderBottom(e,t,o),borderRight:this.getCellBorderRight(e,t,o),background:this.getCellBackground(e,t,o),textAlign:this.getCellTextalign(e,t,o),fontSize:this.getCellTextFontSize(e,t,o),fontFamily:this.getCellTextFontFamily(e,t,o),color:this.getCellTextColor(e,t,o)}},isColSelected:function(e){for(var t in this.selectedColIndexList)if(this.selectedColIndexList[t]===e)return!0;return!1},getCell:function(e,t){return this.cells[e][t]?this.cells[e][t]:{}},getCellContent:function(e,t,o){return o?o.content:""},isCellContentEditable:function(e,t){return this.cacheEditCell.row===e&&this.cacheEditCell.col===t},getCellRowspan:function(e,t,o){if(o)return o.rowspan},getCellColspan:function(e,t,o){if(o)return o.colspan},getCellTextalign:function(e,t){if(this.cells[e][t])return this.cells[e][t].textAlign},getCellTextFontSize:function(e,t){if(this.cells[e][t])return this.cells[e][t].fontSize},getCellTextFontFamily:function(e,t){if(this.cells[e][t])return this.cells[e][t].fontFamily},getCellTextColor:function(e,t){if(this.cells[e][t])return this.cells[e][t].color},getCellBackground:function(e,t,o){return o&&o.background?o.background:o&&o.selected?this.selectedCellBackground:void 0},getColWidth:function(e){return this.cols[e].width},getRowHeight:function(e){return this.rows[e].height},handleMouseMove:function(e){var t=e.target.hasAttribute("col-header"),o=e.target.hasAttribute("row-header");t&&""===this.type?e.clientX-e.target.offsetLeft+this.tableOffsetLeft<=3||e.target.offsetLeft+this.tableOffsetLeft+e.target.clientWidth-e.clientX<=3?e.target.style.cursor="col-resize":e.target.style.cursor="pointer":o&&""===this.type?e.clientY-e.target.offsetTop+this.tableOffsetTop<=3||e.target.offsetTop+this.tableOffsetTop+e.target.clientHeight-e.clientY<=3?e.target.style.cursor="row-resize":e.target.style.cursor="pointer":"resize-col"===this.type?e.target.style.cursor="col-resize":"resize-row"===this.type&&(e.target.style.cursor="row-resize"),"resize-col"===this.type&&e.target.hasAttribute("col-header")?this.dragResizeCol({location:{x:e.clientX,y:e.clientY}}):"resize-row"===this.type&&e.target.hasAttribute("row-header")&&this.dragResizeRow({location:{x:e.clientX,y:e.clientY}})},handleMouseOver:function(e){var t=null,o=e.target.hasAttribute("table-content")||(t=b(e,"table-content"));if(o&&!t&&(t=e.target),o){var l=p(t.getAttribute("row")||1),r=p(t.getAttribute("col")||1);if(l===this.mouseoverRow&&r===this.mouseoverCol)return;"select"!==this.type&&"edit-cell"!==this.type||this.dragSelect({event:e,row:l,col:r})}},handleMouseDown:function(e){var t=e.target.hasAttribute("col-header"),o=e.target.hasAttribute("row-header"),l=e.target.hasAttribute("table-selector"),r=null,i=e.target.hasAttribute("table-content")||(r=b(e,"table-content"));i&&!r&&(r=e.target);var c=p(e.target.getAttribute("col")||1),n=p(e.target.getAttribute("row")||1);if(t)e.clientX-e.target.offsetLeft+this.tableOffsetLeft<=3||e.target.offsetLeft+this.tableOffsetLeft+e.target.clientWidth-e.clientX<=3?(e.target.clientWidth>=7&&e.clientX-e.target.offsetLeft<=3&&(c-=1),this.beginResizeCol({col:c,beginLocation:{x:e.clientX,y:e.clientY}})):this.selectCol(c);else if(o)e.clientY-e.target.offsetTop+this.tableOffsetTop<=3||e.target.offsetTop+this.tableOffsetTop+e.target.clientHeight-e.clientY<=3?(e.target.clientHeight>=7&&e.clientX-e.target.offsetLeft<=3&&(n-=1),this.beginResizeRow({row:n,beginLocation:{x:e.clientX,y:e.clientY}})):this.selectRow(n);else if(i){var s=p(r.getAttribute("row")||1),a=p(r.getAttribute("col")||1);this.beginSelectCell({event:e,row:s,col:a})}else l&&this.selectTable()},handleMouseUp:function(e){if("resize-col"===this.type)this.endResizeCol({location:{x:e.clientX,y:e.clientY}});else if("resize-row"===this.type)this.endResizeRow({location:{x:e.clientX,y:e.clientY}});else if("select"===this.type){var t=null,o=e.target.hasAttribute("table-content")||(t=b(e,"table-content"));o&&!t&&(t=e.target);var l=p(t.getAttribute("row")||1),r=p(t.getAttribute("col")||1);o&&this.endSelectCell({event:e,row:l,col:r})}},handleMouseLeave:function(e){console.log(e)},handleBlur:function(e){console.log(e)},handleClick:function(e){},handleMouseDblClick:function(e){var t=null,o=e.target.hasAttribute("table-content")||(t=b(e,"table-content"));if(o&&!t&&(t=e.target),o){var l=p(t.getAttribute("row")||1),r=p(t.getAttribute("col")||1);this.beginEditCell({row:l,col:r})}},handleHeadMouseLeave:function(e){"resize-col"===this.type?this.endResizeCol({location:{x:e.clientX,y:e.clientY}}):"resize-row"===this.type&&this.endResizeRow({location:{x:e.clientX,y:e.clientY}})}},Object(u.b)(["selectCol","selectRow","selectTable","beginSelectCell","endSelectCell","dragSelect","exitSelectMode","beginEditCell","endEditCell","beginResizeCol","endResizeCol","dragResizeCol","beginResizeRow","endResizeRow","dragResizeRow","showContentMenu","insertCol","deleteCol","insertRow","deleteRow"])),beforeUpdate:function(){},updated:function(){}},R={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-content-table-container",attrs:{draggable:"false",ondragstart:"javascript: return false;"}},[o("table",{staticClass:"fe-content-table-table",style:{},attrs:{id:"fe-content-table-table",cellspacing:"0",draggable:"false",ondragstart:"javascript: return false;"},on:{mousemove:function(t){e.handleMouseMove(t)},mouseover:function(t){e.handleMouseOver(t)},mousedown:function(t){e.handleMouseDown(t)},mouseup:function(t){e.handleMouseUp(t)},mouseleave:function(t){e.handleMouseLeave(t)},click:function(t){e.handleClick(t)},dblclick:function(t){e.handleMouseDblClick(t)},contextmenu:function(t){t.preventDefault(),e.showMenu(t)}}},[o("tr",{staticClass:"noselect",attrs:{draggable:"false",ondragstart:"javascript: return false;"},on:{mouseleave:e.handleHeadMouseLeave}},[o("td",{staticClass:"fe-content-table-table-th-0",style:{height:e.defaultRowHeight+"px",width:"46px",cursor:"cell"},attrs:{draggable:"false",ondragstart:"javascript: return false;","table-selector":""}}),e._v(" "),e._l(e.cells[0],function(t,l){return 0!==l?o("td",{key:"th"+l,staticClass:"fe-content-table-table-line0",style:{height:e.defaultRowHeight+"px",width:(e.getColWidth(l)||e.defaultColWidth)+"px",boxSizing:"border-box"},attrs:{col:l,draggable:"false",ondragstart:"javascript: return false;","col-header":""}},[e._v("\n          "+e._s(e.displayHeadCharactor(l))+"\n        ")]):e._e()})],2),e._v(" "),e._l(e.cells,function(t,l){return 0!==l?o("tr",{key:l,attrs:{draggable:"false",ondragstart:"javascript: return false;"}},[o("td",{staticClass:"fe-content-table-table-th-1 noselect",style:{height:(e.getRowHeight(l)||e.defaultRowHeight)+"px"},attrs:{draggable:"false",ondragstart:"javascript: return false;","row-header":"",row:l}},[e._v("\n        "+e._s(l)+"\n      ")]),e._v(" "),e._l(t,function(t,r){return 0!==r?o("td",{directives:[{name:"show",rawName:"v-show",value:e.isTdShow(l,r),expression:"isTdShow(row, col)"}],key:r+"@"+l,staticClass:"fe-content-table-table-td",class:{"fe-content-table-copy":e.copy.row===l&&e.copy.col===r,"style-bold-1":t&&t.bold,"style-text-decoration-1":t&&t.textDecoration,"style-italic-1":t&&t.italic},style:e.getCellStyle(l,r,t),attrs:{id:"td_"+l+"_"+r,draggable:"false","table-content":"",row:l,col:r,rowspan:e.getCellRowspan(l,r,t),colspan:e.getCellColspan(l,r,t)}},[t&&"input"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,placeholder:t.attribute.name,clearable:""}}):t&&"textarea"===t.type?o("el-input",{style:{width:t.attribute.width?t.attribute.width+"px":"100%",height:t.attribute.height?t.attribute.height+"px":"100%"},attrs:{size:"mini",readonly:!0,type:"textarea",row:10,resize:"none",placeholder:t.attribute.name,clearable:""}}):t&&"date"===t.type?o("el-date-picker",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,type:"date",placeholder:t.attribute.name,clearable:""}}):t&&"select"===t.type?o("el-select",{style:{width:t.attribute.width?t.attribute.width+"px":"100%"},attrs:{size:"mini",readonly:!0,placeholder:t.attribute.name}},e._l(t.attribute.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})):t&&"checkbox"===t.type?o("el-checkbox-group",{attrs:{size:"mini"}},[e._l(t.attribute.options,function(l,r){return[o("el-checkbox",{key:l.value,attrs:{label:l.text}},[e._v(e._s(l.text))]),e._v(" "),t.attribute.horizon||r===t.attribute.options.length-1?e._e():[o("br",{key:"br"+l.value})]]})],2):t&&"radio"===t.type?o("el-radio-group",{attrs:{size:"mini"}},[e._l(t.attribute.options,function(l,r){return[o("el-radio",{key:l.value,attrs:{label:l.text}},[e._v(e._s(l.text))]),e._v(" "),t.attribute.horizon||r===t.attribute.options.length-1?e._e():[o("br",{key:"br"+l.value})]]})],2):o("div",{staticClass:"fe-content-table-table-td-div",style:{userSelect:e.isCellContentEditable(l,r)?"":"none"},attrs:{contenteditable:e.isCellContentEditable(l,r),id:"td_content_"+l+"_"+r,draggable:"false"},domProps:{innerHTML:e._s(e.getCellContent(l,r,t))},on:{blur:function(t){e.endEditCell({row:l,col:r})}}})],1):e._e()})],2):e._e()})],2)])},staticRenderFns:[]};var x={name:"FormEditor",components:{Toolbar:y,EditorToolbar:S,ContentTable:o("VU/8")(L,R,!1,function(e){o("Y30a")},"data-v-04b311a8",null).exports,AllSelector:i,ColSelector:s,RowSelector:d},computed:{cacheType:function(){return this.$store.state.cache.type}},methods:{emitLoading:function(){this.$emit("loading")}}},D={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{display:"flex","flex-direction":"column"}},[t("toolbar",{on:{loading:this.emitLoading}}),this._v(" "),t("content-table")],1)},staticRenderFns:[]};var I=o("VU/8")(x,D,!1,function(e){o("2op3")},"data-v-b2db40d6",null).exports,z={name:"fe-content-menu",computed:{contextMenu:function(){return this.$store.state.contextMenu}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({},Object(u.b)(["hideContentMenu"]))},O={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.contextMenu.menuItemList.length>0?o("div",{staticClass:"fe-content-menu",style:{left:e.contextMenu.e.clientX+e.contextMenu.width/2-2+"px",top:e.contextMenu.e.clientY-2+"px",minWidth:e.contextMenu.width+"px"},on:{mouseout:function(t){e.hideContentMenu(t)}}},[o("ul",e._l(e.contextMenu.menuItemList,function(t,l){return o("li",{key:l,class:t.disabled?"fe-content-menu-disabled":"",on:{click:t.handler}},[o("i",{class:"iconfont fe-content-menu-icon "+t.icon}),e._v("   "),o("span",{staticClass:"fe-content-menu-text"},[e._v(e._s(t.text))])])}))]):e._e()},staticRenderFns:[]};var H=o("VU/8")(z,O,!1,function(e){o("ZkdS")},"data-v-91e0aaec",null).exports,k={name:"UEditorToolbar",methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({endEdit:function(){console.log("endEdit"),this.$emit("save")}},Object(u.b)(["cancelUEdit"]))},P={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fe-ueditor-toolbar-buttons"},[t("el-button-group",[t("el-button",{attrs:{type:"danger",size:"mini",title:"返回"},on:{click:this.cancelUEdit}},[t("i",{staticClass:"iconfont fe-iconfont-back"})]),this._v(" "),t("el-button",{attrs:{type:"primary",size:"mini",title:"确定"},on:{click:this.endEdit}},[t("i",{staticClass:"iconfont fe-iconfont-yes"})])],1)],1)},staticRenderFns:[]};var B=o("VU/8")(k,P,!1,function(e){o("9YMo")},"data-v-18f7cceb",null).exports,$={name:"NEditorToolbar",methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({endEdit:function(){this.$emit("save")}},Object(u.b)(["cancelUEdit"]))},N={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"fe-ueditor-toolbar-buttons"},[o("el-button-group",[o("el-button",{attrs:{size:"mini",title:"返回"},on:{click:e.cancelUEdit}},[o("i",{staticClass:"iconfont fe-iconfont-back"})]),e._v(" "),o("el-button",{attrs:{type:"primary",size:"mini",title:"确定"},on:{click:e.endEdit}},[o("i",{staticClass:"iconfont fe-iconfont-yes"})])],1),e._v(" "),o("el-button-group",[o("el-button",{attrs:{size:"mini",type:"primary",title:"普通文本框"}},[o("i",{staticClass:"iconfont "},[e._v("文本框")])]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary",title:"日期选择框"}},[o("i",{staticClass:"iconfont "},[e._v("日期控件")])]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"primary",title:"多行文本框"}},[o("i",{staticClass:"iconfont "},[e._v("多行文本")])])],1)],1)},staticRenderFns:[]};var F=o("VU/8")($,N,!1,function(e){o("EwKG")},"data-v-31d0ead8",null).exports,U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},M={name:"UEditor",components:{UEditorToolbar:B,NEditorToolbar:F},data:function(){return{editor:null}},props:{defaultMsg:{type:String},config:{type:Object},id:{type:String}},computed:{ueditContent:function(){return this.$store.state.cache.uedit.content}},mounted:function(){var e=this;this.editor=UE.getEditor(this.id,this.config),window.__EDITOR__=this.editor,this.editor.commands.cancel={execCommand:function(){e.cancelUEdit()},queryCommandState:function(){}},this.editor.commands.yes={execCommand:function(){e.saveUEContent()},queryCommandState:function(){}},this.editor.addListener("ready",function(){e.editor.setContent(e.ueditContent||"")})},methods:U({getUEContent:function(){return this.editor.getContent()},getUEContentText:function(){return this.editor.getContentTxt()},saveUEContent:function(){console.log("saveUEContent");var e=this.getUEContent();this.endUEdit({source:e})}},Object(u.b)(["endUEdit","cancelUEdit"])),destroyed:function(){this.editor.destroy()}},W={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("script",{attrs:{id:this.id,type:"text/plain"}})])},staticRenderFns:[]},V={name:"app",components:{FormEditor:I,ContentMenu:H,NEditor:o("VU/8")(M,W,!1,null,null,null).exports},computed:{type:function(){return this.$store.state.cache.type},ueditorConfig:function(){return this.$store.state.config.ueditorConfig}},data:function(){return{contentLoading:!1}},methods:(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e})({saveUEContent:function(){console.log("saveUEContent");var e=this.$refs.ueditor.getUEContent();this.endUEdit({source:e})},switchLoading:function(){this.contentLoading=!this.contentLoading}},Object(u.b)(["recordInitState","setCacheType"])),mounted:function(){this.recordInitState()},beforeMount:function(){},beforeUpdate:function(){},updated:function(){}},Y={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:this.contentLoading,expression:"contentLoading"}],attrs:{draggable:"false",ondragstart:"javascript: return false;","element-loading-text":"拼命加载中"}},["edit"===this.type?t("div",[t("NEditor",{ref:"ueditor",attrs:{config:this.ueditorConfig,id:"fe-ueditor"},on:{save:this.saveUEContent}})],1):t("div",[t("FormEditor",{on:{loading:this.switchLoading}}),this._v(" "),t("ContentMenu")],1)])},staticRenderFns:[]};var G=o("VU/8")(V,Y,!1,function(e){o("itiF")},null,null).exports,j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e};l.default.use(u.a);var K={config:{defaultColWidth:72,defaultRowHeight:20,predefinedColors:["#000000","#FFFFFF","#FF0000","#FFC000","#FFFF00","#92D050","#00B0F0","#0070C0","#002060","#7030A0"],borderDefaultColor:"#dddddd",borderDefaultStyle:"solid",borderDefaultWidth:"1",borderDefault:"solid 1px #dddddd",selectedBorderDefaultColor:"#000000",selectedBorderDefaultStyle:"solid",selectedBorderDefaultWidth:"2",selectedBorderDefault:"solid 2px #000000",selectedCellBackground:"#EAECF5",editInCell:!1,ueditorConfig:{zIndex:10,customtoolbar:!0,initialFrameWidth:null,initialFrameHeight:null,wordCount:!1,elementPathEnabled:!1,toolbars:[["yes","cancel","|","fullscreen","|","bold","italic","underline","|","forecolor","insertunorderedlist","|","fontfamily","fontsize","|","preview","insertframe","|","controlinput"]],labelMap:{controlinput:"插入文本框",yes:"确定",cancel:"取消编辑"},fontfamily:[{label:"",name:"songti",val:"宋体,SimSun"},{label:"",name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{label:"",name:"yahei",val:"微软雅黑,Microsoft YaHei"},{label:"",name:"heiti",val:"黑体, SimHei"},{label:"",name:"lishu",val:"隶书, SimLi"},{label:"",name:"arial",val:"arial, helvetica,sans-serif"}],fontsize:[10,11,12,14,16,18,20,24,36,72],enableContextMenu:!1,theme:"notadd",xssFilterRules:!1,inputXssFilter:!1,outputXssFilter:!1,iframeCssUrl:"static/neditor/ext/neditor-ext.css"}},cache:{type:"",select:{beginCell:{row:void 0,col:void 0},endCell:{row:void 0,col:void 0},selectedArea:{begin:{row:void 0,col:void 0},end:{row:void 0,col:void 0}}},resizeCol:{targetCol:void 0,initWidth:void 0,begin:{x:void 0,y:void 0},end:{x:void 0,y:void 0}},resizeRow:{targetRow:void 0,initHeight:void 0,begin:{x:void 0,y:void 0},end:{x:void 0,y:void 0}},editCell:{row:void 0,col:void 0},editControl:{type:void 0,row:void 0,col:void 0,attribute:{}},uedit:{row:void 0,col:void 0,content:""},copy:{row:void 0,col:void 0,cell:{}}},rowNum:32,rows:[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],colNum:26,cols:[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}],selectedColIndexList:[],cells:[new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27),new Array(27)],contextMenu:{width:150,e:{offsetX:500,offsetY:280},menuItemList:[]},editor:null,stateIndex:void 0,editorToolbarStatus:{fontfamily:"",fontsize:"",fontFamilyItems:[{value:"SimSun",label:"宋体"},{value:"KaiTi",label:"楷体"},{value:"微软雅黑",label:"微软雅黑"},{value:"SimHei",label:"黑体"},{value:"SimLi",label:"隶书"}],fontSizeItems:[{value:"12px",label:"12px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"},{value:"18px",label:"18px"},{value:"20px",label:"20px"},{value:"24px",label:"24px"},{value:"36px",label:"36px"}]},toolbarConfig:{fontFamilyItems:[{value:"SimSun",label:"宋体"},{value:"KaiTi",label:"楷体"},{value:"微软雅黑",label:"微软雅黑"},{value:"SimHei",label:"黑体"},{value:"LiSu",label:"隶书"}],fontSizeItems:[{value:"12px",label:"12px"},{value:"14px",label:"14px"},{value:"16px",label:"16px"},{value:"18px",label:"18px"},{value:"20px",label:"20px"},{value:"24px",label:"24px"},{value:"36px",label:"36px"}]},timestamp:0},Z={CLEAR_SELECT_AREA:function(e){e.selectedColIndexList=[]},PUSH_SELECTED_COL_INDEX:function(e,t){e.selectedColIndexList.push(t)},SET_CACHE_TYPE:function(e,t){e.cache.type=t},SET_CACHE_SELECTED_AREA_BEGIN:function(e,t){var o=t.row,l=t.col;e.cache.select.selectedArea.begin.row=o,e.cache.select.selectedArea.begin.col=l},SET_CACHE_SELECT_BEGIN_SELECT_CELL:function(e,t){var o=t.row,l=t.col;e.cache.select.beginCell.row=o,e.cache.select.beginCell.col=l},CLEAR_CACHE_SELECT_BEGIN_SELECT_CELL:function(e){e.cache.select.beginCell.row=void 0,e.cache.select.beginCell.col=void 0},SET_CACHE_SELECT_SELECTED_AREA_END:function(e,t){var o=t.row,l=t.col;e.cache.select.selectedArea.end.row=o,e.cache.select.selectedArea.end.col=l},SET_CACHE_SELECT_END_SELECT_CELL:function(e,t){var o=t.row,l=t.col;e.cache.select.endCell.row=o,e.cache.select.endCell.col=l,e.cache.select.selectedArea.begin.row=Math.min(e.cache.select.beginCell.row,e.cache.select.endCell.row),e.cache.select.selectedArea.begin.col=Math.min(e.cache.select.beginCell.col,e.cache.select.endCell.col),e.cache.select.selectedArea.end.row=Math.max(e.cache.select.beginCell.row,e.cache.select.endCell.row),e.cache.select.selectedArea.end.col=Math.max(e.cache.select.beginCell.col,e.cache.select.endCell.col)},SET_CELLS_SELECTED:function(e){for(var t=0;t<=e.cells.length-1;t++)for(var o=0;o<=e.cells[t].length-1;o++){var r=e.cells[t][o];if(t>=e.cache.select.selectedArea.begin.row&&t<=e.cache.select.selectedArea.end.row&&o>=e.cache.select.selectedArea.begin.col&&o<=e.cache.select.selectedArea.end.col)r||(r={},l.default.set(e.cells[t],o,r)),void 0!==r.selected&&!1!==r.selected||l.default.set(r,"selected",!0),t===e.cache.select.selectedArea.begin.row?void 0!==r.selected_is_top&&!1!==r.selected_is_top||l.default.set(r,"selected_is_top",!0):!0===r.selected_is_top&&l.default.set(r,"selected_is_top",!1),t===e.cache.select.selectedArea.end.row||r.row_end===e.cache.select.selectedArea.end.row?void 0!==r.selected_is_bottom&&!1!==r.selected_is_bottom||l.default.set(r,"selected_is_bottom",!0):!0===r.selected_is_bottom&&l.default.set(r,"selected_is_bottom",!1),o===e.cache.select.selectedArea.begin.col?void 0!==r.selected_is_left&&!1!==r.selected_is_left||l.default.set(r,"selected_is_left",!0):!0===r.selected_is_left&&l.default.set(r,"selected_is_left",!1),o===e.cache.select.selectedArea.end.col||r.col_end===e.cache.select.selectedArea.end.col?void 0!==r.selected_is_right&&!1!==r.selected_is_right||l.default.set(r,"selected_is_right",!0):!0===r.selected_is_right&&l.default.set(r,"selected_is_right",!1);else{var i=e.cells[t][o];i&&(!0===i.selected&&l.default.set(i,"selected",!1),!0===i.selected_is_top&&l.default.set(i,"selected_is_top",!1),!0===i.selected_is_bottom&&l.default.set(i,"selected_is_bottom",!1),!0===i.selected_is_left&&l.default.set(i,"selected_is_left",!1),!0===i.selected_is_right&&l.default.set(i,"selected_is_right",!1))}}},SET_CACHE_SELECT_SELECTED_AREA:function(e,t){var o=t.row,l=t.col;e.cache.select.selectedArea.begin.row=Math.min(e.cache.select.selectedArea.begin.row,o),e.cache.select.selectedArea.begin.col=Math.min(e.cache.select.selectedArea.begin.col,l),e.cache.select.selectedArea.end.row=Math.max(e.cache.select.selectedArea.end.row,o),e.cache.select.selectedArea.end.col=Math.max(e.cache.select.selectedArea.end.col,l)},CLEAR_CACHE_SELECT_END_SELECT_CELL:function(e){e.cache.select.endCell.row=void 0,e.cache.select.endCell.col=void 0},SET_CELL_PROPERTIES:function(e,t){var o=t.row,r=t.col,i=t.properties;for(var c in e.cells[o][r]||(e.cells[o][r]={},l.default.set(e.cells[o],r,{})),i)l.default.set(e.cells[o][r],c,i[c])},REMOVE_CELL_PROPERTIES:function(e,t){var o=t.row,r=t.col,i=t.key;l.default.delete(e.cells[o][r],i)},SET_CELL_CONTROL_ATTRIBUTE:function(e,t){var o=t.row,r=t.col,i=t.attribute;for(var c in e.cells[o][r].attribute||l.default.set(e.cells[o][r],"attribute",{}),i)l.default.set(e.cells[o][r].attribute,c,i[c])},REMOVE_CELL_CONTROL_ATTRIBUTE:function(e,t){var o=t.row,r=t.col;e.cells[o][r].attribute&&l.default.delete(e.cells[o][r],"attribute")},INIT_CELL_PROPERTIES:function(e,t){var o=t.row,r=t.col;l.default.set(e.cells[o],r,void 0)},SET_CACHE_RESIZECOL_TARGETCOL:function(e,t){e.cache.resizeCol.targetCol=t},CLEAR_CACHE_RESIZECOL_TARGETCOL:function(e){e.cache.resizeCol.targetCol=void 0},SET_CACHE_RESIZECOL_INITWIDTH:function(e,t){e.cache.resizeCol.initWidth=t},CLEAR_CACHE_RESIZECOL_INITWIDTH:function(e){e.cache.resizeCol.initWidth=void 0},SET_CACHE_RESIZECOL_BEGIN:function(e,t){var o=t.x,l=t.y;e.cache.resizeCol.begin.x=o,e.cache.resizeCol.begin.y=l},CLEAR_CACHE_RESIZECOL_BEGIN:function(e){e.cache.resizeCol.begin.x=void 0,e.cache.resizeCol.begin.y=void 0},SET_CACHE_RESIZECOL_END:function(e,t){var o=t.x,l=t.y;e.cache.resizeCol.end.x=o,e.cache.resizeCol.end.y=l},CLEAR_CACHE_RESIZECOL_END:function(e){e.cache.resizeCol.end.x=void 0,e.cache.resizeCol.end.y=void 0},SET_COL_WIDTH:function(e){if("resize-col"===e.cache.type){var t=e.cache.resizeCol.targetCol;if(t>=1){var o=(e.cache.resizeCol.initWidth||e.config.defaultColWidth)+e.cache.resizeCol.end.x-e.cache.resizeCol.begin.x;o<0?l.default.set(e.cols[t],"width",3):l.default.set(e.cols[t],"width",o)}}},SET_CACHE_RESIZEROW_TARGETROW:function(e,t){e.cache.resizeRow.targetRow=t},CLEAR_CACHE_RESIZEROW_TARGETROW:function(e){e.cache.resizeRow.targetRow=void 0},SET_CACHE_RESIZEROW_INITHEIGHT:function(e,t){e.cache.resizeRow.initHeight=t},CLEAR_CACHE_RESIZEROW_INITHEIGHT:function(e){e.cache.resizeRow.initHeight=void 0},SET_CACHE_RESIZEROW_BEGIN:function(e,t){var o=t.x,l=t.y;e.cache.resizeRow.begin.x=o,e.cache.resizeRow.begin.y=l},CLEAR_CACHE_RESIZEROW_BEGIN:function(e){e.cache.resizeRow.begin.x=void 0,e.cache.resizeRow.begin.y=void 0},SET_CACHE_RESIZEROW_END:function(e,t){var o=t.x,l=t.y;e.cache.resizeRow.end.x=o,e.cache.resizeRow.end.y=l},CLEAR_CACHE_RESIZEROW_END:function(e){e.cache.resizeRow.end.x=void 0,e.cache.resizeRow.end.y=void 0},SET_ROW_HEIGHT:function(e){if("resize-row"===e.cache.type){var t=e.cache.resizeRow.targetRow;if(t>=1){var o=(e.cache.resizeRow.initHeight||e.config.defaultRowHeight)+e.cache.resizeRow.end.y-e.cache.resizeRow.begin.y;o<0?l.default.set(e.rows[t],"height",3):l.default.set(e.rows[t],"height",o)}}},SET_CACHE_EDITCELL_TARGETCELL:function(e,t){var o=t.row,l=t.col;e.cache.editCell.row=o,e.cache.editCell.col=l},CLEAR_CACHE_EDITCELL_TARGETCELL:function(e,t){t.row,t.col;e.cache.editCell.row=void 0,e.cache.editCell.col=void 0},SET_CACHE_EDITCONTROL:function(e,t){var o=t.row,l=t.col,r=t.type;e.cache.editControl.row=o,e.cache.editControl.col=l,e.cache.editControl.type=r},CLEAR_CACHE_EDITCONTROL:function(e){e.cache.editControl.row=void 0,e.cache.editControl.col=void 0,e.cache.editControl.type=void 0},SET_CACHE_EDITCONTROL_ATTRIBUTE:function(e,t){var o=t.attribute;for(var r in o)void 0===e.cache.editControl.attribute[r]?l.default.set(e.cache.editControl.attribute,r,o[r]):e.cache.editControl.attribute[r]=o[r]},CLEAR_CACHE_EDITCONTROL_ATTRIBUTE:function(e){for(var t in e.cache.editControl.attribute)l.default.delete(e.cache.editControl.attribute,t)},INSERT_COL:function(e,t){e.cols.splice(t+1,0,{});for(var o=1;o<e.rowNum;o++){var l=e.cells[o][t+1]&&e.cells[o][t+1].hidden;l?e.cells[o].splice(t+1,0,{hidden:l}):e.cells[o].splice(t+1,0,{})}for(var r=0;r<=e.rowNum;r++)for(var i=0;i<=e.colNum;i++){var c=e.cells[r][i];c&&!c.hidden&&c.colspan&&c.colspan>1&&t>=i&&t<c.col_end&&(c.colspan=c.colspan+1,c.col_end=c.col_end+1)}e.colNum=e.colNum+1},DELETE_COL:function(e,t){e.cols.splice(t,1);for(var o=1;o<e.rowNum;o++){var l=e.cells[o][t];if(l&&l.colspan>1&&!l.hidden)do{e.cells[o][t+1].hidden=!1,l.colspan=l.colspan-1}while(l.colspan>1);if(!0===l.hidden&&e.cells[e.cells[o][t].row_parent][e.cells[o][t].col_parent].row_end===o){var r=e.cells[e.cells[o][t].row_parent][e.cells[o][t].col_parent];r.colspan=r.colspan-1,r.col_end=r.col_end-1}e.cells[o].splice(t,1)}e.colNum=e.colNum-1},INSERT_ROW:function(e,t){e.rows.splice(t+1,0,{}),e.cells.splice(t+1,0,[]),e.rowNum=e.rowNum+1;for(var o=1;o<e.colNum;o++){e.cells[t+2][o]&&e.cells[t+2][o].hidden?(e.cells[t+1][o]||l.default.set(e.cells[t+1],o,{}),l.default.set(e.cells[t+1][o],"hidden",!0)):e.cells[t+1][o]||l.default.set(e.cells[t+1],o,{})}for(var r=0;r<=e.rowNum;r++)for(var i=0;i<=e.colNum;i++){var c=e.cells[r][i];c&&!c.hidden&&c.rowspan&&c.rowspan>1&&t>=r&&t<c.row_end&&(c.rowspan=c.rowspan+1,c.row_end=c.row_end+1)}},DELETE_ROW:function(e,t){e.rows.splice(t,1);for(var o=1;o<e.colNum;o++){var l=e.cells[t][o];if(l&&l.rowspan>1&&!l.hidden)do{e.cells[t+1][o].hidden=!1,l.rowspan=l.rowspan-1}while(l.rowspan>1);if(!0===l.hidden&&e.cells[e.cells[t][o].row_parent][e.cells[t][o].col_parent].col_end===o){var r=e.cells[e.cells[t][o].row_parent][e.cells[t][o].col_parent];r.rowspan=r.rowspan-1,r.row_end=r.row_end-1}}e.cells.splice(t,1),e.rowNum=e.rowNum-1},SET_CACHE_UEDIT:function(e,t){var o=t.key,l=t.value;e.cache.uedit[o]=l},PUSH_BACKLIST:function(e){console.time("PUSH_BACKLIST");var t=JSON.parse(C("FormEditorStateList")||"[]"),o=p(C("FormEditorStateIndex"));o+=1,t.splice(o,999),t.push(JSON.parse(JSON.stringify(e))),g("FormEditorStateList",JSON.stringify(t)),g("FormEditorStateIndex",o),e.stateIndex=o,console.timeEnd("PUSH_BACKLIST")},SET_CACHE_COPY:function(e,t){var o=t.row,l=t.col,r=t.cell;for(var i in e.cache.copy.row=o,e.cache.copy.col=l,r)e.cache.copy.cell[i]=r[i]},CLEAR_CACHE_COPY:function(e){for(var t in e.cache.copy.row=void 0,e.cache.copy.col=void 0,e.cache.copy.cell)l.default.delete(e.cache.copy,t)},SET_EDITOR:function(e,t){l.default.set(e,"editor",t)},SET_EDITOR_TOOLBAR_STATUS:function(e,t){var o=t.fontsize,l=t.fontfamily;void 0!==o&&(e.editorToolbarStatus.fontsize=o),void 0!==l&&(e.editorToolbarStatus.fontfamily=l)},REFRESH_TIMESTAMP:function(e){e.timestamp=(new Date).getTime()},SET_CELLS_BOLD:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,r=e.cache.select.selectedArea.begin.col,i=e.cache.select.selectedArea.end.col,c=!0,n=t;n<=o;n++)for(var s=r;s<=i;s++)if(e.cells[n][s]&&!0!==e.cells[n][s].hidden&&!0!==e.cells[n][s].bold){c=!1;break}if(c)for(var a=t;a<=o;a++)for(var d=r;d<=i;d++)e.cells[a][d]&&e.cells[a][d].bold&&l.default.delete(e.cells[a][d],"bold");else for(var u=t;u<=o;u++)for(var h=r;h<=i;h++)e.cells[u][h]?e.cells[u][h]&&l.default.set(e.cells[u][h],"bold",!0):(l.default.set(e.cells[u],h,{}),l.default.set(e.cells[u][h],"bold",!0))}},SET_CELLS_TEXT_DECORATION:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,r=e.cache.select.selectedArea.begin.col,i=e.cache.select.selectedArea.end.col,c=!0,n=t;n<=o;n++)for(var s=r;s<=i;s++)if(e.cells[n][s]&&!0!==e.cells[n][s].hidden&&!0!==e.cells[n][s].textDecoration){c=!1;break}if(c)for(var a=t;a<=o;a++)for(var d=r;d<=i;d++)e.cells[a][d]&&e.cells[a][d].textDecoration&&l.default.delete(e.cells[a][d],"textDecoration");else for(var u=t;u<=o;u++)for(var h=r;h<=i;h++)e.cells[u][h]?e.cells[u][h]&&l.default.set(e.cells[u][h],"textDecoration",!0):(l.default.set(e.cells[u],h,{}),l.default.set(e.cells[u][h],"textDecoration",!0))}},SET_CELLS_ITALIC:function(e){if(""===e.cache.type){for(var t=e.cache.select.selectedArea.begin.row,o=e.cache.select.selectedArea.end.row,r=e.cache.select.selectedArea.begin.col,i=e.cache.select.selectedArea.end.col,c=!0,n=t;n<=o;n++)for(var s=r;s<=i;s++)if(e.cells[n][s]&&!0!==e.cells[n][s].hidden&&!0!==e.cells[n][s].italic){c=!1;break}if(c)for(var a=t;a<=o;a++)for(var d=r;d<=i;d++)e.cells[a][d]&&e.cells[a][d].italic&&l.default.delete(e.cells[a][d],"italic");else for(var u=t;u<=o;u++)for(var h=r;h<=i;h++)e.cells[u][h]?e.cells[u][h]&&l.default.set(e.cells[u][h],"italic",!0):(l.default.set(e.cells[u],h,{}),l.default.set(e.cells[u][h],"italic",!0))}}},q={selectCol:function(e,t){var o=e.state,l=(e.dispatch,e.commit);l("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:1,col:t}),l("SET_CACHE_SELECT_END_SELECT_CELL",{row:o.rowNum,col:t}),l("SET_CELLS_SELECTED")},selectRow:function(e,t){var o=e.state,l=(e.dispatch,e.commit);l("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:t,col:1}),l("SET_CACHE_SELECT_END_SELECT_CELL",{row:t,col:o.colNum}),l("SET_CELLS_SELECTED")},selectTable:function(e){var t=e.state,o=(e.dispatch,e.commit);o("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:1,col:1}),o("SET_CACHE_SELECT_END_SELECT_CELL",{row:t.rowNum,col:t.colNum})},beginSelectCell:function(e,t){var o=e.state,l=(e.dispatch,e.commit),r=(t.event,t.row),i=t.col;console.log("beginSelectCell"),console.time("beginSelectCell"),""!==o.cache.type&&"edit-cell"!==o.cache.type||(l("SET_CACHE_SELECT_BEGIN_SELECT_CELL",{row:r,col:i}),l("SET_CACHE_SELECT_END_SELECT_CELL",{row:r,col:i}),l("SET_CELLS_SELECTED"),l("SET_CACHE_TYPE","select"),console.timeEnd("beginSelectCell"))},endSelectCell:function(e,t){e.state,e.dispatch;var o=e.commit;t.event,t.row,t.col;console.log("endSelectCell"),o("SET_CACHE_TYPE","")},mergeSelectedCells:function(e){e.state,e.dispatch,e.commit},doDragSelect:function(e,t){for(var o=e.state,l=e.dispatch,r=e.commit,i=t.event,c=(t.row,t.col,t.stateStr),n=void 0,s=void 0,a=1;a<=o.rowNum;a++)for(var d=1;d<=o.colNum;d++){var u=o.cells[a][d];if(u&&u.row_end&&u.col_end){for(var h=!1,f=a;f<=a+u.rowspan-1;f++)for(var b=d;b<=d+u.colspan-1;b++)if(f>=o.cache.select.selectedArea.begin.row&&f<=o.cache.select.selectedArea.end.row&&b>=o.cache.select.selectedArea.begin.col&&b<=o.cache.select.selectedArea.end.col){h=!0;break}h&&(n=a,s=d,r("SET_CACHE_SELECT_SELECTED_AREA",{row:a,col:d}),r("SET_CACHE_SELECT_SELECTED_AREA",{row:u.row_end,col:u.col_end}))}}r("SET_CELLS_SELECTED");var p=JSON.stringify({begin:{row:o.cache.select.selectedArea.begin.row,col:o.cache.select.selectedArea.begin.col},end:{row:o.cache.select.selectedArea.end.row,col:o.cache.select.selectedArea.end.col}});return p===c?c:l("doDragSelect",{event:i,row:n,col:s,stateStr:p})},dragSelect:function(e,t){var o=e.state,l=e.dispatch,r=e.commit,i=t.event,c=t.row,n=t.col;t.stateStr;console.log("dragSelect"),"select"===o.cache.type&&(r("SET_CACHE_SELECT_END_SELECT_CELL",{row:c,col:n}),l("doDragSelect",{event:i,row:c,col:n,stateStr:null}))},exitSelectMode:function(e){e.state;(0,e.commit)("SET_CACHE_TYPE","")},mergeCells:function(e,t){var o=e.state,l=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col){l("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row,col:o.cache.select.selectedArea.begin.col,properties:{rowspan:o.cache.select.selectedArea.end.row-o.cache.select.selectedArea.begin.row+1,colspan:o.cache.select.selectedArea.end.col-o.cache.select.selectedArea.begin.col+1,row_end:o.cache.select.selectedArea.begin.row+o.cache.select.selectedArea.end.row-o.cache.select.selectedArea.begin.row,col_end:o.cache.select.selectedArea.begin.col+o.cache.select.selectedArea.end.col-o.cache.select.selectedArea.begin.col,selected:!0,selected_is_top:!0,selected_is_bottom:!0,selected_is_left:!0,selected_is_right:!0}});for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var i=o.cache.select.selectedArea.begin.col;i<=o.cache.select.selectedArea.end.col;i++)r===o.cache.select.selectedArea.begin.row&&i===o.cache.select.selectedArea.begin.col||l("SET_CELL_PROPERTIES",{row:r,col:i,properties:{hidden:!0,content:void 0,row_parent:o.cache.select.selectedArea.begin.row,col_parent:o.cache.select.selectedArea.begin.col,rowspan:1,colspan:1}})}l("PUSH_BACKLIST")},splitCells:function(e){var t=e.state,o=e.commit;if(t.cache.select.selectedArea.begin.row&&t.cache.select.selectedArea.begin.col&&t.cache.select.selectedArea.end.row&&t.cache.select.selectedArea.end.col){var l=t.cache.select.selectedArea.begin.row,r=t.cache.select.selectedArea.begin.col;o("SET_CACHE_SELECT_SELECTED_AREA",{row:l+(t.cells[l][r].rowspan||1)-1,col:r+(t.cells[l][r].colspan||1)-1}),o("REMOVE_CELL_PROPERTIES",{row:l,col:r,key:"rowspan"}),o("REMOVE_CELL_PROPERTIES",{row:l,col:r,key:"colspan"}),o("REMOVE_CELL_PROPERTIES",{row:l,col:r,key:"row_end"}),o("REMOVE_CELL_PROPERTIES",{row:l,col:r,key:"col_end"}),o("SET_CELL_PROPERTIES",{row:l,col:r,properties:{selected:!0,selected_is_top:!0,selected_is_bottom:!1,selected_is_left:!0,selected_is_right:!1}});for(var i=t.cache.select.selectedArea.begin.row;i<=t.cache.select.selectedArea.end.row;i++)for(var c=t.cache.select.selectedArea.begin.col;c<=t.cache.select.selectedArea.end.col;c++)i===t.cache.select.selectedArea.begin.row&&c===t.cache.select.selectedArea.begin.col||(o("INIT_CELL_PROPERTIES",{row:i,col:c}),o("SET_CELL_PROPERTIES",{row:i,col:c,properties:{selected:!0,selected_is_top:i===t.cache.select.selectedArea.begin.row,selected_is_bottom:i===t.cache.select.selectedArea.end.row,selected_is_left:c===t.cache.select.selectedArea.begin.col,selected_is_right:c===t.cache.select.selectedArea.end.col}}))}o("PUSH_BACKLIST")},setCellsTextAlign:function(e,t){var o=e.state,l=e.commit,r=t.align;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var i=o.cache.select.selectedArea.begin.row;i<=o.cache.select.selectedArea.end.row;i++)for(var c=o.cache.select.selectedArea.begin.col;c<=o.cache.select.selectedArea.end.col;c++)l("SET_CELL_PROPERTIES",{row:i,col:c,properties:{textAlign:r}});l("PUSH_BACKLIST")},setCellsTextValign:function(e,t){var o=e.state,l=e.commit,r=t.align;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var i=o.cache.select.selectedArea.begin.row;i<=o.cache.select.selectedArea.end.row;i++)for(var c=o.cache.select.selectedArea.begin.col;c<=o.cache.select.selectedArea.end.col;c++)l("SET_CELL_PROPERTIES",{row:i,col:c,properties:{textAlign:r}});l("PUSH_BACKLIST")},setCellsTextFontSize:function(e,t){var o=e.state,l=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var i=o.cache.select.selectedArea.begin.col;i<=o.cache.select.selectedArea.end.col;i++)l("SET_CELL_PROPERTIES",{row:r,col:i,properties:{fontSize:t}});l("PUSH_BACKLIST")},setCellsTextFontFamily:function(e,t){var o=e.state,l=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var i=o.cache.select.selectedArea.begin.col;i<=o.cache.select.selectedArea.end.col;i++)l("SET_CELL_PROPERTIES",{row:r,col:i,properties:{fontFamily:t}});l("PUSH_BACKLIST")},setCellsBackground:function(e,t){var o=e.state,l=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var i=o.cache.select.selectedArea.begin.col;i<=o.cache.select.selectedArea.end.col;i++)l("SET_CELL_PROPERTIES",{row:r,col:i,properties:{background:t}});l("PUSH_BACKLIST")},setCellsTextColor:function(e,t){var o=e.state,l=e.commit;if(o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col)for(var r=o.cache.select.selectedArea.begin.row;r<=o.cache.select.selectedArea.end.row;r++)for(var i=o.cache.select.selectedArea.begin.col;i<=o.cache.select.selectedArea.end.col;i++)l("SET_CELL_PROPERTIES",{row:r,col:i,properties:{color:t}});l("PUSH_BACKLIST")},beginEditCell:function(e,t){var o=e.state,l=e.commit,r=e.dispatch,i=t.row,c=t.col;if(console.log("beginEditCell"),o.config.editInCell){"edit-cell"===o.cache.type&&r("endEditCell");var n=document.querySelector("#td_"+i+"_"+c).clientHeight;l("SET_CACHE_EDITCELL_TARGETCELL",{row:i,col:c}),setTimeout(function(){document.querySelector("#editor_"+i+"_"+c).style.display="block",console.time("createeditor");var e=UE.getEditor("editor_"+i+"_"+c,Object.assign(o.config.ueditorConfig,{initialFrameHeight:n}));console.timeEnd("createeditor"),window.__EDITOR__=e,function(e,t){e.addListener("selectionchange",function(e){var o=window.__EDITOR__.queryCommandValue("fontsize");t("setEditorToolbarStatusFontsize",o);var l=window.__EDITOR__.queryCommandValue("fontfamily");t("setEditorToolbarStatusFontfamily",l)})}(e,r),l("SET_CACHE_TYPE","edit-cell"),l("SET_CELL_PROPERTIES",{row:i,col:c,properties:{contenteditable:!0}}),l("SET_CACHE_EDITCELL_TARGETCELL",{row:i,col:c}),setTimeout(function(){document.querySelector("#editor_"+i+"_"+c).classList.add("whole-size"),document.querySelector("#editor_"+i+"_"+c).style.width="100%",UE.getEditor("editor_"+i+"_"+c).focus()},0)},0)}else{var s=o.cells[i][c];if(s&&s.type)return l("SET_CACHE_EDITCONTROL",{row:i,col:c,type:s.type}),l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:s.attribute}),void l("SET_CACHE_TYPE","edit-control");l("SET_CACHE_TYPE","edit-cell"),l("SET_CELL_PROPERTIES",{row:i,col:c,properties:{contenteditable:!0}}),l("SET_CACHE_EDITCELL_TARGETCELL",{row:i,col:c}),setTimeout(function(){document.querySelector("#td_content_"+i+"_"+c).focus(),document.querySelector("#td_content_"+i+"_"+c).style.cursor="text"},0)}},endEditCell:function(e){var t=e.state,o=e.commit;if(console.log("endEditCell"),t.cache.editCell.row&&t.cache.editCell.col){var r=t.cache.editCell.row,i=t.cache.editCell.col;if(t.config.editInCell){console.log("destroying.........."),console.log(l.default),console.log(l.default.$nextTick);var c=window.__EDITOR__.getContent();window.__EDITOR__.destroy(),o("SET_CELL_PROPERTIES",{row:r,col:i,properties:{content:c,contenteditable:!1}}),o("CLEAR_CACHE_EDITCELL_TARGETCELL",{row:r,col:i}),setTimeout(function(){document.querySelector("#td_content_"+r+"_"+i).style.cursor=null,document.querySelector("#td_content_"+r+"_"+i).classList.add("nodisplay"),o("SET_CACHE_TYPE",""),document.querySelector("#editor_"+r+"_"+i).style.display="none",console.log("destroyed")},0)}else o("SET_CELL_PROPERTIES",{row:r,col:i,properties:{content:document.querySelector("#td_content_"+r+"_"+i).innerHTML,contenteditable:!1}}),o("CLEAR_CACHE_EDITCELL_TARGETCELL",{row:r,col:i}),document.querySelector("#td_content_"+r+"_"+i).style.cursor=null,o("REMOVE_CELL_PROPERTIES",{row:r,col:i,key:"contenteditable"}),o("SET_CACHE_TYPE","")}},beginResizeCol:function(e,t){var o=e.state,l=e.commit,r=t.col,i=t.beginLocation;console.log("beginResizeCol"),""===o.cache.type&&(l("SET_CACHE_TYPE","resize-col"),l("SET_CACHE_RESIZECOL_TARGETCOL",r),l("SET_CACHE_RESIZECOL_INITWIDTH",o.cols[r].width||o.config.defaultColWidth),l("SET_CACHE_RESIZECOL_BEGIN",j({},i)))},dragResizeCol:function(e,t){var o=e.state,l=e.commit,r=t.location;console.log("dragResizeCol"),"resize-col"===o.cache.type&&(l("SET_CACHE_RESIZECOL_END",j({},r)),l("SET_COL_WIDTH"))},endResizeCol:function(e,t){var o=e.state,l=e.commit,r=t.location;console.log("endResizeCol"),"resize-col"===o.cache.type&&(l("SET_CACHE_RESIZECOL_END",j({},r)),l("SET_COL_WIDTH"),l("SET_CACHE_TYPE",""),l("PUSH_BACKLIST"))},beginResizeRow:function(e,t){var o=e.state,l=e.commit,r=t.row,i=t.beginLocation;console.log("beginResizeRow"),""===o.cache.type&&(l("SET_CACHE_TYPE","resize-row"),l("SET_CACHE_RESIZEROW_TARGETROW",r),l("SET_CACHE_RESIZEROW_INITHEIGHT",o.rows[r].height||o.config.defaultRowHeight),l("SET_CACHE_RESIZEROW_BEGIN",j({},i)))},dragResizeRow:function(e,t){var o=e.state,l=e.commit,r=t.location;console.log("dragResizeRow"),"resize-row"===o.cache.type&&(l("SET_CACHE_RESIZEROW_END",j({},r)),l("SET_ROW_HEIGHT"))},endResizeRow:function(e,t){var o=e.state,l=e.commit,r=t.location;console.log("endResizeRow"),"resize-row"===o.cache.type&&(l("SET_CACHE_RESIZEROW_END",j({},r)),l("SET_ROW_HEIGHT"),l("SET_CACHE_TYPE",""),l("PUSH_BACKLIST"))},setCellsBorder:function(e,t){var o=e.state,l=e.commit,r=t.borderTop,i=t.borderHorizon,c=t.borderBottom,n=t.borderLeft,s=t.borderVertical,a=t.borderRight;if(console.log("setCellsBorder"),o.cache.select.selectedArea.begin.row&&o.cache.select.selectedArea.begin.col&&o.cache.select.selectedArea.end.row&&o.cache.select.selectedArea.end.col){if(r.width)for(var d=o.cache.select.selectedArea.begin.col;d<=o.cache.select.selectedArea.end.col;d++)void 0!==o.cells[o.cache.select.selectedArea.begin.row][d]&&!0===o.cells[o.cache.select.selectedArea.begin.row][d].hidden||(l("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row,col:d,properties:{borderTopWidth:r.width,borderTopStyle:r.style,borderTopColor:r.color,borderTop:r.width+"px "+r.style+" "+r.color,border:!0}}),void 0!==o.cells[o.cache.select.selectedArea.begin.row-1][d]&&!0===o.cells[o.cache.select.selectedArea.begin.row-1][d].hidden||l("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.begin.row-1,col:d,properties:{borderBottomWidth:r.width,borderBottomStyle:r.style,borderBottomColor:r.color,borderBottom:r.width+"px "+r.style+" "+r.color,border:!0}}));if(n.width)for(var u=o.cache.select.selectedArea.begin.row;u<=o.cache.select.selectedArea.end.row;u++)void 0!==o.cells[u][o.cache.select.selectedArea.begin.col]&&!0===o.cells[u][o.cache.select.selectedArea.begin.col].hidden||(l("SET_CELL_PROPERTIES",{row:u,col:o.cache.select.selectedArea.begin.col,properties:{borderLeftWidth:n.width,borderLeftStyle:n.style,borderLeftColor:n.color,borderLeft:n.width+"px "+n.style+" "+n.color,border:!0}}),void 0!==o.cells[u][o.cache.select.selectedArea.begin.col-1]&&!0===o.cells[u][o.cache.select.selectedArea.begin.col-1].hidden||l("SET_CELL_PROPERTIES",{row:u,col:o.cache.select.selectedArea.begin.col-1,properties:{borderRightWidth:n.width,borderRightStyle:n.style,borderRightColor:n.color,borderRight:n.width+"px "+n.style+" "+n.color,border:!0}}));if(c.width){for(var h=o.cache.select.selectedArea.begin.col;h<=o.cache.select.selectedArea.end.col;h++)void 0!==o.cells[o.cache.select.selectedArea.end.row][h]&&!0===o.cells[o.cache.select.selectedArea.end.row][h].hidden||(l("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.end.row,col:h,properties:{borderBottomWidth:c.width,borderBottomStyle:c.style,borderBottomColor:c.color,borderBottom:c.width+"px "+c.style+" "+c.color,border:!0}}),void 0!==o.cells[o.cache.select.selectedArea.end.row+1][h]&&!0===o.cells[o.cache.select.selectedArea.end.row+1][h].hidden||l("SET_CELL_PROPERTIES",{row:o.cache.select.selectedArea.end.row+1,col:h,properties:{borderTopWidth:c.width,borderTopStyle:c.style,borderTopColor:c.color,borderTop:c.width+"px "+c.style+" "+c.color,border:!0}}));for(var f=o.cache.select.selectedArea.begin.row;f<o.cache.select.selectedArea.end.row;f++)for(var b=o.cache.select.selectedArea.begin.col;b<=o.cache.select.selectedArea.end.row;b++)o.cells[f][b]&&!0!==o.cells[f][b].hidden&&f+o.cells[f][b].rowspan-1===o.cache.select.selectedArea.end.row&&(l("SET_CELL_PROPERTIES",{row:f,col:b,properties:{borderBottomWidth:c.width,borderBottomStyle:c.style,borderBottomColor:c.color,borderBottom:c.width+"px "+c.style+" "+c.color,border:!0}}),void 0!==o.cells[f+1][f]&&!0===o.cells[f+1][f].hidden||l("SET_CELL_PROPERTIES",{row:f+1,col:b,properties:{borderTopWidth:c.width,borderTopStyle:c.style,borderTopColor:c.color,borderTop:c.width+"px "+c.style+" "+c.color,border:!0}}))}if(a.width){for(var p=o.cache.select.selectedArea.begin.row;p<=o.cache.select.selectedArea.end.row;p++)void 0!==o.cells[p][o.cache.select.selectedArea.end.col]&&!0===o.cells[p][o.cache.select.selectedArea.end.col].hidden||(l("SET_CELL_PROPERTIES",{row:p,col:o.cache.select.selectedArea.end.col,properties:{borderRightWidth:a.width,borderRightStyle:a.style,borderRightColor:a.color,borderRight:a.width+"px "+a.style+" "+a.color,border:!0}}),void 0!==o.cells[p][o.cache.select.selectedArea.end.col+1]&&!0===o.cells[p][o.cache.select.selectedArea.end.col+1].hidden||l("SET_CELL_PROPERTIES",{row:p,col:o.cache.select.selectedArea.end.col+1,properties:{borderLeftWidth:a.width,borderLeftStyle:a.style,borderLeftColor:a.color,borderLeft:a.width+"px "+a.style+" "+a.color,border:!0}}));for(var C=o.cache.select.selectedArea.begin.row;C<=o.cache.select.selectedArea.end.row;C++)for(var g=o.cache.select.selectedArea.begin.col;g<o.cache.select.selectedArea.end.row;g++)o.cells[C][g]&&!0!==o.cells[C][g].hidden&&g+o.cells[C][g].colspan-1===o.cache.select.selectedArea.end.col&&(l("SET_CELL_PROPERTIES",{row:C,col:g,properties:{borderRightWidth:a.width,borderRightStyle:a.style,borderRightColor:a.color,borderRight:a.width+"px "+a.style+" "+a.color,border:!0}}),void 0!==o.cells[C][g+1]&&!0===o.cells[C][g+1].hidden||l("SET_CELL_PROPERTIES",{row:C,col:g+1,properties:{borderLeftWidth:a.width,borderLeftStyle:a.style,borderLeftColor:a.color,borderLeft:a.width+"px "+a.style+" "+a.color,border:!0}}))}if(s.width)for(var _=o.cache.select.selectedArea.begin.row;_<=o.cache.select.selectedArea.end.row;_++)for(var m=o.cache.select.selectedArea.begin.col;m<o.cache.select.selectedArea.end.col;m++)void 0!==o.cells[_][m]&&!0===o.cells[_][m].hidden||(l("SET_CELL_PROPERTIES",{row:_,col:m,properties:{borderRightWidth:s.width,borderRightStyle:s.style,borderRightColor:s.color,borderRight:s.width+"px "+s.style+" "+s.color,border:!0}}),void 0!==o.cells[_][m+1]&&!0===o.cells[_][m+1].hidden||l("SET_CELL_PROPERTIES",{row:_,col:m+1,properties:{borderLeftWidth:s.width,borderLeftStyle:s.style,borderLeftColor:s.color,borderLeft:s.width+"px "+s.style+" "+s.color,border:!0}}));if(i.width)for(var E=o.cache.select.selectedArea.begin.row;E<o.cache.select.selectedArea.end.row;E++)for(var v=o.cache.select.selectedArea.begin.col;v<=o.cache.select.selectedArea.end.col;v++)void 0!==o.cells[E][v]&&!0===o.cells[E][v].hidden||(l("SET_CELL_PROPERTIES",{row:E,col:v,properties:{borderBottomWidth:i.width,borderBottomStyle:i.style,borderBottomColor:i.color,borderBottom:i.width+"px "+i.style+" "+i.color,border:!0}}),void 0!==o.cells[E+1][v]&&!0===o.cells[E+1][v].hidden||l("SET_CELL_PROPERTIES",{row:E+1,col:v,properties:{borderTopWidth:i.width,borderTopStyle:i.style,borderTopColor:i.color,borderTop:i.width+"px "+i.style+" "+i.color,border:!0}}))}l("PUSH_BACKLIST")},showContentMenu:function(e,t){var o=e.state;e.dispatch;o.contextMenu.e=t.e,o.contextMenu.width=t.width||150;var l=function(e){var l;t.menus[e].disabled?t.menus[e].handler=function(){}:(l=t.menus[e].handler,t.menus[e].handler=function(){l(),o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1})})};for(var r in t.menus)l(r);o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1}).concat(t.menus)},hideContentMenu:function(e,t){e.commit;var o=e.state;(t.clientX<o.contextMenu.e.clientX||t.clientX>o.contextMenu.e.clientX+o.contextMenu.width-5||t.clientY<o.contextMenu.e.clientY||t.clientY>o.contextMenu.e.clientY+document.querySelector(".fe-content-menu").clientHeight-5)&&(o.contextMenu.menuItemList=o.contextMenu.menuItemList.filter(function(){return!1}))},insertCol:function(e){var t=e.state,o=e.commit;o("INSERT_COL",t.cache.select.selectedArea.end.col),o("PUSH_BACKLIST")},deleteCol:function(e){var t=e.state,o=e.commit;o("DELETE_COL",t.cache.select.selectedArea.end.col),o("PUSH_BACKLIST")},insertRow:function(e){var t=e.state,o=e.commit;o("INSERT_ROW",t.cache.select.selectedArea.end.row),o("PUSH_BACKLIST")},deleteRow:function(e){var t=e.state,o=e.commit;o("DELETE_ROW",t.cache.select.selectedArea.end.row),o("PUSH_BACKLIST")},beginUEdit:function(e){var t=e.state,o=e.commit;o("SET_CACHE_TYPE","edit");var l=t.cache.select.beginCell.row,r=t.cache.select.beginCell.col;o("SET_CACHE_UEDIT",{key:"row",value:l}),o("SET_CACHE_UEDIT",{key:"col",value:r}),o("SET_CACHE_UEDIT",{key:"content",value:t.cells[l][r]?t.cells[l][r].content:""})},cancelUEdit:function(e){e.state;var t=e.commit;t("SET_CACHE_TYPE",""),t("SET_CACHE_UEDIT",{key:"row",value:void 0}),t("SET_CACHE_UEDIT",{key:"col",value:void 0}),t("SET_CACHE_UEDIT",{key:"content",value:""})},endUEdit:function(e,t){var o=e.state,l=e.commit,r=e.history,i=t.source;console.log("endUEdit"),console.log(r),l("SET_CELL_PROPERTIES",{row:o.cache.uedit.row,col:o.cache.uedit.col,properties:{content:i}}),l("SET_CACHE_TYPE",""),l("PUSH_BACKLIST")},doClearCellsContent:function(e){for(var t=e.state,o=e.commit,l=t.cache.select.selectedArea.begin.row;l<=t.cache.select.selectedArea.end.row;l++)for(var r=t.cache.select.selectedArea.begin.col;r<=t.cache.select.selectedArea.end.col;r++)o("SET_CELL_PROPERTIES",{row:l,col:r,properties:{content:"",type:""}}),o("REMOVE_CELL_CONTROL_ATTRIBUTE",{row:l,col:r});o("PUSH_BACKLIST")},recordInitState:function(e){e.state;var t=e.commit;g("FormEditorStateList","[]"),g("FormEditorStateIndex",-1),t("PUSH_BACKLIST")},doUndo:function(e){var t=e.state,o=e.commit;t.backList.length<=0||setTimeout(function(){o("SET_CACHE_TYPE","undo"),o("UNDO"),o("SET_CACHE_TYPE","")},0)},doRedo:function(e){var t=e.state,o=e.commit;t.nextList.length<=0||setTimeout(function(){o("SET_CACHE_TYPE","redo"),o("REDO"),o("SET_CACHE_TYPE","")},0)},setCacheType:function(e,t){e.state;(0,e.commit)("SET_CACHE_TYPE",t)},copyCell:function(e){var t=e.state,o=e.commit,l=t.cache.select.beginCell.row,r=t.cache.select.beginCell.col;o("SET_CACHE_COPY",{row:l,col:r,cell:t.cells[l][r]})},setEditorToolbarStatusFontsize:function(e,t){e.state;(0,e.commit)("SET_EDITOR_TOOLBAR_STATUS",{fontsize:t})},setEditorToolbarStatusFontfamily:function(e,t){e.state;(0,e.commit)("SET_EDITOR_TOOLBAR_STATUS",{fontfamily:t})},setBold:function(e){e.state;var t=e.commit;t("SET_CELLS_BOLD"),t("PUSH_BACKLIST")},setTextDecoration:function(e){e.state;var t=e.commit;t("SET_CELLS_TEXT_DECORATION"),t("PUSH_BACKLIST")},setItalic:function(e){e.state;var t=e.commit;t("SET_CELLS_ITALIC"),t("PUSH_BACKLIST")},addControl:function(e,t){var o=e.state,l=e.commit,r=t.type,i=t.attribute;console.log("addInput");var c=o.cache.select.beginCell.row,n=o.cache.select.beginCell.col;l("SET_CELL_PROPERTIES",{row:c,col:n,properties:{content:"",type:r}}),l("SET_CELL_CONTROL_ATTRIBUTE",{row:c,col:n,attribute:i})},beginAddControl:function(e,t){var o=e.state,l=e.commit,r=t.type;l("SET_CACHE_EDITCONTROL",{row:o.cache.select.beginCell.row,col:o.cache.select.beginCell.col,type:r}),"input"===r?l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:""}}):"input"===r?l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",height:""}}):"date"===r?l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",format:"yyyy-MM-dd"}}):"select"===r?l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",width:"",options:[]}}):"checkbox"===r?l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",horizon:!0,options:[]}}):"radio"===r&&l("SET_CACHE_EDITCONTROL_ATTRIBUTE",{attribute:{name:"",horizon:!0,options:[]}})},cancelAddControl:function(e,t){e.state;var o=e.commit;t?o("CLEAR_CACHE_EDITCONTROL_ATTRIBUTE"):(o("SET_CACHE_TYPE",""),o("CLEAR_CACHE_EDITCONTROL"),o("CLEAR_CACHE_EDITCONTROL_ATTRIBUTE"))}},X=new u.a.Store({state:K,actions:q,mutations:Z,strict:!1});o("tvR6");l.default.use(f.a),l.default.config.productionTip=!1,new l.default({el:"#app",store:X,template:"<Editor/>",components:{Editor:G}})},Y30a:function(e,t){},ZUP7:function(e,t){},ZkdS:function(e,t){},cDxm:function(e,t){},dQCv:function(e,t){},itiF:function(e,t){},lF5K:function(e,t){},peKb:function(e,t){},q4eC:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.c3a0f3315581c4398480.js.map